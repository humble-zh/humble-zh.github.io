<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>mysql笔记 | Zhihong&#39;s Blog</title>
    <meta name="author" content="Zhihong Li" />
    <meta name="keywords" content="zhbox" />
    <meta name="description" content="mysqlSource学习过程参考视频教程：java1234网站《一头扎进mysql》源码及视频网盘：链接0前言数据库（Database）是按照数据结构来组织、存储和管理数据的仓库。我们也可以将数据存储在文件中，但是在文件中读写数据速度相对较慢。使用关系型数据库管理系统（RDBMS）来存储和管理的大数据量。所谓的关系型数据库，是建立在关系模型基础上的数据库，借助于集合代数等数学概念和方法来处理数据库中的数据。RDBMS 即关系数据库管理系统(Relational Database Managem" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="Zhihong&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
<meta name="generator" content="Hexo 5.3.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Zhihong&#39;s Blog</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/zhbox">
                <span class="nav-text">中盒</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://humble-zh.github.io"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#mysql"><span class="toc-number">1.</span> <span class="toc-text">mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">0前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-mysql%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.</span> <span class="toc-text">1 mysql的数据类型简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%95%B4%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.1 整数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E6%B5%AE%E7%82%B9%E6%95%B0%E5%92%8C%E5%AE%9A%E7%82%B9%E6%95%B0%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">1.2 浮点数和定点数类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.3.</span> <span class="toc-text">1.3 日期与时间类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.4.</span> <span class="toc-text">1.4 字符串类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.5.</span> <span class="toc-text">1.5 二进制类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%EF%BC%88database%EF%BC%89%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.</span> <span class="toc-text">2 数据库（database）的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%84%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">2.1 数据库组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.2.</span> <span class="toc-text">2.2 显示数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.3.</span> <span class="toc-text">2.3 创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.4.</span> <span class="toc-text">2.4 删除数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E8%A1%A8%EF%BC%88Tables%EF%BC%89%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">3 数据表（Tables）的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.1 创建表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.2.</span> <span class="toc-text">3.2 查看表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.3 修改表结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="toc-number">1.4.4.</span> <span class="toc-text">3.4 删除表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%A1%A8%E5%86%85%E5%AE%B9%E7%9A%84%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.</span> <span class="toc-text">4 表内容的相关操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E6%9F%A5%E8%AF%A2%E8%A1%A8%E5%86%85%E5%AD%97%E6%AE%B5"><span class="toc-number">1.5.1.</span> <span class="toc-text">4.1 查询表内字段</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9C%89%E5%AD%97%E6%AE%B5%EF%BC%9A"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">4.1.1 查询所有字段：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E6%9F%A5%E8%AF%A2%E6%8C%87%E5%AE%9A%E5%AD%97%E6%AE%B5%EF%BC%9A"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">4.1.2 查询指定字段：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3-where%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">4.1.3 where条件查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-4-%E5%B8%A6in%E5%85%B3%E9%94%AE%E5%AD%97%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.2.</span> <span class="toc-text">4.1.4 带in关键字查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-5-%E5%B8%A6between-and%E7%9A%84%E8%8C%83%E5%9B%B4%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.3.</span> <span class="toc-text">4.1.5 带between and的范围查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-6-%E5%B8%A6like%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.4.</span> <span class="toc-text">4.1.6 带like模糊查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-7-%E7%A9%BA%E5%80%BC%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.5.</span> <span class="toc-text">4.1.7 空值查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-8-%E5%B8%A6and%E7%9A%84%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.6.</span> <span class="toc-text">4.1.8 带and的多条件查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-9-%E5%B8%A6or%E7%9A%84%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.7.</span> <span class="toc-text">4.1.9 带or的多条件查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-10-distinct%E5%8E%BB%E9%87%8D%E5%A4%8D%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.8.</span> <span class="toc-text">4.1.10 distinct去重复查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-11-%E5%AF%B9%E6%9F%A5%E8%AF%A2%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-number">1.5.9.</span> <span class="toc-text">4.1.11 对查询结果排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-12-group-by-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.10.</span> <span class="toc-text">4.1.12 group by 分组查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-13-limit-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.11.</span> <span class="toc-text">4.1.13 limit 分页查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E4%BD%BF%E7%94%A8%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E6%9F%A5%E8%AF%A2%EF%BC%88%E7%BB%9F%E8%AE%A1%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">4.2 使用聚合函数查询（统计）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-1-COUNT-%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.1.</span> <span class="toc-text">4.2.1 COUNT() 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-2-SUM-%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.2.</span> <span class="toc-text">4.2.2 SUM() 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-3-AVG-%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.3.</span> <span class="toc-text">4.2.3 AVG() 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-4-MAX-%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.4.</span> <span class="toc-text">4.2.4 MAX() 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-5-MIN-%E5%87%BD%E6%95%B0"><span class="toc-number">1.6.5.</span> <span class="toc-text">4.2.5 MIN() 函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.</span> <span class="toc-text">4.3 多表连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-1-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.1.</span> <span class="toc-text">4.3.1 内连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-2-%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.2.</span> <span class="toc-text">4.3.2 外连接查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-3-%E5%A4%9A%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.3.</span> <span class="toc-text">4.3.3 多条件查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.</span> <span class="toc-text">4.4 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-1-%E5%B8%A6IN%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.1.</span> <span class="toc-text">4.4.1 带IN关键字的子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-2-%E5%B8%A6%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E6%9D%A1%E4%BB%B6%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.2.</span> <span class="toc-text">4.4.2 带比较运算条件的子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-3-%E5%B8%A6Exits%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.3.</span> <span class="toc-text">4.4.3 带Exits关键字的子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-4-%E5%B8%A6ANY%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.4.</span> <span class="toc-text">4.4.4 带ANY关键字的子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-5-%E5%B8%A6ALL%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.8.5.</span> <span class="toc-text">4.4.5 带ALL关键字的子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-%E5%90%88%E5%B9%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.9.</span> <span class="toc-text">4.5 合并查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-%E6%8F%92%E5%85%A5%E3%80%81%E6%9B%B4%E6%96%B0%E3%80%81%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">1.10.</span> <span class="toc-text">4.6 插入、更新、删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-1-%E6%8F%92%E5%85%A5"><span class="toc-number">1.10.1.</span> <span class="toc-text">4.6.1 插入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-2-%E6%9B%B4%E6%96%B0"><span class="toc-number">1.10.2.</span> <span class="toc-text">4.6.2 更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-3-%E5%88%A0%E9%99%A4"><span class="toc-number">1.10.3.</span> <span class="toc-text">4.6.3 删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E7%B4%A2%E5%BC%95"><span class="toc-number">1.11.</span> <span class="toc-text">5.索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">1.11.1.</span> <span class="toc-text">5.1 索引分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">1.11.2.</span> <span class="toc-text">5.2 创建索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-%E5%88%A0%E9%99%A4%E7%B4%A2%E5%BC%95"><span class="toc-number">1.11.3.</span> <span class="toc-text">5.3 删除索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A7%86%E5%9B%BE%EF%BC%88View%EF%BC%89"><span class="toc-number">1.12.</span> <span class="toc-text">6 数据库视图（View）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E8%A7%86%E5%9B%BE%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">1.12.1.</span> <span class="toc-text">6.1 视图的好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.2.</span> <span class="toc-text">6.2 创建视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-1-%E5%8D%95%E8%A1%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.2.1.</span> <span class="toc-text">6.2.1 单表视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-2-2-%E5%A4%9A%E8%A1%A8%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.2.2.</span> <span class="toc-text">6.2.2 多表视图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E6%9F%A5%E7%9C%8B%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.3.</span> <span class="toc-text">6.3 查看视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E4%BF%AE%E6%94%B9%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.4.</span> <span class="toc-text">6.4 修改视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-5-%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.5.</span> <span class="toc-text">6.5 更新视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-1-%E6%8F%92%E5%85%A5%E8%A7%86%E5%9B%BE%EF%BC%88%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.12.5.1.</span> <span class="toc-text">6.5.1 插入视图（数据）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-2-%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE%EF%BC%88%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.12.5.2.</span> <span class="toc-text">6.5.2 更新视图（数据）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-5-3-%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE%EF%BC%88%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.12.5.3.</span> <span class="toc-text">6.5.3 删除视图（数据）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-6-%E5%88%A0%E9%99%A4%E8%A7%86%E5%9B%BE"><span class="toc-number">1.12.6.</span> <span class="toc-text">6.6 删除视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%88TRIGGER%EF%BC%89"><span class="toc-number">1.13.</span> <span class="toc-text">7 触发器（TRIGGER）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E5%88%9B%E5%BB%BA%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.13.1.</span> <span class="toc-text">7.1 创建使用触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E6%9F%A5%E7%9C%8B%E8%A7%A6%E5%8F%91%E5%99%A8%E7%8A%B6%E6%80%81"><span class="toc-number">1.13.2.</span> <span class="toc-text">7.2 查看触发器状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.13.3.</span> <span class="toc-text">7.3 删除触发器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-%E5%87%BD%E6%95%B0%EF%BC%88functions%EF%BC%89"><span class="toc-number">1.14.</span> <span class="toc-text">8 函数（functions）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.1.</span> <span class="toc-text">8.1 常用函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-1-%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.1.1.</span> <span class="toc-text">8.1.1 日期和时间函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.1.2.</span> <span class="toc-text">8.1.2 字符串函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-3-%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.1.3.</span> <span class="toc-text">8.1.3 数学函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-1-4-%E5%8A%A0%E5%AF%86%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.1.4.</span> <span class="toc-text">8.1.4 加密函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-2-%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0%E5%8F%AF%E4%BB%A5%E6%9F%A5%E9%98%85mysql%E5%AE%98%E6%96%B9%E6%89%8B%E5%86%8C"><span class="toc-number">1.14.1.5.</span> <span class="toc-text">8.2 其他函数可以查阅mysql官方手册</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.15.</span> <span class="toc-text">9 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="toc-number">1.15.1.</span> <span class="toc-text">9.1 存储过程和函数定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-1-%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.15.1.1.</span> <span class="toc-text">9.1.1 创建存储过程：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-2-%E4%BF%AE%E6%94%B9%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E6%88%96%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="toc-number">1.15.1.2.</span> <span class="toc-text">9.1.2 修改存储过程或函数：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-3-%E8%B0%83%E7%94%A8%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0-%E8%BF%87%E7%A8%8B"><span class="toc-number">1.15.1.3.</span> <span class="toc-text">9.1.3 调用存储函数&#x2F;过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-4-%E6%9F%A5%E7%9C%8B%E7%8E%B0%E6%9C%89%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B-%E5%87%BD%E6%95%B0"><span class="toc-number">1.15.1.4.</span> <span class="toc-text">9.1.4 查看现有存储过程&#x2F;函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-1-5-%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0-%E8%BF%87%E7%A8%8B"><span class="toc-number">1.15.1.5.</span> <span class="toc-text">9.1.5 删除存储函数&#x2F;过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E5%8F%98%E9%87%8F"><span class="toc-number">1.15.2.</span> <span class="toc-text">9.2 存储函数变量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-1-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0-%E8%BF%87%E7%A8%8B%E4%B8%AD%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="toc-number">1.15.2.1.</span> <span class="toc-text">9.2.1 存储函数&#x2F;过程中定义变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-2-2-%E5%AD%98%E5%82%A8%E5%87%BD%E6%95%B0%E8%BF%87%E7%A8%8B%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC"><span class="toc-number">1.15.2.2.</span> <span class="toc-text">9.2.2 存储函数过程变量赋值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-%E6%B8%B8%E6%A0%87"><span class="toc-number">1.15.3.</span> <span class="toc-text">9.3 游标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">1.15.4.</span> <span class="toc-text">9.4 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-1-IF%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.15.4.1.</span> <span class="toc-text">9.4. 1 IF语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-2-CASE-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.15.4.2.</span> <span class="toc-text">9.4. 2 CASE 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-3-LOOP%EF%BC%8CLEAVE-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.15.4.3.</span> <span class="toc-text">9.4. 3 LOOP，LEAVE 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-4-ITERATE-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.15.4.4.</span> <span class="toc-text">9.4. 4 ITERATE 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-5-REPEAT-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.15.4.5.</span> <span class="toc-text">9.4. 5 REPEAT 语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-4-6-WHILE-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.15.4.6.</span> <span class="toc-text">9.4. 6 WHILE 语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E6%95%B0%E6%8D%AE%E5%A4%87%E4%BB%BD%E4%B8%8E%E8%BF%98%E5%8E%9F"><span class="toc-number">1.16.</span> <span class="toc-text">10 数据备份与还原</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-%E4%BD%BF%E7%94%A8-mysqldump-%E5%A4%87%E4%BB%BD%EF%BC%88%E5%AF%BC%E5%87%BA%EF%BC%89"><span class="toc-number">1.16.1.</span> <span class="toc-text">10.1 使用 mysqldump 备份（导出）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-%E8%BF%98%E5%8E%9F%EF%BC%88%E5%AF%BC%E5%85%A5sql%E6%95%B0%E6%8D%AE%EF%BC%89"><span class="toc-number">1.16.2.</span> <span class="toc-text">10.2 还原（导入sql数据）</span></a></li></ol></li></ol></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            mysql笔记
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/2021/07/08/mysql%E7%AC%94%E8%AE%B0/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2021-07-08T07:32:41.000Z" itemprop="datePublished">2021-07-08</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/mysql/" rel="tag">mysql</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dzg_chat/article/details/88619120" title="Permalink to 【Mysql】Mysql常用指令（1）_dzg_chat的博客-CSDN博客">Source</a></p>
<p>学习过程参考视频教程：<a target="_blank" rel="noopener" href="http://www.java1234.com/a/yuanchuang/mysql/">java1234网站《一头扎进mysql》</a><br>源码及视频网盘：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hrISqlm#list/path=/">链接</a></p>
<h2 id="0前言"><a href="#0前言" class="headerlink" title="0前言"></a>0前言</h2><p>数据库（Database）是按照数据结构来组织、存储和管理数据的仓库。</p>
<p>我们也可以将数据存储在文件中，但是在文件中读写数据速度相对较慢。</p>
<p>使用关系型数据库管理系统（RDBMS）来存储和管理的大数据量。所谓的关系型数据库，是建立在关系模型基础上的数据库，借助于集合代数等数学概念和方法来处理数据库中的数据。</p>
<p>RDBMS 即关系数据库管理系统(Relational Database Management System)的特点：</p>
<ul>
<li>1.数据以表格的形式出现</li>
<li>2.每行为各种记录名称</li>
<li>3.每列为记录名称所对应的数据域</li>
<li>4.许多的行和列组成一张表单</li>
<li>5.若干的表单组成database</li>
</ul>
<h2 id="1-mysql的数据类型简介"><a href="#1-mysql的数据类型简介" class="headerlink" title="1 mysql的数据类型简介"></a>1 mysql的数据类型简介</h2><h3 id="1-1-整数类型"><a href="#1-1-整数类型" class="headerlink" title="1.1 整数类型"></a>1.1 整数类型</h3><table>
<thead>
<tr>
<th align="center">整数类型</th>
<th align="center">字节数</th>
<th align="center">无符号(unsigned)范围</th>
<th align="center">有符号(signed)范围</th>
</tr>
</thead>
<tbody><tr>
<td align="center">TINYINT</td>
<td align="center">1</td>
<td align="center">0~255</td>
<td align="center">-128~127</td>
</tr>
<tr>
<td align="center">SMALLINT</td>
<td align="center">2</td>
<td align="center">0~65535</td>
<td align="center">-32768~32767</td>
</tr>
<tr>
<td align="center">MEDIUMINT</td>
<td align="center">3</td>
<td align="center">0~16777215</td>
<td align="center">-8388608~8388607</td>
</tr>
<tr>
<td align="center">INT</td>
<td align="center">4</td>
<td align="center">0~4294967295</td>
<td align="center">-2147483648~2147483647</td>
</tr>
<tr>
<td align="center">INTEGER</td>
<td align="center">4</td>
<td align="center">0~4294967295</td>
<td align="center">-2147483648~2147483647</td>
</tr>
<tr>
<td align="center">BIGINT</td>
<td align="center">8</td>
<td align="center">0~18446744073709551615</td>
<td align="center">-9223372036854775808~9223372036854775807</td>
</tr>
</tbody></table>
<p>INTEGER和INT是相同的，一般定义主键使用INT即可。默认是有符号情况，无符号要特别说明。</p>
<h3 id="1-2-浮点数和定点数类型"><a href="#1-2-浮点数和定点数类型" class="headerlink" title="1.2 浮点数和定点数类型"></a>1.2 浮点数和定点数类型</h3><p>浮点型在数据库中存放的是近似值，而定点类型在数据库中存放的是精确值。</p>
<p>数据类型精度有无符号的范围</p>
<ul>
<li>float(m,d)单精度浮点型，(4字节)，m总位数，d小数位10^38 级别</li>
<li>double(m,d)双精度浮点型，(8字节)，m总位数，d小数位10^308 级别</li>
<li>decimal(m,d)m&lt;65 是总个数，d&lt;30 且 d&lt;m 是小数位$1</li>
</ul>
<p>float32位中，有1位符号位，8位指数位，23位尾数位，实际的范围是-2128—2127，约为-3.4E38—3.4E38</p>
<p>double64位中，1位符号位，11位指数位，52位尾数位，范围约是-1.7E308—1.7E308</p>
<p>float和double精度问题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/c-primer/p/5992696.html">参考博客</a></p>
<h3 id="1-3-日期与时间类型"><a href="#1-3-日期与时间类型" class="headerlink" title="1.3 日期与时间类型"></a>1.3 日期与时间类型</h3><p><img src="https://img-blog.csdnimg.cn/20190318230334824.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R6Z19jaGF0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>常用 DATA，TIME，DATATIME</p>
<h3 id="1-4-字符串类型"><a href="#1-4-字符串类型" class="headerlink" title="1.4 字符串类型"></a>1.4 字符串类型</h3><p>数据类型大小用途</p>
<ul>
<li>CHAR 0-255 字节定长字符串(实际分配的空间是固定的)</li>
<li>VARCHAR 0-65535 字节可变长字符串(实际分配空间根据字符存决定)</li>
<li>TEXT 0-65535 字节文本数据(TINYTEXT\LONGTEXT\MEDIUMTEXT)</li>
<li>ENUM枚举类型（只能取一个）</li>
<li>SET集合类型（可以取多个）</li>
</ul>
<h3 id="1-5-二进制类型"><a href="#1-5-二进制类型" class="headerlink" title="1.5 二进制类型"></a>1.5 二进制类型</h3><p><img src="https://img-blog.csdnimg.cn/20190318230352741.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R6Z19jaGF0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>存一些图片视频，一般存在web目录下读取快，存数据库慢。</p>
<h2 id="2-数据库（database）的基本操作"><a href="#2-数据库（database）的基本操作" class="headerlink" title="2 数据库（database）的基本操作"></a>2 数据库（database）的基本操作</h2><h3 id="2-1-数据库组件"><a href="#2-1-数据库组件" class="headerlink" title="2.1 数据库组件"></a>2.1 数据库组件</h3><ul>
<li>Mysql Shell：自带的一个高级的mysql命令行工具。</li>
<li>MySQL Workbench：为MySQL设计的ER/数据库建模工具，实现可视化管理数据库。</li>
<li>Mysql Command Line Client：MySQL的DOS界面，客户端工具。</li>
<li>Mysql Command Line Client-Unicode同上。</li>
<li>Mysqladmin：运维和管理工具</li>
</ul>
<p>退出Mysql：quit</p>
<h3 id="2-2-显示数据库"><a href="#2-2-显示数据库" class="headerlink" title="2.2 显示数据库"></a>2.2 显示数据库</h3><p>显示所有数据库：<code>show databases;</code></p>
<h3 id="2-3-创建数据库"><a href="#2-3-创建数据库" class="headerlink" title="2.3 创建数据库"></a>2.3 创建数据库</h3><p>创建数据库：<code>create database Name;</code> Name最好有一定规范，如db_book1</p>
<h3 id="2-4-删除数据库"><a href="#2-4-删除数据库" class="headerlink" title="2.4 删除数据库"></a>2.4 删除数据库</h3><p>删除数据库:<code>drop database Name;</code></p>
<h2 id="3-数据表（Tables）的基本操作"><a href="#3-数据表（Tables）的基本操作" class="headerlink" title="3 数据表（Tables）的基本操作"></a>3 数据表（Tables）的基本操作</h2><p>表是数据库存储数据的基本单位，一个表包含若干字段或记录。</p>
<h3 id="3-1-创建表"><a href="#3-1-创建表" class="headerlink" title="3.1 创建表"></a>3.1 创建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name (</span><br><span class="line">    属性名 数据类型 [完整性约束条件],</span><br><span class="line">    属性名 数据类型 [完整性约束条件],</span><br><span class="line">    .....</span><br><span class="line">    属性名 数据类型 [完整性约束条件],</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>表的常见约束条件：</p>
<p><img src="https://img-blog.csdnimg.cn/20190318230414870.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R6Z19jaGF0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>创建图书类别表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use db_book;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_bookType(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> <span class="keyword">key</span> auto_increment,</span><br><span class="line">    bookTypeName <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    bookTypeDesc <span class="type">varchar</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>创建图书类型表：</p>
<p>并将图书的类别ID，做外键关联使用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_book(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> <span class="keyword">key</span> auto_increment,</span><br><span class="line">    bookname <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    author <span class="type">varchar</span>(<span class="number">10</span>),</span><br><span class="line">    price <span class="type">decimal</span>(<span class="number">6</span>,<span class="number">2</span>),</span><br><span class="line">    bookTypeId <span class="type">int</span>,</span><br><span class="line">    <span class="keyword">constraint</span> `fk` <span class="keyword">foreign</span> <span class="keyword">key</span>(`bookTypeId`) <span class="keyword">references</span> `t_booktype`(`id`)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>若之前表已经存在了，则：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">Connect</span>(</span><br><span class="line">    con <span class="keyword">DOUBLE</span>,</span><br><span class="line">    nectid <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="keyword">Connect</span> <span class="keyword">add</span> <span class="keyword">constraint</span> `fkid` <span class="keyword">foreign</span> <span class="keyword">key</span>(`nectid`) <span class="keyword">references</span> `t_booktype`(`id`)</span><br></pre></td></tr></table></figure>
<p>注意这里的符号是数字1左侧英文输入状态下的 ` 不是单引号 ’</p>
<h3 id="3-2-查看表结构"><a href="#3-2-查看表结构" class="headerlink" title="3.2 查看表结构"></a>3.2 查看表结构</h3><p>查看基本表结构：<code>DESCRIBE/DESC 表名;</code></p>
<p>详细结构：<code>SHOW create table 表名;</code></p>
<p>显示本数据库内的所有表：<code>SHOW tables</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> t_booktype;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> t_booktype;</span><br><span class="line"><span class="keyword">show</span> tables；</span><br></pre></td></tr></table></figure>
<h3 id="3-3-修改表结构"><a href="#3-3-修改表结构" class="headerlink" title="3.3 修改表结构"></a>3.3 修改表结构</h3><p><img src="https://img-blog.csdnimg.cn/20190318230444376.PNG" alt="在这里插入图片描述"></p>
<p>修改表名： <code>alter table t_book rename t_book2;</code></p>
<p>修改t_book表的bookName字段名为bookName2，数据类型为 varchar(20): <code>alter table t_book change bookName bookName2 varchar(20);</code></p>
<p>增加字段名: <code>alter table t_book add authorage varchar(10);</code></p>
<p>带约束增加</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#加到最前面一列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_book <span class="keyword">add</span> testField <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">first</span>;</span><br><span class="line">#加到指定属性后面</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> t_book <span class="keyword">add</span> testField <span class="type">varchar</span>(<span class="number">10</span>) after author;</span><br></pre></td></tr></table></figure>
<p>删除字段名: <code>alter table t_book drop testField;</code></p>
<h3 id="3-4-删除表"><a href="#3-4-删除表" class="headerlink" title="3.4 删除表"></a>3.4 删除表</h3><p><code>drop table 表名;</code></p>
<p>有依赖关系的时候先删掉子表再删主表。</p>
<h2 id="4-表内容的相关操作"><a href="#4-表内容的相关操作" class="headerlink" title="4 表内容的相关操作"></a>4 表内容的相关操作</h2><p>先创建一个数据表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_student(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> <span class="keyword">key</span> auto_increment,</span><br><span class="line">    stuName <span class="type">varchar</span>(<span class="number">60</span>),</span><br><span class="line">    age <span class="type">int</span>,</span><br><span class="line">    sex <span class="type">varchar</span>(<span class="number">30</span>),</span><br><span class="line">    gradeName <span class="type">varchar</span>(<span class="number">60</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>插入数据： 注意里面是使用的<strong>单引号</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;张一&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大一&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">2</span>,<span class="string">&#x27;张二&#x27;</span>,<span class="number">19</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大二&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">3</span>,<span class="string">&#x27;张三&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大三&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">4</span>,<span class="string">&#x27;张四&#x27;</span>,<span class="number">21</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大四&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">5</span>,<span class="string">&#x27;张五&#x27;</span>,<span class="number">22</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大一&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">6</span>,<span class="string">&#x27;张六&#x27;</span>,<span class="number">23</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大二&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">7</span>,<span class="string">&#x27;张七&#x27;</span>,<span class="number">18</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大三&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">8</span>,<span class="string">&#x27;张八&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;大四&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>或者后面多组：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> db_book.t_student (id,stuName,age,gender,gradeName) <span class="keyword">values</span> (<span class="number">9</span>,<span class="string">&#x27;张九&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;大二&#x27;</span>),(<span class="number">10</span>,<span class="string">&#x27;张十&#x27;</span>,<span class="number">20</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;大四&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>给表取别名：<code>表名 表别名</code></p>
<p><code>select * from t_book where id=1;</code> 等价 <code>select * from t_book tb where tb.id=1;</code></p>
<p>字段取别名：<code>属性 [AS] 属性别名</code></p>
<p><code>select tb.bookName [AS] tbNa from t_book tb where tb.id=1;</code></p>
<h3 id="4-1-查询表内字段"><a href="#4-1-查询表内字段" class="headerlink" title="4.1 查询表内字段"></a>4.1 查询表内字段</h3><h4 id="4-1-1-查询所有字段："><a href="#4-1-1-查询所有字段：" class="headerlink" title="4.1.1 查询所有字段："></a>4.1.1 查询所有字段：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名;</span><br><span class="line"><span class="keyword">select</span> id,stuName,age,gender,gradeName <span class="keyword">from</span> t_student; #顺序可调</span><br><span class="line">#<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student;</span><br></pre></td></tr></table></figure>
<h4 id="4-1-2-查询指定字段："><a href="#4-1-2-查询指定字段：" class="headerlink" title="4.1.2 查询指定字段："></a>4.1.2 查询指定字段：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 指定字段<span class="number">1</span>,指定字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名;</span><br><span class="line"><span class="keyword">select</span> stuName,gender <span class="keyword">from</span> t_student;</span><br></pre></td></tr></table></figure>
<h4 id="4-1-3-where条件查询"><a href="#4-1-3-where条件查询" class="headerlink" title="4.1.3 where条件查询"></a>4.1.3 where条件查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件表达式;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age<span class="operator">&gt;</span><span class="number">19</span>;</span><br></pre></td></tr></table></figure>
<p>指定条件删除字段：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> id<span class="operator">=</span><span class="number">4</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-4-带in关键字查询"><a href="#4-1-4-带in关键字查询" class="headerlink" title="4.1.4 带in关键字查询"></a>4.1.4 带in关键字查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 字段 [<span class="keyword">NOT</span>] <span class="keyword">IN</span> (元素<span class="number">1.</span>元素<span class="number">2</span>…)；</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age <span class="keyword">in</span> (<span class="number">18</span>,<span class="number">19</span>); #只能取这两个，不是范围</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">18</span>,<span class="number">19</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-1-5-带between-and的范围查询"><a href="#4-1-5-带between-and的范围查询" class="headerlink" title="4.1.5 带between and的范围查询"></a>4.1.5 带between and的范围查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 字段 [<span class="keyword">NOT</span>] <span class="keyword">BETWEEN</span> 取值a <span class="keyword">AND</span> 取值b；</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">20</span>； #<span class="number">18</span> <span class="number">19</span> <span class="number">20</span> 都可以取，是范围</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age <span class="keyword">not</span> <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">20</span>；</span><br></pre></td></tr></table></figure>
<h3 id="4-1-6-带like模糊查询"><a href="#4-1-6-带like模糊查询" class="headerlink" title="4.1.6 带like模糊查询"></a>4.1.6 带like模糊查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 字段 [<span class="keyword">NOT</span>] <span class="keyword">LIKE</span> ‘字符串’;</span><br><span class="line">#&quot;%&quot;代表任意字符 <span class="string">&#x27;_&#x27;</span>代表单个字符，前后都可</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> stuName <span class="keyword">like</span> <span class="string">&#x27;张三&#x27;</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> stuName <span class="keyword">like</span> <span class="string">&#x27;张三%&#x27;</span>; #带<span class="string">&#x27;张三&#x27;</span>开头的</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> stuName <span class="keyword">like</span> <span class="string">&#x27;张三_&#x27;</span>; #_只能占一个位。多个就写多个_ _</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> stuName <span class="keyword">like</span> <span class="string">&#x27;%张三%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-7-空值查询"><a href="#4-1-7-空值查询" class="headerlink" title="4.1.7 空值查询"></a>4.1.7 空值查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 字段 <span class="keyword">IS</span> [<span class="keyword">NOT</span>] <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age <span class="keyword">is</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age <span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-8-带and的多条件查询"><a href="#4-1-8-带and的多条件查询" class="headerlink" title="4.1.8 带and的多条件查询"></a>4.1.8 带and的多条件查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件表达式<span class="number">1</span> <span class="keyword">AND</span> 条件表达式<span class="number">2</span> <span class="keyword">AND</span> 条件表达式<span class="number">3</span> <span class="keyword">AND</span> ...</span><br><span class="line">#注意末尾是没有分号的</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age<span class="operator">=</span><span class="number">20</span> <span class="keyword">and</span> gradeName<span class="operator">=</span><span class="string">&#x27;大四&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-1-9-带or的多条件查询"><a href="#4-1-9-带or的多条件查询" class="headerlink" title="4.1.9 带or的多条件查询"></a>4.1.9 带or的多条件查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,字段<span class="number">3.</span>.. <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件表达式<span class="number">1</span> <span class="keyword">OR</span> 条件表达式<span class="number">2</span> <span class="keyword">OR</span> 条件表达式<span class="number">3</span> <span class="keyword">OR</span> ...</span><br><span class="line">#或，语句末尾也是无分号；</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age<span class="operator">=</span><span class="number">20</span> <span class="keyword">or</span> gradeName<span class="operator">=</span><span class="string">&#x27;大四&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="4-1-10-distinct去重复查询"><a href="#4-1-10-distinct去重复查询" class="headerlink" title="4.1.10 distinct去重复查询"></a>4.1.10 distinct去重复查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> <span class="keyword">distinct</span> 字段名 <span class="keyword">from</span> 表;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> age <span class="keyword">from</span> t_student;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-11-对查询结果排序"><a href="#4-1-11-对查询结果排序" class="headerlink" title="4.1.11 对查询结果排序"></a>4.1.11 对查询结果排序</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2</span>,... <span class="keyword">from</span> 表名 <span class="keyword">order</span> <span class="keyword">by</span> 属性名 [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]</span><br><span class="line">#默认升序</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> age <span class="keyword">from</span> t_student <span class="keyword">order</span> <span class="keyword">by</span> age <span class="keyword">asc</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-12-group-by-分组查询"><a href="#4-1-12-group-by-分组查询" class="headerlink" title="4.1.12 group by 分组查询"></a>4.1.12 group by 分组查询</h3><p><img src="https://img-blog.csdnimg.cn/20190318230618668.PNG" alt="在这里插入图片描述"></p>
<p>一般不单独使用，常和聚合函数一起使用，一定注意使用的时候各个符号。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#按age分组，看每个(岁数)组有哪些stuName,GROUP_CONCAT把所有stuName拼接</span><br><span class="line"><span class="keyword">select</span> age,GROUP_CONCAT(stuName) <span class="keyword">from</span> t_student <span class="keyword">group</span> <span class="keyword">by</span> age;</span><br><span class="line"></span><br><span class="line">#按age分组，看每个(岁数)组有多少个stuName</span><br><span class="line"><span class="keyword">select</span> age,<span class="built_in">COUNT</span>(age) <span class="keyword">from</span> t_student <span class="keyword">group</span> <span class="keyword">by</span> age;</span><br><span class="line"></span><br><span class="line">#按age分组，看每个(岁数)组有多少个stuName，只输出统计总数大于<span class="number">1</span>的</span><br><span class="line"><span class="keyword">select</span> age,<span class="built_in">COUNT</span>(age) <span class="keyword">from</span> t_student <span class="keyword">group</span> <span class="keyword">by</span> age <span class="keyword">having</span> <span class="built_in">count</span>(age)<span class="operator">&gt;</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">#按age分组，看每个(岁数)组有多少个stuName，多加一行计算总和，若是文本为所有元素拼接</span><br><span class="line"><span class="keyword">select</span> age,<span class="built_in">COUNT</span>(age) <span class="keyword">from</span> t_student <span class="keyword">group</span> <span class="keyword">by</span> age <span class="keyword">with</span> <span class="keyword">rollup</span>;</span><br></pre></td></tr></table></figure>
<h3 id="4-1-13-limit-分页查询"><a href="#4-1-13-limit-分页查询" class="headerlink" title="4.1.13 limit 分页查询"></a>4.1.13 limit 分页查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">select</span> 字段<span class="number">1</span>,字段<span class="number">2.</span>.. <span class="keyword">from</span> 表名 limit 初始位置,记录数,</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student LIMIT <span class="number">0</span>,<span class="number">5</span>; #从第<span class="number">0</span>条开始查<span class="number">5</span>条</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_student LIMIT <span class="number">5</span>,<span class="number">5</span>; #从第<span class="number">5</span>条开始查<span class="number">5</span>条</span><br></pre></td></tr></table></figure>
<h2 id="4-2-使用聚合函数查询（统计）"><a href="#4-2-使用聚合函数查询（统计）" class="headerlink" title="4.2 使用聚合函数查询（统计）"></a>4.2 使用聚合函数查询（统计）</h2><p>先创建一个相关数据表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_garde(</span><br><span class="line">    <span class="type">int</span> <span class="keyword">primary</span> <span class="keyword">key</span> auto_increment,</span><br><span class="line">    stuName <span class="type">varchar</span>(<span class="number">60</span>),</span><br><span class="line">    course <span class="type">varchar</span>(<span class="number">50</span>),</span><br><span class="line">    score <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_garde (id,stuName,course,score) <span class="keyword">values</span></span><br><span class="line">    (<span class="number">1</span>,<span class="string">&#x27;张一一&#x27;</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="number">88</span>),</span><br><span class="line">    (<span class="number">2</span>,<span class="string">&#x27;张一一&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="number">89</span>),</span><br><span class="line">    (<span class="number">3</span>,<span class="string">&#x27;张一一&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="number">90</span>),</span><br><span class="line">    (<span class="number">4</span>,<span class="string">&#x27;张三三&#x27;</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="number">92</span>),</span><br><span class="line">    (<span class="number">5</span>,<span class="string">&#x27;张三三&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="number">93</span>),</span><br><span class="line">    (<span class="number">6</span>,<span class="string">&#x27;张三三&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="number">94</span>),</span><br><span class="line">    (<span class="number">7</span>,<span class="string">&#x27;张五五&#x27;</span>,<span class="string">&#x27;语文&#x27;</span>,<span class="number">76</span>),</span><br><span class="line">    (<span class="number">8</span>,<span class="string">&#x27;张五五&#x27;</span>,<span class="string">&#x27;数学&#x27;</span>,<span class="number">78</span>),</span><br><span class="line">    (<span class="number">9</span>,<span class="string">&#x27;张五五&#x27;</span>,<span class="string">&#x27;英语&#x27;</span>,<span class="number">80</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-2-1-COUNT-函数"><a href="#4-2-1-COUNT-函数" class="headerlink" title="4.2.1 COUNT() 函数"></a>4.2.1 COUNT() 函数</h3><p><img src="https://img-blog.csdnimg.cn/20190318230646588.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> t_grade; #统计t_grade表内总共有多少条目</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">as</span> total <span class="keyword">from</span> t_grade; #统计t_grade表内总共有多少条目,并把列名 <span class="built_in">count</span>(<span class="operator">*</span>) 改为 total</span><br><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> t_grade <span class="keyword">group</span> <span class="keyword">by</span> stuName; #按stuName分组，看每个(stuName)组有多少条</span><br></pre></td></tr></table></figure>
<h3 id="4-2-2-SUM-函数"><a href="#4-2-2-SUM-函数" class="headerlink" title="4.2.2 SUM() 函数"></a>4.2.2 SUM() 函数</h3><p><img src="https://img-blog.csdnimg.cn/20190318230715268.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">SUM</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">where</span> stuName<span class="operator">=</span><span class="string">&#x27;张一一&#x27;</span>; #求某个学生的总分</span><br><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">SUM</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">group</span> <span class="keyword">by</span> stuName; #按stuName分组，看每个(stuName)组的各score总和</span><br></pre></td></tr></table></figure>
<h3 id="4-2-3-AVG-函数"><a href="#4-2-3-AVG-函数" class="headerlink" title="4.2.3 AVG() 函数"></a>4.2.3 AVG() 函数</h3><p><img src="https://img-blog.csdnimg.cn/20190318230726348.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">AVG</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">where</span> stuName<span class="operator">=</span><span class="string">&#x27;张一一&#x27;</span>; #求某个学生的总分</span><br><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">AVG</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">group</span> <span class="keyword">by</span> stuName; #按stuName分组，看每个(stuName)组的平均score</span><br></pre></td></tr></table></figure>
<h3 id="4-2-4-MAX-函数"><a href="#4-2-4-MAX-函数" class="headerlink" title="4.2.4 MAX() 函数"></a>4.2.4 MAX() 函数</h3><p><img src="https://img-blog.csdnimg.cn/20190318230738747.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> stuName,course,<span class="built_in">MAX</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">where</span> stuName<span class="operator">=</span><span class="string">&#x27;张一一&#x27;</span>; #求某个学生的最高score,并列出course</span><br><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">MAX</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">group</span> <span class="keyword">by</span> stuName; #按stuName分组，看每个(stuName)组的最高score #分组前面属性只能写一个属性</span><br></pre></td></tr></table></figure>
<h3 id="4-2-5-MIN-函数"><a href="#4-2-5-MIN-函数" class="headerlink" title="4.2.5 MIN() 函数"></a>4.2.5 MIN() 函数</h3><p><img src="https://img-blog.csdnimg.cn/20190318230749316.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> stuName,course,<span class="built_in">MIN</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">where</span> stuName<span class="operator">=</span><span class="string">&#x27;张一一&#x27;</span>; #求某个学生的最低score,并列出course</span><br><span class="line"><span class="keyword">select</span> stuName,<span class="built_in">MIN</span>(score) <span class="keyword">from</span> t_grade <span class="keyword">group</span> <span class="keyword">by</span> stuName; #按stuName分组，看每个(stuName)组的最低score #分组前面属性只能写一个属性</span><br></pre></td></tr></table></figure>
<h2 id="4-3-多表连接查询"><a href="#4-3-多表连接查询" class="headerlink" title="4.3 多表连接查询"></a>4.3 多表连接查询</h2><p>将两个或两个以上的表按照某个条件连接起来，从中选取需要的数据。</p>
<h3 id="4-3-1-内连接查询"><a href="#4-3-1-内连接查询" class="headerlink" title="4.3.1 内连接查询"></a>4.3.1 内连接查询</h3><p>可以查询两个或两个以上的表，最常用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book,t_bookType; #数量取两表笛卡尔乘积(两两组合)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book,t_bookType <span class="keyword">where</span> t_book.bookTypeId<span class="operator">=</span>t_booktype.id; #数量取两表笛卡尔乘积后，看bookTypeId与id相等的条目</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> bookName,author,bookTypeName <span class="keyword">from</span> t_book,t_bookType <span class="keyword">where</span> t_book.bookTypeId<span class="operator">=</span>t_booktype.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> tb.bookName,tb.author,tby.bookTypeName <span class="keyword">from</span> t_book tb,t_bookType tby <span class="keyword">where</span> tb.bookTypeId<span class="operator">=</span>tby.id; #设置别名，防止多表字段名有重合</span><br></pre></td></tr></table></figure>
<h3 id="4-3-2-外连接查询"><a href="#4-3-2-外连接查询" class="headerlink" title="4.3.2 外连接查询"></a>4.3.2 外连接查询</h3><p>外链接可以查询某一张表的所有信息，就是把一张表不全的部分补进来，left right决定谁合并到谁之中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 属性列表 <span class="keyword">from</span> 表名<span class="number">1</span> <span class="keyword">left</span><span class="operator">|</span><span class="keyword">right</span> <span class="keyword">join</span> 表名<span class="number">2</span> <span class="keyword">on</span> 表<span class="number">1.</span>属性<span class="number">1</span><span class="operator">=</span>表<span class="number">2.</span>属性<span class="number">2</span></span><br><span class="line">#<span class="keyword">left</span>连接把表<span class="number">1</span>所有属性列出来加上表<span class="number">2</span>匹配的条目，<span class="keyword">right</span>连接吧表<span class="number">2</span>所有属性列出来加上表<span class="number">1</span>匹配的条目。空值<span class="keyword">NULL</span>，<span class="keyword">on</span>限制条件。</span><br></pre></td></tr></table></figure>
<p>1、左连接查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book <span class="keyword">left</span> <span class="keyword">join</span> t_booktype <span class="keyword">on</span> t_book.bookTypeId<span class="operator">=</span>t_booktype.id; #显示表t_book所有属性</span><br></pre></td></tr></table></figure>
<p>2、右连接查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tb.bookName,tb.author,tby.bookTypeName <span class="keyword">from</span> t_book tb <span class="keyword">right</span> <span class="keyword">join</span> t_bookType tby <span class="keyword">on</span> tb.bookTypeId<span class="operator">=</span>tby.id;</span><br><span class="line">#显示表t_bookType全部属性，推荐使用别名。</span><br></pre></td></tr></table></figure>
<h3 id="4-3-3-多条件查询"><a href="#4-3-3-多条件查询" class="headerlink" title="4.3.3 多条件查询"></a>4.3.3 多条件查询</h3><p>多个条件之间使用AND连接。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> tb.bookName,tb.author,tby.bookTypeName <span class="keyword">from</span> t_book tb,t_bookType tby <span class="keyword">where</span> tb.bookTypeId<span class="operator">=</span>tby.id <span class="keyword">AND</span> price<span class="operator">&gt;</span><span class="number">70</span>;</span><br></pre></td></tr></table></figure>
<h2 id="4-4-子查询"><a href="#4-4-子查询" class="headerlink" title="4.4 子查询"></a>4.4 子查询</h2><p>在表2中进行查询，查询的某属性是限定在表一的条件中的。</p>
<h3 id="4-4-1-带IN关键字的子查询"><a href="#4-4-1-带IN关键字的子查询" class="headerlink" title="4.4.1 带IN关键字的子查询"></a>4.4.1 带IN关键字的子查询</h3><p>一个查询语句的条件可能落在另一个SELECT语句的查询结果中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book <span class="keyword">where</span> bookTypeID [<span class="keyword">NOT</span>] <span class="keyword">in</span> (<span class="keyword">select</span> id <span class="keyword">in</span> t_booktype);</span><br><span class="line">#选择表t_book的所有属性显示，筛选bookTypeID 在表t_booktype里的</span><br></pre></td></tr></table></figure>
<h3 id="4-4-2-带比较运算条件的子查询"><a href="#4-4-2-带比较运算条件的子查询" class="headerlink" title="4.4.2 带比较运算条件的子查询"></a>4.4.2 带比较运算条件的子查询</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book <span class="keyword">where</span> price <span class="operator">&gt;=</span> (<span class="keyword">select</span> price <span class="keyword">from</span> t_pricelevel <span class="keyword">where</span> pricelevel<span class="operator">=</span><span class="number">1</span>);</span><br><span class="line">#后面括号筛选完成的条件要是数字，不是集合</span><br></pre></td></tr></table></figure>
<h3 id="4-4-3-带Exits关键字的子查询"><a href="#4-4-3-带Exits关键字的子查询" class="headerlink" title="4.4.3 带Exits关键字的子查询"></a>4.4.3 带Exits关键字的子查询</h3><p>判断性质：假如子查询语句查询到记录则进行外层查询，子查询为空不执行外层查询。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book <span class="keyword">where</span> [<span class="keyword">NOT</span>] EXITS (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_booktype);</span><br><span class="line">#后面括号筛选得到空，则不执行前面的查询</span><br></pre></td></tr></table></figure>
<h3 id="4-4-4-带ANY关键字的子查询"><a href="#4-4-4-带ANY关键字的子查询" class="headerlink" title="4.4.4 带ANY关键字的子查询"></a>4.4.4 带ANY关键字的子查询</h3><p>满足任一条件即可。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book <span class="keyword">where</span> price <span class="operator">&gt;=</span> <span class="keyword">any</span> (<span class="keyword">select</span> price <span class="keyword">from</span> t_pricelevel);</span><br><span class="line">#后面括号筛选完成的条件是集合</span><br></pre></td></tr></table></figure>
<h3 id="4-4-5-带ALL关键字的子查询"><a href="#4-4-5-带ALL关键字的子查询" class="headerlink" title="4.4.5 带ALL关键字的子查询"></a>4.4.5 带ALL关键字的子查询</h3><p>满足所有条件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_book <span class="keyword">where</span> price <span class="operator">&gt;=</span> <span class="keyword">all</span> (<span class="keyword">select</span> price <span class="keyword">from</span> t_pricelevel);</span><br><span class="line">#后面括号筛选完成的条件是集合</span><br></pre></td></tr></table></figure>
<h2 id="4-5-合并查询"><a href="#4-5-合并查询" class="headerlink" title="4.5 合并查询"></a>4.5 合并查询</h2><p>使用UNION关键字将所有查询结果合并到一起，去除相同记录。UNION ALL不去除重复记录。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> t_book; #(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> t_booktype; #(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>)</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> t_book <span class="keyword">UNION</span> <span class="keyword">select</span> id <span class="keyword">from</span> t_booktype; #(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>)</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> t_book <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">select</span> id <span class="keyword">from</span> t_booktype; #(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<h2 id="4-6-插入、更新、删除数据"><a href="#4-6-插入、更新、删除数据" class="headerlink" title="4.6 插入、更新、删除数据"></a>4.6 插入、更新、删除数据</h2><h3 id="4-6-1-插入"><a href="#4-6-1-插入" class="headerlink" title="4.6.1 插入"></a>4.6.1 插入</h3><p>所有字段插入数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">insert</span> <span class="keyword">into</span> 表名 <span class="keyword">values</span>(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3.</span>..);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_book <span class="keyword">values</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;围城&#x27;</span>,,<span class="string">&#x27;钱钟书&#x27;</span>,<span class="number">1</span>)；</span><br><span class="line">#自增的属性可以设为<span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<p>指定字段插入数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">insert</span> <span class="keyword">into</span> 表名(属性<span class="number">1</span>,属性<span class="number">2</span>,属性n) <span class="keyword">values</span>(值<span class="number">1</span>,值<span class="number">2</span>,值<span class="number">3.</span>..);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_book(id,bookName,price,author,bookTypeId) <span class="keyword">values</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;围城&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;钱钟书&#x27;</span>,<span class="number">1</span>)；</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_book(bookName,author) <span class="keyword">values</span>(<span class="string">&#x27;围城&#x27;</span>,<span class="string">&#x27;钱钟书&#x27;</span>)； #也可以取指定的属性插入，其他默认为<span class="keyword">NULL</span></span><br></pre></td></tr></table></figure>
<p>同时插入多条记录：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">insert</span> <span class="keyword">into</span> 表名[(属性列表)] <span class="keyword">values</span> (取值列表<span class="number">1</span>),(取值列表<span class="number">2</span>),...(取值列表n);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_book(id,bookName,price,author,bookTypeId) <span class="keyword">values</span> (<span class="keyword">NULL</span>,<span class="string">&#x27;围城2&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;钱钟书&#x27;</span>,<span class="number">1</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;围城3&#x27;</span>,<span class="number">28</span>,<span class="string">&#x27;钱钟书&#x27;</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h3 id="4-6-2-更新"><a href="#4-6-2-更新" class="headerlink" title="4.6.2 更新"></a>4.6.2 更新</h3><p>表里的一些属性值发生了变化，及时更新</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">update</span> 表名 <span class="keyword">set</span> 属性<span class="number">1</span> <span class="operator">=</span>取值<span class="number">1</span>,属性<span class="number">2</span><span class="operator">=</span>取值<span class="number">2.</span>..属性n<span class="operator">=</span>取值n <span class="keyword">where</span> 条件表达式;</span><br><span class="line"><span class="keyword">update</span> t_book <span class="keyword">set</span> bookName<span class="operator">=</span><span class="string">&#x27;围城&#x27;</span>,price<span class="operator">=</span><span class="number">40</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">5</span>; #逗号分隔</span><br><span class="line"></span><br><span class="line"><span class="keyword">update</span> t_book <span class="keyword">set</span> bookName<span class="operator">=</span><span class="string">&#x27;钱钟书的书&#x27;</span> <span class="keyword">where</span> <span class="keyword">like</span> <span class="string">&#x27;%围%&#x27;</span>；</span><br><span class="line">#使用模糊查询，将表中含有 围 字书名的书全部改为 钱钟书的书</span><br></pre></td></tr></table></figure>
<h3 id="4-6-3-删除"><a href="#4-6-3-删除" class="headerlink" title="4.6.3 删除"></a>4.6.3 删除</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">delete</span> <span class="keyword">from</span> 表名 <span class="keyword">where</span> [条件表达式]</span><br><span class="line">#条件不是主键可能会报错，需要百度修改数据库模式。</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_book <span class="keyword">where</span> id<span class="operator">=</span><span class="number">6</span>; #删除一条</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age<span class="operator">&gt;=</span><span class="number">20</span>; #符合条件多条</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> t_student <span class="keyword">where</span> age<span class="operator">=</span><span class="string">&#x27;2%&#x27;</span>; #错误，非字符串不能这么匹配</span><br></pre></td></tr></table></figure>
<h2 id="5-索引"><a href="#5-索引" class="headerlink" title="5.索引"></a>5.索引</h2><p>索引类似图书的目录，方便快速定位，查找指定内容，提高查询速度。</p>
<p>索引是数据库的一个对象，数据库中的一列或者多列组成，它不能独立存在，必须对某个表对象进行依赖。</p>
<p>索引保存在information_schema数据库里的STATISTICS表中。</p>
<ul>
<li>优点：提高查询数据的速度</li>
<li>缺点：创建和维护索引的时间增加了</li>
</ul>
<h3 id="5-1-索引分类"><a href="#5-1-索引分类" class="headerlink" title="5.1 索引分类"></a>5.1 索引分类</h3><p>查看数据库 db_book 内所有索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.`innodb_index_stats` a <span class="keyword">where</span> a.`database_name` <span class="operator">=</span> <span class="string">&#x27;db_book&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>查看当前table的索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> index <span class="keyword">from</span> tableName;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20190319091846612.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2R6Z19jaGF0,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="5-2-创建索引"><a href="#5-2-创建索引" class="headerlink" title="5.2 创建索引"></a>5.2 创建索引</h3><p>创建的关键字 <strong>INDEX</strong></p>
<p>一般主键在创建时默认就是唯一性索引。</p>
<p>方法1：最开始创建表的时候添加索引：</p>
<p><img src="https://img-blog.csdnimg.cn/20190319092027228.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#普通 单列 索引</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_u1(id <span class="type">int</span>, uName <span class="type">varchar</span>(<span class="number">20</span>), password <span class="type">varchar</span>(<span class="number">20</span>), INDEX (uName));</span><br><span class="line"></span><br><span class="line">#唯一性单列索引  注意对应位置含义</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_u2(id <span class="type">int</span>, uName <span class="type">varchar</span>(<span class="number">20</span>), password <span class="type">varchar</span>(<span class="number">20</span>), <span class="keyword">UNIQUE</span> INDEX (uName));</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_u2(id <span class="type">int</span>, uName <span class="type">varchar</span>(<span class="number">20</span>), password <span class="type">varchar</span>(<span class="number">20</span>), <span class="keyword">UNIQUE</span> INDEX index_uName(uName)); #带别名</span><br><span class="line"></span><br><span class="line">#全文单列索引</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_u2(id <span class="type">int</span>, uName <span class="type">varchar</span>(<span class="number">20</span>), password <span class="type">varchar</span>(<span class="number">20</span>), FULLTEXT INDEX (uName));</span><br><span class="line"></span><br><span class="line">#多列索引，uName,password两列属性指向一个索引</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_u3(id <span class="type">int</span>, uName <span class="type">varchar</span>(<span class="number">20</span>), password <span class="type">varchar</span>(<span class="number">20</span>), INDEX index_uName_password(uName,password));</span><br></pre></td></tr></table></figure>
<p>方法2：为已经存在的表添加索引：</p>
<p><img src="https://img-blog.csdnimg.cn/20190319092252629.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> INDEX index_uName <span class="keyword">ON</span> t_u4(uName); #新增普通单列索引</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">UNIQUE</span> INDEX index_uName <span class="keyword">ON</span> t_u4(uName); #新增唯一性单列索引</span><br><span class="line"><span class="keyword">create</span> INDEX index_uName_password <span class="keyword">ON</span> t_u4(uName,password); #新增多列索引</span><br></pre></td></tr></table></figure>
<p>方法3：使用alter方法创建索引：</p>
<p><img src="https://img-blog.csdnimg.cn/201903190923342.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">TABLE</span> t_u5 <span class="keyword">ADD</span> INDEX index_uName(uName); #新增普通单列索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">TABLE</span> t_u5 <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> INDEX index_uName(uName); #新增唯一性单列索引</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">TABLE</span> t_u5 <span class="keyword">ADD</span> INDEX index_uName_password(uName,password); #新增多列索引</span><br></pre></td></tr></table></figure>
<h3 id="5-3-删除索引"><a href="#5-3-删除索引" class="headerlink" title="5.3 删除索引"></a>5.3 删除索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">DROP</span> INDEX 索引名 <span class="keyword">ON</span> 表名;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> INDEX index_userName <span class="keyword">ON</span> t_u5;</span><br><span class="line"><span class="keyword">DROP</span> INDEX index_userName_password <span class="keyword">ON</span> t_u5; #删除多列索引</span><br></pre></td></tr></table></figure>
<h2 id="6-数据库视图（View）"><a href="#6-数据库视图（View）" class="headerlink" title="6 数据库视图（View）"></a>6 数据库视图（View）</h2><ul>
<li>视图是从一个或几个基本表（或视图）中导出的虚拟的表。</li>
<li>视图是从一个或多个实际表中获得的，那些用于产生视图的表叫做该视图的基表。在系统的数据字典中仅存放了视图的定义，不存放对应的数据，通过视图看到的数据存放在基表中。</li>
<li>通过视图修改数据时，实际上是在改变基表中的数据；相反地，基表数据的改变也会自动反映在由基表产生的视图中。</li>
<li>由于逻辑上的原因，有些视图可以修改对应的基表，而有些则不能（仅仅能查询）。</li>
</ul>
<h3 id="6-1-视图的好处"><a href="#6-1-视图的好处" class="headerlink" title="6.1 视图的好处"></a>6.1 视图的好处</h3><ul>
<li>提高重用性，针对重复使用的属性字段；</li>
<li>增强安全性，不同权限用户使用部分数据创建的对应视图；</li>
<li>表的逻辑独立性。</li>
</ul>
<p>可参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sustudy/p/4166714.html">博客</a></p>
<h3 id="6-2-创建视图"><a href="#6-2-创建视图" class="headerlink" title="6.2 创建视图"></a>6.2 创建视图</h3><p><img src="https://img-blog.csdnimg.cn/20190319105348206.PNG" alt="在这里插入图片描述"></p>
<p>ALGORITHM表示视图选择的算法（可选参数）</p>
<ul>
<li>UNDEFINED：MySQL将自动选择所要使用的算法</li>
<li>MERGE：将视图的语句与视图定义合并起来，使得视图定义的某一部分取代语句的对应部分</li>
<li>TEMPTABLE：将视图的结果存入临时表，然后使用临时表执行语句</li>
</ul>
<p>WITH CHECK OPTION表示更新视图时要保证在该试图的权限范围之内（可选参数）</p>
<h4 id="6-2-1-单表视图"><a href="#6-2-1-单表视图" class="headerlink" title="6.2.1 单表视图"></a>6.2.1 单表视图</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v1 <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_book; #用t_book所有字段生成视图v1</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v1; #查看视图v1的所有的字段属性</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v2 <span class="keyword">AS</span> <span class="keyword">SELECT</span> bookName,price <span class="keyword">FROM</span> t_book; #用t_book的bookName,price字段生成视图v2</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v3(b,p) <span class="keyword">AS</span> <span class="keyword">SELECT</span> bookName,price <span class="keyword">FROM</span> t_book; #创建的视图内将bookName和price字段重命名为 b 和 p</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v3;</span><br></pre></td></tr></table></figure>
<h4 id="6-2-2-多表视图"><a href="#6-2-2-多表视图" class="headerlink" title="6.2.2 多表视图"></a>6.2.2 多表视图</h4><p><strong>同一个数据库下不同表：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v4 <span class="keyword">as</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table1) <span class="keyword">union</span> <span class="keyword">all</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table2); #合并查询</span><br></pre></td></tr></table></figure>
<p>或：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> v5 <span class="keyword">as</span> <span class="keyword">select</span> bookName,bookTypeName <span class="keyword">from</span> t_book,t_booktype <span class="keyword">where</span> t_book.bookTypeID<span class="operator">=</span>t_booktype.id;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v5 <span class="keyword">AS</span> <span class="keyword">SELECT</span> tb.bookName,tby.bookTypeName <span class="keyword">FROM</span> t_book tb,t_booktype tby <span class="keyword">WHERE</span> tb.bookTypeId<span class="operator">=</span>tby.id; #从两张取了别名的表里按指定条件创建视图</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v5;</span><br></pre></td></tr></table></figure>
<p><strong>不同数据库下的不同表：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#在数据库<span class="number">1</span> 目录下创建</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> 数据库<span class="number">1.</span>v <span class="keyword">as</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 数据库<span class="number">1.</span>table1) <span class="keyword">union</span> <span class="keyword">all</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 数据库<span class="number">2.</span>table2);</span><br><span class="line"></span><br><span class="line">#在数据库<span class="number">2</span> 目录下创建</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> 数据库<span class="number">2.</span>v <span class="keyword">as</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 数据库<span class="number">1.</span>table1) <span class="keyword">union</span> <span class="keyword">all</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 数据库<span class="number">2.</span>table2);</span><br></pre></td></tr></table></figure>
<h3 id="6-3-查看视图"><a href="#6-3-查看视图" class="headerlink" title="6.3 查看视图"></a>6.3 查看视图</h3><p>通过指令或数据库图形管理工具查看。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESC</span> view1; #基本的视图内容信息：字段名、类型等</span><br><span class="line"></span><br><span class="line"># 查看状态信息：包含创建时间，一些虚拟状态值</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLE</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;view1&#x27;</span>; #视图是虚表，所以没有<span class="keyword">collation</span>之类的信息</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLE</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;t_book&#x27;</span>; #t_book是表，有<span class="keyword">collation</span>之类的信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view1; #详细信息，包括编码，建表语句等</span><br></pre></td></tr></table></figure>
<h3 id="6-4-修改视图"><a href="#6-4-修改视图" class="headerlink" title="6.4 修改视图"></a>6.4 修改视图</h3><p>方法1：</p>
<p><img src="https://img-blog.csdnimg.cn/20190319121857494.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#视图v1有<span class="number">4</span>个字段，改为只有bookName和price</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> v1(bookName,price) <span class="keyword">AS</span> <span class="keyword">SELECT</span> bookName,price <span class="keyword">FROM</span> t_book;</span><br></pre></td></tr></table></figure>
<p>方法2：</p>
<p><img src="https://img-blog.csdnimg.cn/20190319121906237.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#视图v1只有bookName和price，改为t_book所有的字段</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> v1 <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t_book;</span><br></pre></td></tr></table></figure>
<h3 id="6-5-更新视图"><a href="#6-5-更新视图" class="headerlink" title="6.5 更新视图"></a>6.5 更新视图</h3><ul>
<li>通过视图来插入、更新、删除表中的<strong>数据</strong>。</li>
<li>视图只是一个虚表，没有数据，操作的是识图来源的<strong>基表</strong></li>
<li>更新视图要在权限范围内。</li>
</ul>
<h4 id="6-5-1-插入视图（数据）"><a href="#6-5-1-插入视图（数据）" class="headerlink" title="6.5.1 插入视图（数据）"></a>6.5.1 插入视图（数据）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#视图v1有id,bookName,price,author,bookTypeID</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> v1 <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;java good&#x27;</span>,<span class="number">120</span>,<span class="string">&#x27;feng&#x27;</span>,<span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<h4 id="6-5-2-更新视图（数据）"><a href="#6-5-2-更新视图（数据）" class="headerlink" title="6.5.2 更新视图（数据）"></a>6.5.2 更新视图（数据）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> v1 <span class="keyword">SET</span> bookName<span class="operator">=</span><span class="string">&#x27;java very good&#x27;</span>,price<span class="operator">=</span><span class="number">200</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h4 id="6-5-3-删除视图（数据）"><a href="#6-5-3-删除视图（数据）" class="headerlink" title="6.5.3 删除视图（数据）"></a>6.5.3 删除视图（数据）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> v1 <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="6-6-删除视图"><a href="#6-6-删除视图" class="headerlink" title="6.6 删除视图"></a>6.6 删除视图</h3><p>删除数据库中已经存在的视图，删除视图并不会删除数据，只是删除视图定义。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> IF <span class="keyword">EXISTS</span> view1;</span><br></pre></td></tr></table></figure>
<h2 id="7-触发器（TRIGGER）"><a href="#7-触发器（TRIGGER）" class="headerlink" title="7 触发器（TRIGGER）"></a>7 触发器（TRIGGER）</h2><p>执行某项操作（INSERT、UPDATE、DELETE）时候自动触发执行预设好的相对应操作。</p>
<p>如在表a添加数据时表b里的对应属性也进行一个变化。</p>
<p>相同的表相同的操作只能创建一个对应的触发器。</p>
<h3 id="7-1-创建使用触发器"><a href="#7-1-创建使用触发器" class="headerlink" title="7.1 创建使用触发器"></a>7.1 创建使用触发器</h3><p>单个执行语句的触发器：</p>
<p><img src="https://img-blog.csdnimg.cn/20190319143423985.PNG" alt="在这里插入图片描述"></p>
<p>注意执行语句where 后面的部分old和new</p>
<ul>
<li>old表示插入之前的值，old用在删除和修改</li>
<li>new表示新插入的值，new用在添加、更新和修改</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#创建<span class="keyword">trigger</span>：在<span class="keyword">insert</span>插入新数据操作之后 更新书的数量 <span class="keyword">new</span>表示插入的条目</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trig_book AFTER <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> t_book <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">        <span class="keyword">UPDATE</span> t_bookType <span class="keyword">SET</span> bookNum<span class="operator">=</span>bookNum<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> new.bookTypeId<span class="operator">=</span>t_booktype.id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_book <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;java好&#x27;</span>,<span class="number">100</span>,<span class="string">&#x27;ke&#x27;</span>,<span class="number">1</span>); #插入操作触发<span class="keyword">trigger</span></span><br></pre></td></tr></table></figure>
<p>多条执行语句：</p>
<p><img src="https://img-blog.csdnimg.cn/20190319143439304.PNG" alt="在这里插入图片描述"></p>
<p>默认mysql是遇到一个分号 ； 执行一次的。</p>
<p>DELIMITER | 是告诉mysql解释器不要将多条程序体里面单条语句的分号 ；直接执行，是作为一个程序体的。也可以使用 $$ // 等表示</p>
<p>可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/yuxin6866/article/details/52722913">厚积_薄发博客</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#创建触发器</span><br><span class="line">DELIMITER <span class="operator">|</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trig_book2 AFTER <span class="keyword">DELETE</span></span><br><span class="line">    <span class="keyword">ON</span> t_book <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">UPDATE</span> t_bookType <span class="keyword">SET</span> bookNum<span class="operator">=</span>bookNum<span class="number">-1</span> <span class="keyword">WHERE</span> old.bookTypeId<span class="operator">=</span>t_booktype.id;</span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_log <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,NOW(),<span class="string">&#x27;在book表里删除了一条数据&#x27;</span>); #mysql里NOW（）表示当前时间</span><br><span class="line">        <span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_test <span class="keyword">WHERE</span> old.bookTypeId<span class="operator">=</span>t_test.id; #顺便把t_test的一条也删掉</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">|</span></span><br><span class="line">DELIMITER;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_book <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">5</span>; #删除操作触发<span class="keyword">trigger</span></span><br></pre></td></tr></table></figure>
<p>上面函数的作用是：当删除 <code>t_book</code> 里面 id=5的数据时，触发在</p>
<ul>
<li>给<code>t_bookType</code> 表中 bookNum数量-1</li>
<li>在日志表 <code>t_log</code> 中加入一条记录</li>
<li>在测试表 <code>t_test</code> 里面删除了和之前记录id相等的数据 <code>old.bookTypeId=t_test.id</code></li>
</ul>
<h3 id="7-2-查看触发器状态"><a href="#7-2-查看触发器状态" class="headerlink" title="7.2 查看触发器状态"></a>7.2 查看触发器状态</h3><p>查看触发器的状态：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TRIGGERS; #列出来所有的</span><br></pre></td></tr></table></figure>
<h3 id="7-3-删除触发器"><a href="#7-3-删除触发器" class="headerlink" title="7.3 删除触发器"></a>7.3 删除触发器</h3><p>注意结束符号 ；之前是否有空格或者全半角区别，可能引起错误。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> trig_book ;</span><br></pre></td></tr></table></figure>
<p>触发器补充介绍：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u012964753/article/details/81175631">硕果累累的博客</a></p>
<h2 id="8-函数（functions）"><a href="#8-函数（functions）" class="headerlink" title="8 函数（functions）"></a>8 函数（functions）</h2><h3 id="8-1-常用函数"><a href="#8-1-常用函数" class="headerlink" title="8.1 常用函数"></a>8.1 常用函数</h3><h4 id="8-1-1-日期和时间函数"><a href="#8-1-1-日期和时间函数" class="headerlink" title="8.1.1 日期和时间函数"></a>8.1.1 日期和时间函数</h4><p>获取当前时间的<strong>语句</strong>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> now();</span><br><span class="line"><span class="keyword">select</span> sysdate();</span><br><span class="line"></span><br><span class="line">获取日期时间的各个部分：日期、时间、年、季度、月、日、小时、分钟、秒</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span> <span class="variable">@test</span><span class="operator">=</span><span class="string">&#x27;2019-03-26 23:08:12.123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="type">date</span>(<span class="variable">@test</span>); 		#示例</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="type">date</span>(<span class="variable">@test</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2019</span><span class="number">-03</span><span class="number">-26</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br></pre></td></tr></table></figure>
<p>其他类似：time、year 、quarter、month、week、day、hour、minute、second</p>
<p>与时间相关<strong>函数</strong>：</p>
<p>名称作用CURDATE()返回当前日期CURTIME()返回当前时间MONTH(d)返回当前日期d中的月份值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CURDATE(),CURTIME(),<span class="keyword">MONTH</span>(birthday) <span class="keyword">AS</span> m <span class="keyword">FROM</span> <span class="keyword">table</span>; #birthday是列名，<span class="keyword">MONTH</span>(birthday)重命名为m</span><br><span class="line"><span class="keyword">select</span> curdate(),curtime() <span class="keyword">from</span> gongkuang limit <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h4 id="8-1-2-字符串函数"><a href="#8-1-2-字符串函数" class="headerlink" title="8.1.2 字符串函数"></a>8.1.2 字符串函数</h4><ul>
<li><code>CHAR_LENGTH(s)</code>计算字符串字符数</li>
<li><code>UPPER(s)</code>转为大写</li>
<li><code>LOWER(s)</code>转为小写</li>
<li><code>CONCAT(s1,s2...)</code>拼接多个字符串</li>
<li><code>LEFT(str,len)</code> <code>RIGHT(str,len)</code>返回字符串str 从左、右起len长的子串。</li>
<li><code>REVERSE(str)</code>把str倒序</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> uName,<span class="keyword">CHAR_LENGTH</span>(uName),<span class="built_in">UPPER</span>(uName) up,<span class="built_in">LOWER</span>(uName) low,concat(uName,<span class="built_in">upper</span>(uName)) <span class="keyword">FROM</span> t_u1;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<p><img src="https://img-blog.csdnimg.cn/2019033114033833.PNG" alt="在这里插入图片描述"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> uName,<span class="keyword">left</span>(uName,<span class="number">2</span>),<span class="keyword">right</span>(uName,<span class="number">2</span>) <span class="keyword">from</span> t_u1;</span><br></pre></td></tr></table></figure>
<p>其他还有很多字符串函数可以需要的时候再查阅使用：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ASCII(str),</span><br><span class="line">BIN(N),</span><br><span class="line">CONV(str,from_base,to_base),</span><br><span class="line">ELT(N,str1,str2,str3,…),</span><br><span class="line">FIELD(str,str1,str2,str3,…),</span><br><span class="line">FIND_IN_SET(str,strlist),</span><br><span class="line">FORMAT(X,D),</span><br><span class="line"><span class="keyword">INSERT</span>(str,pos,len,newstr),</span><br><span class="line">LOCATE(substr,str,pos),</span><br><span class="line">REPLACE(str,from_str,to_str),</span><br><span class="line"><span class="built_in">POSITION</span>(substr <span class="keyword">IN</span> str),</span><br><span class="line">INSTR(str,substr),</span><br></pre></td></tr></table></figure>
<h4 id="8-1-3-数学函数"><a href="#8-1-3-数学函数" class="headerlink" title="8.1.3 数学函数"></a>8.1.3 数学函数</h4><ul>
<li><code>ABS(x)</code>绝对值</li>
<li><code>SQRT(x)</code>平方根</li>
<li><code>MOD(x，y)</code>求余</li>
<li><code>ROUND(X,Y)</code>X的Y位四舍五入小数</li>
<li><code>CEIL(x)</code>、<code>CEILING(x)</code>向上取整</li>
<li><code>FLOOR(x)</code>向下取整</li>
<li><code>POW(x,y)</code>、<code>POWER(x,y)</code>幂运算，求x的y次方幂</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> num,<span class="built_in">ABS</span>(num),<span class="built_in">SQRT</span>(num),<span class="built_in">MOD</span>(num,<span class="number">3</span>) <span class="keyword">from</span> t_t; #计算num列的绝对值和对<span class="number">3</span>求余</span><br></pre></td></tr></table></figure>
<h4 id="8-1-4-加密函数"><a href="#8-1-4-加密函数" class="headerlink" title="8.1.4 加密函数"></a>8.1.4 加密函数</h4><ul>
<li><code>PASSWORD(str)</code>对密码加密，不可逆</li>
<li><code>MD5(str)</code>、<code>SHA5()</code>MD5校验、SHA5校验</li>
<li><code>ENCODE(str，pswd_str)</code>加密字符串，结果必须用BLOB类型保存</li>
<li><code>DECODE(crypt_str,pswd_str)</code>解密字符串</li>
</ul>
<p>在插入数据的时候设置加密的格式、加密数据和加密解密的钥匙：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#t_t有id,birthday,uName,num,password,pp    其中pp是<span class="type">blob</span>类型</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_t <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;2018-11-11&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>,PASSWORD(<span class="string">&#x27;123456&#x27;</span>)); #password字段不是明文<span class="number">123456</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_t <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;2018-11-11&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>,MD5(<span class="string">&#x27;123456&#x27;</span>)); #password字段不是明文<span class="number">123456</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_t <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;2018-11-11&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>,MD5(<span class="string">&#x27;123456&#x27;</span>),ENCODE(<span class="string">&#x27;abcd&#x27;</span>,<span class="string">&#x27;aa&#x27;</span>)); #pp是明文abcd用aa加密得到的二进制</span><br><span class="line"><span class="keyword">SELECT</span> DECODE(pp,<span class="string">&#x27;aa&#x27;</span>) <span class="keyword">FROM</span> t_t <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">1</span>; #用aa解密pp 得到abcd</span><br></pre></td></tr></table></figure>
<h4 id="8-2-其他函数可以查阅mysql官方手册"><a href="#8-2-其他函数可以查阅mysql官方手册" class="headerlink" title="8.2 其他函数可以查阅mysql官方手册"></a>8.2 其他函数可以查阅mysql官方手册</h4><h2 id="9-存储过程"><a href="#9-存储过程" class="headerlink" title="9 存储过程"></a>9 存储过程</h2><h3 id="9-1-存储过程和函数定义"><a href="#9-1-存储过程和函数定义" class="headerlink" title="9.1 存储过程和函数定义"></a>9.1 存储过程和函数定义</h3><p>存储过程和函数是在数据库中定义一些 SQL 语句的集合，然后直接调用这些存储过程和函数来执行已经定义好的 SQL 语句。存储过程和函数可以避免开发人员重复的编写相同的 SQL 语句。而且，存储过程和函数是在 MySQL服务器中存储和执行的，可以减少客户端和服务器端的数据传输；</p>
<p>区别：</p>
<ul>
<li>存储函数必须有返回值，而存储过程没有，</li>
<li>存储过程的参数可以使用 in，out，inout 类型，而存储函数的参数只能是 in 类型的。</li>
<li>如果有函数从其他类型的数据库迁移到 MySQL，那么就可能因此需要将函数改造成存储过程</li>
</ul>
<h4 id="9-1-1-创建存储过程："><a href="#9-1-1-创建存储过程：" class="headerlink" title="9.1.1 创建存储过程："></a>9.1.1 创建存储过程：</h4><p>创建存储过程或函数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> sp_name ([proc_parameter[,...]])</span><br><span class="line">    [characteristic ...] routine_body</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> sp_name ([func_parameter[,...]])</span><br><span class="line">    <span class="keyword">RETURNS</span> type</span><br><span class="line">    [characteristic ...] routine_body</span><br><span class="line"></span><br><span class="line">sp_name 参数是存储过程<span class="operator">/</span>或存储函数的名称</span><br><span class="line"></span><br><span class="line">proc_parameter 表示存储过程的参数列表，每个参数格式 [<span class="keyword">IN</span><span class="operator">|</span><span class="keyword">OUT</span><span class="operator">|</span><span class="keyword">INOUT</span>] param_name type</span><br><span class="line">    <span class="keyword">IN</span> 表示输入参数；<span class="keyword">OUT</span> 表示输出参数；<span class="keyword">INOUT</span> 表示既可以是输入，也可以是输出；param_name 参数是</span><br><span class="line">    存储过程的参数名称；type 参数指定存储过程的参数类型，该类型可以是 MySQL 数据库的任意数据类型</span><br><span class="line"></span><br><span class="line">func_parameter:param_name type</span><br><span class="line"></span><br><span class="line">type:<span class="keyword">Any</span> valid MySQL data type</span><br><span class="line"></span><br><span class="line">characteristic 参数指定存储过程的特性</span><br><span class="line">可取:LANGUAGE SQL| [NOT] DETERMINISTIC| &#123; CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA &#125;| SQL SECURITY &#123; DEFINER | INVOKER &#125;| COMMENT &#x27;string&#x27;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">LANGUAGE</span> <span class="keyword">SQL</span>：说明 routine_body 部分是由 <span class="keyword">SQL</span> 语言的语句组成</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">NOT</span>] <span class="keyword">DETERMINISTIC</span>  存储过程输出结果是否是确定的，即每次输入一样输出也一样的程序，<span class="keyword">NOT</span> 每次输入一样但输出可能不一样</span><br><span class="line"></span><br><span class="line">    &#123; CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA &#125;| SQL SECURITY &#123; DEFINER | INVOKER &#125; 指明子程序使用 SQL 语句的限制</span><br><span class="line">        <span class="operator">-</span> <span class="keyword">CONTAINS</span> <span class="keyword">SQL</span>子程序包含 <span class="keyword">SQL</span> 语句，但不包含读或写数据的语句。默认格式</span><br><span class="line">        <span class="operator">-</span> <span class="keyword">NO</span> <span class="keyword">SQL</span> 表示子程序中不包含 <span class="keyword">SQL</span>语句</span><br><span class="line">        <span class="operator">-</span> <span class="keyword">READS</span> <span class="keyword">SQL</span> DATA 子程序中包含读数据的语句</span><br><span class="line">        <span class="operator">-</span> <span class="keyword">MODIFIES</span> <span class="keyword">SQL</span> DATA 表示子程序中包含写数据的语句</span><br><span class="line"></span><br><span class="line">    SQL SECURITY &#123; DEFINER | INVOKER &#125;；指明谁有权限来执行。</span><br><span class="line">        <span class="operator">-</span> DEFINER 表示只有定义者自己才能够执行；</span><br><span class="line">        <span class="operator">-</span> INVOKER 表示调用者可以执行。默认情况下，系统指定的权限是 DEFINER。</span><br><span class="line"></span><br><span class="line">    COMMENT ‘string’ ：注释信息；</span><br><span class="line"></span><br><span class="line">routine_body 参数是 <span class="keyword">SQL</span> 代码的内容，可以用 BEGIN...END 来标志 <span class="keyword">SQL</span> 代码的开始和结束</span><br></pre></td></tr></table></figure>
<p>创建存储过程/函数示例sql语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_book ( <span class="keyword">IN</span> bT <span class="type">INT</span>,<span class="keyword">OUT</span> count_num <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">READS</span> <span class="keyword">SQL</span> DATA</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">         <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> t_book <span class="keyword">WHERE</span> bookTypeId<span class="operator">=</span>bT;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> pro_book(<span class="number">1</span>,<span class="variable">@total</span>); #调用存储过程</span><br><span class="line"></span><br><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> func_book (bookId <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">RETURN</span> ( <span class="keyword">SELECT</span> bookName <span class="keyword">FROM</span> t_book <span class="keyword">WHERE</span> id<span class="operator">=</span>bookId );</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> func_book(<span class="number">2</span>); #调用存储函数</span><br></pre></td></tr></table></figure>
<h4 id="9-1-2-修改存储过程或函数："><a href="#9-1-2-修改存储过程或函数：" class="headerlink" title="9.1.2 修改存储过程或函数："></a>9.1.2 修改存储过程或函数：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER &#123;PROCEDURE | FUNCTION&#125; sp_name [characteristic ...]</span><br><span class="line">#characteristic:参数含义类似</span><br></pre></td></tr></table></figure>
<h4 id="9-1-3-调用存储函数-过程"><a href="#9-1-3-调用存储函数-过程" class="headerlink" title="9.1.3 调用存储函数/过程"></a>9.1.3 调用存储函数/过程</h4><p>调用存储过程 <code>CALL sp_name([param_name[,...]);</code></p>
<p>调用存储函数 <code>sp_name([param_name[,...]);</code></p>
<h4 id="9-1-4-查看现有存储过程-函数"><a href="#9-1-4-查看现有存储过程-函数" class="headerlink" title="9.1.4 查看现有存储过程/函数"></a>9.1.4 查看现有存储过程/函数</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#SHOW &#123;PROCEDURE | FUNCTION&#125; STATUS [LIKE &#x27;pattern&#x27;] #查看状态</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PROCEDURE</span> STATUS <span class="keyword">LIKE</span> <span class="string">&#x27;pro_book&#x27;</span>;</span><br><span class="line"></span><br><span class="line">SHOW CREATE &#123;PROCEDURE | FUNCTION&#125; sp_name #查看定义</span><br></pre></td></tr></table></figure>
<h4 id="9-1-5-删除存储函数-过程"><a href="#9-1-5-删除存储函数-过程" class="headerlink" title="9.1.5 删除存储函数/过程"></a>9.1.5 删除存储函数/过程</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#DROP &#123;PROCEDURE | FUNCTION&#125; [IF EXISTS] sp_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> pro_user3;</span><br></pre></td></tr></table></figure>
<h3 id="9-2-存储函数变量"><a href="#9-2-存储函数变量" class="headerlink" title="9.2 存储函数变量"></a>9.2 存储函数变量</h3><h4 id="9-2-1-存储函数-过程中定义变量"><a href="#9-2-1-存储函数-过程中定义变量" class="headerlink" title="9.2.1 存储函数/过程中定义变量"></a>9.2.1 存储函数/过程中定义变量</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> var_name[,...] type [<span class="keyword">DEFAULT</span> <span class="keyword">value</span>]</span><br></pre></td></tr></table></figure>
<p>定义的变量不赋值时默认插入为NULL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#t_user有id,uName,password</span><br><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user()</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> a,b <span class="type">VARCHAR</span>(<span class="number">20</span>) ;</span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,a,b);</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> pro_user(); #调用存储过程</span><br></pre></td></tr></table></figure>
<h4 id="9-2-2-存储函数过程变量赋值"><a href="#9-2-2-存储函数过程变量赋值" class="headerlink" title="9.2.2 存储函数过程变量赋值"></a>9.2.2 存储函数过程变量赋值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#方式<span class="number">1</span> 直接赋值</span><br><span class="line"><span class="keyword">SET</span> var_name <span class="operator">=</span> expr [, var_name <span class="operator">=</span> expr] ...</span><br><span class="line"></span><br><span class="line">#方式<span class="number">2</span> 从其他表查询结果赋给当前表</span><br><span class="line"><span class="keyword">SELECT</span> col_name[,...] <span class="keyword">INTO</span> var_name[,...] table_expr</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#分别表示直接赋值和查询结果赋值</span><br><span class="line"></span><br><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user2()</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> a,b <span class="type">VARCHAR</span>(<span class="number">20</span>) ;</span><br><span class="line">        <span class="keyword">SET</span> a<span class="operator">=</span><span class="string">&#x27;java1234&#x27;</span>,b<span class="operator">=</span><span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,a,b);</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> pro_user2(); #调用存储过程</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#t_user2有id,uName,password  从t_user2查询数据存入变量再插入到t_user</span><br><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user3()</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> a,b <span class="type">VARCHAR</span>(<span class="number">20</span>) ;</span><br><span class="line">        <span class="keyword">SELECT</span> userName2,password2 <span class="keyword">INTO</span> a,b <span class="keyword">FROM</span> t_user2 <span class="keyword">WHERE</span> id2<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,a,b);</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> pro_user3(); #调用存储过程</span><br></pre></td></tr></table></figure>
<h3 id="9-3-游标"><a href="#9-3-游标" class="headerlink" title="9.3 游标"></a>9.3 游标</h3><p>查询语句可能查询出多条记录，在存储过程和函数中使用游标来逐条读取查询结果集中的记录。游标必须声明在处理程序之前，并且声明在变量和条件之后。</p>
<p>游标的使用包括</p>
<ul>
<li>声明游标 <code>DECLARE cursor_name CURSOR FOR select_statement ;</code></li>
<li>打开游标 <code>OPEN cursor_name;</code></li>
<li>使用游标 <code>FETCH cursor_name INTO var_name [,var_name ... ];</code></li>
<li>关闭游标 <code>CLOSE cursor_name;</code></li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user4()</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> a,b <span class="type">VARCHAR</span>(<span class="number">20</span>) ;</span><br><span class="line">        <span class="keyword">DECLARE</span> cur_t_user2 <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> userName2,password2 <span class="keyword">FROM</span> t_user2;</span><br><span class="line">        <span class="keyword">OPEN</span> cur_t_user2;</span><br><span class="line">        <span class="keyword">FETCH</span> cur_t_user2 <span class="keyword">INTO</span> a,b; #未使用循环，所以只取出、插入了集合的一条数据</span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,a,b);</span><br><span class="line">        <span class="keyword">CLOSE</span> cur_t_user2;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> pro_user4(); #调用存储过程</span><br></pre></td></tr></table></figure>
<h3 id="9-4-流程控制"><a href="#9-4-流程控制" class="headerlink" title="9.4 流程控制"></a>9.4 流程控制</h3><p>存储过程和函数中可以使用流程控制来控制语句的执行。MySQL 中可以使用 IF 语句、CASE 语句、LOOP语句、LEAVE 语句、ITERATE 语句、REPEAT 语句和 WHILE 语句来进行流程控制。</p>
<h4 id="9-4-1-IF语句"><a href="#9-4-1-IF语句" class="headerlink" title="9.4. 1 IF语句"></a>9.4. 1 IF语句</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">IF search_condition <span class="keyword">THEN</span> statement_list</span><br><span class="line">[ELSEIF search_condition <span class="keyword">THEN</span> statement_list ]...</span><br><span class="line">[<span class="keyword">ELSE</span> statement_list ]</span><br><span class="line"><span class="keyword">END</span> IF</span><br></pre></td></tr></table></figure>
<p>举例：根据传入的id查询，结果数量大于0时更新这个id对应的name，否则新插入一条数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user5(<span class="keyword">IN</span> bookId <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> <span class="variable">@num</span> <span class="keyword">FROM</span> t_user <span class="keyword">WHERE</span> id<span class="operator">=</span>bookId; #<span class="variable">@num</span> 表示全局变量</span><br><span class="line">        IF <span class="variable">@num</span><span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> t_user <span class="keyword">SET</span> userName<span class="operator">=</span><span class="string">&#x27;java12345&#x27;</span> <span class="keyword">WHERE</span> id<span class="operator">=</span>bookId;</span><br><span class="line">        <span class="keyword">ELSE</span></span><br><span class="line">            <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;2312312&#x27;</span>,<span class="string">&#x27;2321312&#x27;</span>);</span><br><span class="line">        <span class="keyword">END</span> IF ;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> pro_user5(<span class="number">4</span>); #调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> pro_user5(<span class="number">5</span>); #调用存储过程</span><br></pre></td></tr></table></figure>
<h4 id="9-4-2-CASE-语句"><a href="#9-4-2-CASE-语句" class="headerlink" title="9.4. 2 CASE 语句"></a>9.4. 2 CASE 语句</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CASE</span> case_value</span><br><span class="line"><span class="keyword">WHEN</span> when_value <span class="keyword">THEN</span> statement_list</span><br><span class="line">[<span class="keyword">WHEN</span> when_value <span class="keyword">THEN</span> statement_list]...</span><br><span class="line">[<span class="keyword">ELSE</span> statement_list ]</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">CASE</span></span><br></pre></td></tr></table></figure>
<p>举例：传入id，查询的结果数量为1时更新，2时插入，其他情况插入另一条</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user6(<span class="keyword">IN</span> bookId <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> <span class="variable">@num</span> <span class="keyword">FROM</span> t_user <span class="keyword">WHERE</span> id<span class="operator">=</span>bookId;</span><br><span class="line">        <span class="keyword">CASE</span> <span class="variable">@num</span></span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">1</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> t_user <span class="keyword">SET</span> userName<span class="operator">=</span><span class="string">&#x27;java12345&#x27;</span> <span class="keyword">WHERE</span> id<span class="operator">=</span>bookId;</span><br><span class="line">        <span class="keyword">WHEN</span> <span class="number">2</span> <span class="keyword">THEN</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;2312312&#x27;</span>,<span class="string">&#x27;2321312&#x27;</span>);</span><br><span class="line">        <span class="keyword">ELSE</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;231231221321312&#x27;</span>,<span class="string">&#x27;2321312321312&#x27;</span>);</span><br><span class="line">        <span class="keyword">END</span> <span class="keyword">CASE</span> ;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">CALL</span> pro_user6(<span class="number">5</span>); #调用存储过程</span><br><span class="line"><span class="keyword">CALL</span> pro_user6(<span class="number">6</span>); #调用存储过程</span><br></pre></td></tr></table></figure>
<h4 id="9-4-3-LOOP，LEAVE-语句"><a href="#9-4-3-LOOP，LEAVE-语句" class="headerlink" title="9.4. 3 LOOP，LEAVE 语句"></a>9.4. 3 LOOP，LEAVE 语句</h4><p>LOOP 语句可以使某些特定的语句重复执行，实现一个简单的循环。但是 LOOP 语句本身没有停止循环的语句，必须是遇到 LEAVE 语句等才能停止循环。LOOP 语句的语法的基本形式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[begin_label：]LOOP</span><br><span class="line">    Statement_list</span><br><span class="line"><span class="keyword">END</span> LOOP [ end_label ]</span><br></pre></td></tr></table></figure>
<p>LEAVE 语句主要用于跳出循环控制。语法形式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LEAVE label</span><br></pre></td></tr></table></figure>
<p>举例：循环插入指定参数条数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user7(<span class="keyword">IN</span> totalNum <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        aaa:LOOP</span><br><span class="line">            <span class="keyword">SET</span> totalNum<span class="operator">=</span>totalNum<span class="number">-1</span>;</span><br><span class="line">            IF totalNum<span class="operator">=</span><span class="number">0</span> <span class="keyword">THEN</span> LEAVE aaa ;</span><br><span class="line">            <span class="keyword">ELSE</span> <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(totalNum,<span class="string">&#x27;2312312&#x27;</span>,<span class="string">&#x27;2321312&#x27;</span>);</span><br><span class="line">            <span class="keyword">END</span> IF ;</span><br><span class="line">        <span class="keyword">END</span> LOOP aaa ;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_user;</span><br><span class="line"><span class="keyword">CALL</span> pro_user7(<span class="number">11</span>); #调用存储过程</span><br></pre></td></tr></table></figure>
<h4 id="9-4-4-ITERATE-语句"><a href="#9-4-4-ITERATE-语句" class="headerlink" title="9.4. 4 ITERATE 语句"></a>9.4. 4 ITERATE 语句</h4><p>ITERATE 语句也是用来跳出循环的语句。但是，ITERATE 语句是跳出本次循环，然后直接进入下一次循环。基本语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ITERATE label ;</span><br></pre></td></tr></table></figure>
<p>示例：指定插入次数参数为3的时候不插入，其余在0之前的都插入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user8(<span class="keyword">IN</span> totalNum <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        aaa:LOOP</span><br><span class="line">            <span class="keyword">SET</span> totalNum<span class="operator">=</span>totalNum<span class="number">-1</span>;</span><br><span class="line">            IF totalNum<span class="operator">=</span><span class="number">0</span> <span class="keyword">THEN</span> LEAVE aaa ;</span><br><span class="line">            ELSEIF totalNum<span class="operator">=</span><span class="number">3</span> <span class="keyword">THEN</span> ITERATE aaa ; #当是<span class="number">3</span>时，直接continue</span><br><span class="line">            <span class="keyword">END</span> IF ;</span><br><span class="line">            <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(totalNum,<span class="string">&#x27;2312312&#x27;</span>,<span class="string">&#x27;2321312&#x27;</span>);</span><br><span class="line">        <span class="keyword">END</span> LOOP aaa ;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_user;</span><br><span class="line"><span class="keyword">CALL</span> pro_user8(<span class="number">11</span>); #调用存储过程</span><br></pre></td></tr></table></figure>
<h4 id="9-4-5-REPEAT-语句"><a href="#9-4-5-REPEAT-语句" class="headerlink" title="9.4. 5 REPEAT 语句"></a>9.4. 5 REPEAT 语句</h4><p>REPEAT 语句是有条件控制的循环语句。当满足特定条件时，就会跳出循环语句。REPEAT 语句的基本语法形式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ begin_label : ] REPEAT</span><br><span class="line">    Statement_list</span><br><span class="line">    UNTIL search_condition</span><br><span class="line"><span class="keyword">END</span> REPEAT [ end_label ]</span><br></pre></td></tr></table></figure>
<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user9(<span class="keyword">IN</span> totalNum <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        REPEAT</span><br><span class="line">            <span class="keyword">SET</span> totalNum<span class="operator">=</span>totalNum<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(totalNum,<span class="string">&#x27;2312312&#x27;</span>,<span class="string">&#x27;2321312&#x27;</span>);</span><br><span class="line">            UNTIL totalNum<span class="operator">=</span><span class="number">1</span></span><br><span class="line">        <span class="keyword">END</span> REPEAT;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_user;</span><br><span class="line"><span class="keyword">CALL</span> pro_user9(<span class="number">11</span>); #调用存储过程</span><br></pre></td></tr></table></figure>
<h4 id="9-4-6-WHILE-语句"><a href="#9-4-6-WHILE-语句" class="headerlink" title="9.4. 6 WHILE 语句"></a>9.4. 6 WHILE 语句</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ begin_label : ] WHILE search_condition DO</span><br><span class="line">    Statement_list</span><br><span class="line"><span class="keyword">END</span> WHILE [ end_label ]</span><br></pre></td></tr></table></figure>
<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">&amp;&amp;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_user10(<span class="keyword">IN</span> totalNum <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        WHILE totalNum<span class="operator">&gt;</span><span class="number">0</span> DO</span><br><span class="line">            <span class="keyword">INSERT</span> <span class="keyword">INTO</span> t_user <span class="keyword">VALUES</span>(totalNum,<span class="string">&#x27;2312312&#x27;</span>,<span class="string">&#x27;2321312&#x27;</span>);</span><br><span class="line">            <span class="keyword">SET</span> totalNum<span class="operator">=</span>totalNum<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">END</span> WHILE ;</span><br><span class="line">    <span class="keyword">END</span></span><br><span class="line"><span class="operator">&amp;&amp;</span></span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_user;</span><br><span class="line"><span class="keyword">CALL</span> pro_user10(<span class="number">11</span>); #调用存储过程</span><br></pre></td></tr></table></figure>
<h2 id="10-数据备份与还原"><a href="#10-数据备份与还原" class="headerlink" title="10 数据备份与还原"></a>10 数据备份与还原</h2><p>备份数据可以保证数据库中数据的安全，需要定期的进行数据库备份，可以备份数据表和整个数据库。</p>
<h3 id="10-1-使用-mysqldump-备份（导出）"><a href="#10-1-使用-mysqldump-备份（导出）" class="headerlink" title="10.1 使用 mysqldump 备份（导出）"></a>10.1 使用 mysqldump 备份（导出）</h3><p>可以使用命令备份，也可以使用图形管理工具直接导出备份。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -username -p dbname table1 table2 ... &gt; BackupName.sql</span><br></pre></td></tr></table></figure>
<ul>
<li>dbname ：表示数据库的名称；</li>
<li>table1 和 table2 ：表示数据表的名称，没有指明时将备份整个数据库；</li>
<li>BackupName.sql ：表示备份文件的名称，文件名前面可以加绝对路径，一般以sql做后缀</li>
</ul>
<h3 id="10-2-还原（导入sql数据）"><a href="#10-2-还原（导入sql数据）" class="headerlink" title="10.2 还原（导入sql数据）"></a>10.2 还原（导入sql数据）</h3><p>使用命令或者图形界面导入还原数据。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p [dbname] &lt; backup.sql</span><br></pre></td></tr></table></figure>
<ul>
<li>dbname ：表示导入后的数据库名称，参数可指定或不指定</li>
<li>指定数据库名时，表示还原文件到这个表下</li>
<li>不指定数据库名时，表示还原备份sql文件中默认的数据库和表属性。</li>
</ul>

        
    </section>
</article>



<a id="pagenext" href="/2021/04/10/input%E5%AD%90%E7%B3%BB%E7%BB%9F/" class="article-next" title="input子系统"><i class="icon-arrow-right"></i></a>


<a id="pageprev" href="/2021/07/25/vnc/" class="article-prev" title="vnc"><i class="icon-arrow-left"></i></a>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "7fbe80427f54741e289f",
        clientSecret: "f34ed5fd92e54c9000bd37ba951948cb939deff5",
        repo: "sanonz.github.io",
        owner: "sanonz",
        admin: ["sanonz"],
        id: "9ec05f3ba33de4fcdff75c3914bb20bb",
        distractionFreeMode: true,
        title: "mysql笔记",
        body: "https://humble-zh.github.io/2021/07/08/mysql%E7%AC%94%E8%AE%B0/",
        labels: ["mysql"]
    }).render('comments');
    </script>
</div>



            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle('normal', slideDone);
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp('normal', slideDone);
            }, 3000);
        }

        function slideDone() {
            if (nodes.navInner.css('display') !== 'none') {
                nodes.navInner.css('display', '');
            }
        }

        $(window).on('resize', function() {
            if ($(this).width() > 960) {
                nodes.navInner.css('display', '');
            }
        });
    });
    </script>
    
        
<script src="/js/scrollspy.min.js"></script>

        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});

        $(window).on('resize', function() {
            var hw = $('#header').width();
            var ww = $('#wrapper').width();
            var space = ($(this).width() - hw - ww) / 2 / 2;

            var pageprev = $('#pageprev');
            var pagenext = $('#pagenext');
            var avg = (pageprev.width() + pagenext.width()) / 2

            if(space > avg) {
                var len = space - avg / 2;
                var styles = {position: 'fixed', top: '50%', marginTop: - (pageprev.width() + pagenext.width()) / 4}
                pageprev.css($.extend({left: hw + len}, styles));
                pagenext.css($.extend({right: len}, styles));
            } else {
                pageprev.removeAttr('style');
                pagenext.removeAttr('style');
            }
        }).trigger('resize');
        </script>
    

</body>
</html>
