<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>Zhihong&#39;s Blog</title>
    <meta name="author" content="Zhihong Li" />
    <meta name="keywords" content="zhbox" />
    <meta name="description" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="Zhihong&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <style type="text/css">
    @font-face {
        font-family: 'icomoon';
        src: url("/fonts/icomoon.eot?q628ml");
        src: url("/fonts/icomoon.eot?q628ml#iefix") format('embedded-opentype'),
             url("/fonts/icomoon.ttf?q628ml") format('truetype'),
             url("/fonts/icomoon.woff?q628ml") format('woff'),
             url("/fonts/icomoon.svg?q628ml#icomoon") format('svg');
        font-weight: normal;
        font-style: normal;
    }
    </style>
    
<link rel="stylesheet" href="/css/style.css">


    <!--[if lt IE 9]><style type="text/css">.nav-inner {top:0;}.author-meta {position:static;top:0;}.search-form {height:36px;}</style><script type="text/javascript" src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
<meta name="generator" content="Hexo 5.3.0"></head>
<body>

    <main class="app">
        <header id="header" class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Zhihong&#39;s Blog</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item active" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/zhbox">
                <span class="nav-text">中盒</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/about">
                <span class="nav-text">关于</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://humble-zh.github.io"></form>

        
        

        
        <div class="author-meta">
            
            <div class="author-avatar">
                <a href="/">
                    <img src="/images/avatar.jpg" title="Zhihong Li">
                </a>
            </div>
            
            <div class="author-name">Zhihong Li</div>
            <div class="author-work">Program Monkey</div>
            <div class="author-location">
                <i class="icon-location vm"></i>
                <span class="vm">GuangZhou, China</span>
            </div>
            
            <div class="author-thread-wrap">
                <div class="author-threads clearfix">
                    
                        <a class="thread-item" href="https://github.com/humble-zh/zhbox" target="_blank" rel="noopener">
                            <!-- Generated by IcoMoon.io -->
<svg viewBox="0 0 1024 1024" width="38" height="38" fill="currentColor">
<path d="M512 32.12c-265.004 0-479.88 220.23-479.88 492.090 0 217.446 137.536 401.684 328.202 466.81 23.994 4.498 32.778-10.712 32.778-23.78 0-11.782-0.428-42.632-0.642-83.764-133.466 29.778-161.744-65.984-161.744-65.984-21.852-56.772-53.344-71.982-53.344-71.982-43.49-30.636 3.214-29.992 3.214-29.992 48.202 3.428 73.482 50.772 73.482 50.772 42.846 75.196 112.258 53.558 139.68 40.918 4.284-31.706 16.71-53.558 30.42-65.77-106.474-12.426-218.516-54.63-218.516-243.152 0-53.772 18.638-97.69 49.274-131.966-4.928-12.426-21.424-62.556 4.714-130.252 0 0 40.276-13.282 131.966 50.344 38.348-10.926 79.266-16.282 120.184-16.496 40.704 0.214 81.836 5.57 120.184 16.496 91.692-63.626 131.752-50.344 131.752-50.344 26.136 67.698 9.64 117.828 4.714 130.252 30.636 34.492 49.274 78.408 49.274 131.966 0 188.952-112.258 230.514-219.16 242.724 17.138 15.21 32.564 45.202 32.564 91.048 0 65.77-0.642 118.898-0.642 134.966 0 13.068 8.57 28.492 32.992 23.566 191.094-64.912 328.418-249.152 328.418-466.382 0-271.86-214.874-492.090-479.88-492.090z"></path>
</svg>

                        </a>
                    
                </div>
            </div>
            
        </div>
        
    </div>
</aside>

</header>

        <div id="content" class="content">
            <div id="wrapper" class="wrapper" style="max-width: 800px">
                
    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2020/06/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2020-06-03T06:05:29.000Z" itemprop="datePublished">2020-06-03</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h1><h2 id="半小时看懂-lt-计算机网络-gt"><a href="#半小时看懂-lt-计算机网络-gt" class="headerlink" title="半小时看懂&lt;计算机网络&gt;"></a>半小时看懂&lt;计算机网络&gt;</h2><iframe src="//player.bilibili.com/player.html?aid=66929320&bvid=BV124411k7uV&cid=116062245&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">【网络】半小时看懂 计算机网络</iframe>

<h2 id="TCP和UDP区别"><a href="#TCP和UDP区别" class="headerlink" title="TCP和UDP区别"></a>TCP和UDP区别</h2><table>
<thead>
<tr>
<th align="center">特性</th>
<th align="center">TCP</th>
<th align="center">UDP</th>
</tr>
</thead>
<tbody><tr>
<td align="center">包头</td>
<td align="center">20+字节</td>
<td align="center">8+字节</td>
</tr>
<tr>
<td align="center">连接</td>
<td align="center">是</td>
<td align="center">否</td>
</tr>
<tr>
<td align="center">可靠</td>
<td align="center">是</td>
<td align="center">否</td>
</tr>
<tr>
<td align="center">超时重传</td>
<td align="center">是</td>
<td align="center">否</td>
</tr>
<tr>
<td align="center">流量控制</td>
<td align="center">是</td>
<td align="center">否</td>
</tr>
<tr>
<td align="center">滑动窗口</td>
<td align="center">是</td>
<td align="center">否</td>
</tr>
<tr>
<td align="center">报文顺序</td>
<td align="center">是</td>
<td align="center">否</td>
</tr>
<tr>
<td align="center">传输格式</td>
<td align="center">字节流(会粘包)</td>
<td align="center">整个报文</td>
</tr>
<tr>
<td align="center">传输效率</td>
<td align="center">低</td>
<td align="center">高</td>
</tr>
<tr>
<td align="center">适用</td>
<td align="center">文件下载,浏览网站</td>
<td align="center">实时通话</td>
</tr>
</tbody></table>
<h2 id="wireshark与charles"><a href="#wireshark与charles" class="headerlink" title="wireshark与charles"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1GE411Y7ZM">wireshark与charles</a></h2><iframe src="//player.bilibili.com/player.html?aid=73629523&bvid=BV1GE411Y7ZM&cid=125939592&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">【抓包工具】wireshark与charles简介</iframe>

<h2 id="TCP三次握手的连接过程-为什么是三次"><a href="#TCP三次握手的连接过程-为什么是三次" class="headerlink" title="TCP三次握手的连接过程,为什么是三次"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1vA411i7rs">TCP三次握手的连接过程,为什么是三次</a></h2><iframe src="//player.bilibili.com/player.html?aid=328685379&bvid=BV1vA411i7rs&cid=208331181&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">花三分钟了解一下死锁 | 这波不亏，不亏</iframe>

<h2 id="TCP的四次挥手"><a href="#TCP的四次挥手" class="headerlink" title="TCP的四次挥手"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1C5411Y7dG">TCP的四次挥手</a></h2><iframe src="//player.bilibili.com/player.html?aid=456279499&bvid=BV1C5411Y7dG&cid=211590381&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">三分钟了解TCP的四次挥手 | 平均0.75秒了解一次挥手</iframe>

<h2 id="curl"><a href="#curl" class="headerlink" title="curl"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV15x411f7Sm">curl</a></h2><iframe src="//player.bilibili.com/player.html?aid=58603941&bvid=BV15x411f7Sm&cid=102201417&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">【curl教程】5分钟，快速了解curl用法</iframe>

<h2 id="route指令"><a href="#route指令" class="headerlink" title="route指令"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV114411y7bS">route指令</a></h2><iframe src="//player.bilibili.com/player.html?aid=66762443&bvid=BV114411y7bS&cid=115780064&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">【网络】你不知道的linux的route指令</iframe>

<h2 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1rE411r7Ao">iptables</a></h2><iframe src="//player.bilibili.com/player.html?aid=71574590&bvid=BV1rE411r7Ao&cid=124026806&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">【小知识】第9期 20分钟掌握iptables指令</iframe>

<h2 id="ssh"><a href="#ssh" class="headerlink" title="ssh"></a><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1y4411q7PW">ssh</a></h2><iframe src="//player.bilibili.com/player.html?aid=65952912&bvid=BV1y4411q7PW&cid=114414833&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true">【小知识】第6期 SSH免密登录的原理</iframe>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2020/06/03/shell%E7%AC%94%E8%AE%B0/">shell笔记</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2020-06-03T05:54:19.000Z" itemprop="datePublished">2020-06-03</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/shell/" rel="tag">shell</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="shell小技巧"><a href="#shell小技巧" class="headerlink" title="shell小技巧"></a>shell小技巧</h1><h2 id="找到含有’aaa’的行，并把该行内’bbb’改为’ccc’、’ddd’改为’eee’"><a href="#找到含有’aaa’的行，并把该行内’bbb’改为’ccc’、’ddd’改为’eee’" class="headerlink" title="找到含有’aaa’的行，并把该行内’bbb’改为’ccc’、’ddd’改为’eee’"></a>找到含有’aaa’的行，并把该行内’bbb’改为’ccc’、’ddd’改为’eee’</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i <span class="string">&#x27;/aaa/ &#123; s/bbb/ccc/g;  s/ddd/eee/g; &#125;&#x27;</span>  filename</span><br></pre></td></tr></table></figure>
<h2 id="grep查找过滤目录或文件"><a href="#grep查找过滤目录或文件" class="headerlink" title="grep查找过滤目录或文件"></a>grep查找过滤目录或文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="string">&quot;string&quot;</span> . -R --exclude-dir=./dir <span class="comment">#目录</span></span><br><span class="line">grep <span class="string">&quot;http&quot;</span> . -R --exclude-dir=&#123;.git,res,bin&#125; <span class="comment">#目录</span></span><br><span class="line">grep <span class="string">&quot;http&quot;</span> . -R --exclude=*.&#123;java,js&#125; <span class="comment">#文件</span></span><br></pre></td></tr></table></figure>
<h2 id="查看代码行数-去空行"><a href="#查看代码行数-去空行" class="headerlink" title="查看代码行数(去空行)"></a>查看代码行数(去空行)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -name <span class="string">&quot;*.[ch]&quot;</span> |xargs cat|grep -v ^$|wc -l</span><br></pre></td></tr></table></figure>
<h2 id="脚本显示所执行的每一条命令"><a href="#脚本显示所执行的每一条命令" class="headerlink" title="脚本显示所执行的每一条命令"></a>脚本显示所执行的每一条命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -x</span><br><span class="line">ls</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -xv</span><br><span class="line">ls</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```bash</span><br><span class="line">sh -x yourscript.sh</span><br></pre></td></tr></table></figure>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2020/06/02/openshot/">openshot新建视频尺寸</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2020-06-02T07:32:41.000Z" itemprop="datePublished">2020-06-02</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/openshot/" rel="tag">openshot</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="openshot新建视频尺寸"><a href="#openshot新建视频尺寸" class="headerlink" title="openshot新建视频尺寸"></a>openshot新建视频尺寸</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># li @ evpower in ~ [14:48:20]</span></span><br><span class="line">$ find /usr/ -name hdv_720_24p</span><br><span class="line">/usr/lib/python3/dist-packages/openshot_qt/profiles/hdv_720_24p</span><br><span class="line"></span><br><span class="line"><span class="comment"># li @ evpower in ~ [14:48:24]</span></span><br><span class="line">$ <span class="built_in">cd</span> /usr/lib/python3/dist-packages/openshot_qt/profiles</span><br><span class="line"></span><br><span class="line"><span class="comment"># li @ evpower in /usr/lib/python3/dist-packages/openshot_qt/profiles [14:48:54]</span></span><br><span class="line">$ sudo cp hdv_720_24p hdv_480_24p</span><br><span class="line"></span><br><span class="line"><span class="comment"># li @ evpower in /usr/lib/python3/dist-packages/openshot_qt/profiles [14:48:57]</span></span><br><span class="line">$ sudo vi hdv_480_24p</span><br><span class="line"></span><br><span class="line"><span class="comment"># li @ evpower in /usr/lib/python3/dist-packages/openshot_qt/profiles [14:49:05]</span></span><br><span class="line">$ cat hdv_480_24p</span><br><span class="line">description=HDV 480 24p</span><br><span class="line">frame_rate_num=24</span><br><span class="line">frame_rate_den=1</span><br><span class="line">width=540</span><br><span class="line">height=960</span><br><span class="line">progressive=1</span><br><span class="line">sample_aspect_num=1</span><br><span class="line">sample_aspect_den=1</span><br><span class="line">display_aspect_num=9</span><br><span class="line">display_aspect_den=16</span><br></pre></td></tr></table></figure>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2020/04/27/TODO_after_manjaro_installed/">TODO_after_manjaro_installed</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2020-04-27T07:32:41.000Z" itemprop="datePublished">2020-04-27</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/linux/" rel="tag">linux</a>, <a class="article-tag-link" href="/tags/manjaro/" rel="tag">manjaro</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="manjaro安装后需要做的事情"><a href="#manjaro安装后需要做的事情" class="headerlink" title="manjaro安装后需要做的事情"></a>manjaro安装后需要做的事情</h2><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>安装系统时选:上海，系统、编码 两个都选 zh-CN.UTF-8 免得后面系统全是英文</p>
<h2 id="快捷"><a href="#快捷" class="headerlink" title="快捷"></a>快捷</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p ~/li &amp;&amp; git <span class="built_in">clone</span> https://gitee.com/humble-zh/zhbox-blog.git ~/li/.zbb;</span><br><span class="line">bash -x ~/li/.zbb/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/manjaro_config.sh</span><br><span class="line">bash -x ~/li/.zbb/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/manjaro_config.sh vim</span><br><span class="line">bash -x ~/li/.zbb/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/manjaro_config.sh ohmyzsh</span><br></pre></td></tr></table></figure>
<h2 id="改为国内源"><a href="#改为国内源" class="headerlink" title="改为国内源"></a>改为国内源</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman-mirrors -i -c China -m rank</span><br></pre></td></tr></table></figure>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syyu</span><br></pre></td></tr></table></figure>
<h2 id="添加源"><a href="#添加源" class="headerlink" title="添加源"></a>添加源</h2><p>在 /etc/pacman.conf 追加</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">SigLevel = Optional TrustedOnly</span><br><span class="line">Server = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syyu</span><br><span class="line">sudo pacman -S archlinuxcn-keyring</span><br></pre></td></tr></table></figure>
<h2 id="更换中文字体-simsun-ttc或MSYH-TTF"><a href="#更换中文字体-simsun-ttc或MSYH-TTF" class="headerlink" title="更换中文字体(simsun.ttc或MSYH.TTF)"></a>更换中文字体(simsun.ttc或MSYH.TTF)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S wqy-microhei</span><br><span class="line"><span class="built_in">cd</span> $(当前仓库)</span><br><span class="line">sudo cp -r ./<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/fonts/zhfonts /usr/share/fonts</span><br><span class="line"><span class="built_in">cd</span> /usr/share/fonts/zhfonts</span><br><span class="line">sudo mkfontscale</span><br><span class="line">sudo mkfontdir</span><br><span class="line">sudo fc-cache -fv</span><br></pre></td></tr></table></figure>
<h2 id="修改i3配置"><a href="#修改i3配置" class="headerlink" title="修改i3配置"></a>修改i3配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> $(当前仓库)</span><br><span class="line">mv ~/.i3/config ~/.i3/config.bak</span><br><span class="line">ln -s $(<span class="built_in">pwd</span>)/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/i3/config ~/.i3/config</span><br></pre></td></tr></table></figure>
<h2 id="Linux交换Esc和Caps"><a href="#Linux交换Esc和Caps" class="headerlink" title="Linux交换Esc和Caps"></a><a target="_blank" rel="noopener" href="https://superuser.com/questions/566871/how-to-map-the-caps-lock-key-to-escape-key-in-arch-linux/568573">Linux交换Esc和Caps</a></h2><p>在文件 ~/.i3/config 加入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec_always --no-startup-id setxkbmap -option caps:swapescape &amp;</span><br></pre></td></tr></table></figure>
<h2 id="修改默认浏览器为firefox-也可选chromium"><a href="#修改默认浏览器为firefox-也可选chromium" class="headerlink" title="修改默认浏览器为firefox(也可选chromium)"></a>修改默认浏览器为firefox(也可选chromium)</h2><ol>
<li><p>安装firefox</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S firefox-i18n-zh-cn</span><br></pre></td></tr></table></figure></li>
<li><p>修改~/.i3/config对应行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bindsym <span class="variable">$mod</span>+F2 <span class="built_in">exec</span> firefox</span><br></pre></td></tr></table></figure></li>
<li><p>修改系统默认打开方式文件：~/.config/mimeapps.list</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.config/mimeapps.list</span><br><span class="line">:%s/userapp-Pale Moon/firefox/g</span><br></pre></td></tr></table></figure></li>
<li><p>修改~/.profile</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> BROWSER=/usr/bin/firefox</span><br></pre></td></tr></table></figure></li>
<li><p>卸载palemoon</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Rns <span class="built_in">local</span>/palemoon-bin</span><br></pre></td></tr></table></figure></li>
<li><p>重新加载配置或重启</p>
</li>
<li><p>安装插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Tampermonkey(有些脚本在Greasemonkey无法运行)</span><br><span class="line">    AC-baidu:重定向优化百度搜狗谷歌必应搜索_favicon_双列</span><br><span class="line">    【玩的嗨】VIP工具箱,全网VIP视频免费破解去广告,一站式音乐搜索下载,获取B站封面,下载B站视频,上学吧答案获取等众多功能聚合</span><br><span class="line">    百度网盘直链满速下载助手</span><br><span class="line">    网盘自动填写访问码【威力加强版】</span><br><span class="line">    豆瓣资源下载大师：1秒搞定豆瓣电影|音乐|图书下载</span><br><span class="line">    持续更新 CSDN广告完全过滤、人性化脚本优化：不用再登录了！让你体验令人惊喜的崭新CSDN</span><br><span class="line">购物党实时比价工具(浏览器57以上版本安装)</span><br><span class="line">Adblock Plus - 免费的广告拦截器</span><br><span class="line">Vedio Speed Controller</span><br><span class="line">Vimium C 全键盘操作浏览器</span><br><span class="line">划词翻译  有道</span><br><span class="line">京价保 - 京东价保助手</span><br><span class="line">Video Downloader Pro  免费视频下载器</span><br><span class="line">网页截图</span><br><span class="line">Gesturefy  鼠标手势操作</span><br><span class="line">markdown-clipper 网页保存为markdown</span><br></pre></td></tr></table></figure>
<h2 id="关闭桌面左下脚提示"><a href="#关闭桌面左下脚提示" class="headerlink" title="关闭桌面左下脚提示"></a>关闭桌面左下脚提示</h2></li>
</ol>
<p>注释掉<code>/usr/bin/start_conky_maia</code>里的<code># conky -c /usr/share/conky/conky1.10_shortcuts_maia &amp;&amp;</code></p>
<h2 id="安装中文输入法-sunpinyin或libpinyin"><a href="#安装中文输入法-sunpinyin或libpinyin" class="headerlink" title="安装中文输入法(sunpinyin或libpinyin)"></a>安装中文输入法(sunpinyin或libpinyin)</h2><ol>
<li>安装输入法以及依赖<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S fcitx fcitx-im fcitx-configtool fcitx-ui-light ttf-dejavu adobe-source-han-sans-otc-fonts fcitx-libpinyin fcitx-sunpinyin fcitx-cloudpinyin</span><br></pre></td></tr></table></figure></li>
<li>给文件 ~/.xprofile 追加<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GTK_IM_MODULE=fcitx</span><br><span class="line"><span class="built_in">export</span> QT_IM_MODULE=fcitx</span><br><span class="line"><span class="built_in">export</span> XMODIFIERS=<span class="string">&quot;@im=fcitx&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>给文件 ~/.profile 追加<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fcitx</span><br></pre></td></tr></table></figure>
<h2 id="安装配置vim-neovim"><a href="#安装配置vim-neovim" class="headerlink" title="安装配置vim/neovim"></a>安装配置<a target="_blank" rel="noopener" href="https://github.com/humble-zh/myvim.git">vim/neovim</a></h2></li>
</ol>
<p>在 ~/.profile 修改默认编辑器为vim</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> EDITOR=/usr/bin/vim</span><br></pre></td></tr></table></figure>

<h2 id="如何解决-Windows-和-Manjaro-双系统时间不一致-差8小时的问题"><a href="#如何解决-Windows-和-Manjaro-双系统时间不一致-差8小时的问题" class="headerlink" title="如何解决 Windows 和 Manjaro 双系统时间不一致_差8小时的问题"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36349646/article/details/102597290">如何解决 Windows 和 Manjaro 双系统时间不一致_差8小时的问题</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S ntp</span><br><span class="line"><span class="comment">#sudo timedatectl set-ntp true</span></span><br><span class="line">sudo timedatectl set-local-rtc <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<h2 id="解决桌面右上角的日期显示方块乱码"><a href="#解决桌面右上角的日期显示方块乱码" class="headerlink" title="解决桌面右上角的日期显示方块乱码"></a>解决桌面右上角的日期显示方块乱码</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /usr/share/conky/conky_maia /usr/share/conky/conky_maia.bak</span><br><span class="line">sudo vim /usr/share/conky/conky_maia</span><br><span class="line">:%s/Bitstream Vera/anti/g</span><br></pre></td></tr></table></figure>
<h2 id="删除状态栏的”no-battery”"><a href="#删除状态栏的”no-battery”" class="headerlink" title="删除状态栏的”no battery”"></a>删除状态栏的”no battery”</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> $(当前仓库)</span><br><span class="line">ln -s $(<span class="built_in">pwd</span>)/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/i3status.conf ~/.i3status.conf</span><br></pre></td></tr></table></figure>
<p>拷贝 /etc/i3status.conf 到 ~/.i3status.conf ，注释 ~/.i3status.conf 以下行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order += <span class="string">&quot;battery all&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="i3status-conf-修改状态栏的时间日期格式"><a href="#i3status-conf-修改状态栏的时间日期格式" class="headerlink" title="~/.i3status.conf 修改状态栏的时间日期格式"></a>~/.i3status.conf 修改状态栏的时间日期格式</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tztime <span class="built_in">local</span> &#123;</span><br><span class="line">        format = <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span></span><br><span class="line">        <span class="comment"># format = &quot; %d.%m. %H:%M &quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="安装常用软件"><a href="#安装常用软件" class="headerlink" title="安装常用软件"></a>安装常用软件</h2><p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Taking_a_screenshot_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">scrot</a>: 截图软件</p>
<p><a target="_blank" rel="noopener" href="https://inkscape.org/">inkscape</a>: 编辑图片画框画箭头等等</p>
<p><a href="">variety</a>: 更换壁纸</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ggreer/the_silver_searcher">the_silver_searcher</a>: 快速的代码命令行搜索工具 ag</p>
<p><a target="_blank" rel="noopener" href="https://github.com/wting/autojump">autojump</a>: 快速跳转目录</p>
<p><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Fzf">fzf</a>: 终端命令行模糊查询历史</p>
<p><a target="_blank" rel="noopener" href="http://cloc.sourceforge.net/">cloc</a>: 统计代码行数，可区分文件类型以及空行和注释</p>
<p><a target="_blank" rel="noopener" href="https://zealdocs.org/">zeal</a>: 离线文档浏览器</p>
<p><a target="_blank" rel="noopener" href="https://github.com/albertlauncher/albert">albert</a>: 快捷搜索/执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S sshpass mosquitto scrot inkscape the_silver_searcher fzf base-devel cmake unrar unzip yay netcat cloc smplayer you-get albert</span><br><span class="line"></span><br><span class="line"><span class="comment">#echo &#x27;. /usr/share/autojump/autojump.bash&#x27; &gt;&gt; ~/.bashrc</span></span><br><span class="line"><span class="comment">#echo &#x27;. /usr/share/fzf/key-bindings.bash&#x27; &gt;&gt; ~/.bashrc</span></span><br><span class="line"><span class="comment">#echo &#x27;. /usr/share/fzf/completion.bash&#x27; &gt;&gt; ~/.bashrc</span></span><br><span class="line"><span class="comment">#source ~/.bashrc</span></span><br></pre></td></tr></table></figure>
<h2 id="删除不必要的软件"><a href="#删除不必要的软件" class="headerlink" title="删除不必要的软件"></a>删除不必要的软件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Rns $(pacman -Qdtq)</span><br></pre></td></tr></table></figure>
<h2 id="安装ohmyzsh"><a href="#安装ohmyzsh" class="headerlink" title="安装ohmyzsh"></a>安装<a target="_blank" rel="noopener" href="https://github.com/ohmyzsh/ohmyzsh/#manual-inspection">ohmyzsh</a></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh -c <span class="string">&quot;<span class="subst">$(wget -O- https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure>
<p>或</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -Lo install.sh https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh</span><br><span class="line">sh install.sh</span><br></pre></td></tr></table></figure>
<p>如果出现 <code>Failed to connect to raw.githubusercontent.com port 443: Connection refused</code> ,就在/etc/hosts文件追加</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">199.232.28.133 raw.githubusercontent.com</span><br></pre></td></tr></table></figure>
<p>修改ohmyzsh配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> $(当前仓库)</span><br><span class="line">mv ~/.zshrc ~/.zshrc.bak</span><br><span class="line">ln -s $(<span class="built_in">pwd</span>)/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/zshrc ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>安装ohmyzsh两个插件<a target="_blank" rel="noopener" href="https://github.com/zsh-users/zsh-syntax-highlighting/blob/master/INSTALL.md#oh-my-zsh">zsh-syntax-highlighting</a>，<a target="_blank" rel="noopener" href="https://github.com/zsh-users/zsh-autosuggestions/blob/master/INSTALL.md#oh-my-zsh">zsh-autosuggestions</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions</span><br></pre></td></tr></table></figure>
<p>查看<code>git</code>命令缩写</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.oh-my-zsh/plugins/git/git.plugin.zsh</span><br></pre></td></tr></table></figure>
<p><code>git status</code>中文乱码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.quotepath <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<h2 id="系统无声音"><a href="#系统无声音" class="headerlink" title="系统无声音"></a>系统无声音</h2><p>测试声音 <code>speaker-test</code></p>
<p>小新pro14，因为是新电脑，声卡很新。使用aplay -l 命令 ，显示没有声卡就安装<code>sudo pacman -S sof-firmware</code></p>
<h3 id="Manjaro-没有声音-伪输出-怎么办"><a href="#Manjaro-没有声音-伪输出-怎么办" class="headerlink" title="Manjaro 没有声音(伪输出)怎么办"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43497702/article/details/104370104">Manjaro 没有声音(伪输出)怎么办</a></h3><p>可能就是你关机的时候是强制关机的，导致管理声音的软件异常退出，下次开机的时候管理声音的软件没有打开造成的，下面有5个方法，每种电脑可能都不一样，我尝试了多种方法，今天就来记录一下。每种方法使用完必须要重启一下电脑才可以的<br>方法1</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">amixer -D pulse sset Master toggle</span><br></pre></td></tr></table></figure>
<p>方法2</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -R .config/pulse/</span><br><span class="line">sudo pacman -S pulseaudio</span><br></pre></td></tr></table></figure>
<p>方法3</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gpasswd -a <span class="variable">$USER</span> audio</span><br><span class="line">sudo killall pulseaudio</span><br></pre></td></tr></table></figure>
<p>方法4</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pulseaudio --check</span><br><span class="line">pulseaudio --kill</span><br><span class="line">pulseaudio --start</span><br></pre></td></tr></table></figure>
<p>方法5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl --user restart pulseaudio.service</span><br><span class="line">systemctl --user restart pulseaudio.socket</span><br></pre></td></tr></table></figure>
<p>参考文献</p>
<p><a target="_blank" rel="noopener" href="https://askubuntu.com/questions/15223/how-can-i-restart-pulseaudio-without-having-to-logout">https://askubuntu.com/questions/15223/how-can-i-restart-pulseaudio-without-having-to-logout</a><br><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/204522/how-does-pulseaudio-start">https://unix.stackexchange.com/questions/204522/how-does-pulseaudio-start</a><br><a target="_blank" rel="noopener" href="https://forum.manjaro.org/t/solved-manjaro-xfce-no-sound-dummy-output/26332">https://forum.manjaro.org/t/solved-manjaro-xfce-no-sound-dummy-output/26332</a></p>
<h3 id="Manjaro设置声音"><a href="#Manjaro设置声音" class="headerlink" title="Manjaro设置声音"></a><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7c3dcb98a304">Manjaro设置声音</a></h3><ol>
<li>试试系统中有没有alsamixer命令，直接终端执行alsamixer(没有的话请安装alsa-utils)</li>
<li>在终端执行 aplay -l 查看声卡信息</li>
<li>执行: amixer scontrols</li>
<li>然后: amixer -c 1 scontrols</li>
<li>给(新建)文件 ~/.asoundrc 追加下面内容 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">defaults.pcm.card 1</span><br><span class="line">defaults.pcm.device 0</span><br><span class="line">defaults.ctl.card 1</span><br></pre></td></tr></table></figure></li>
<li>$mod+Shift+r</li>
</ol>
<h2 id="win10更新后无法引导manjaro"><a href="#win10更新后无法引导manjaro" class="headerlink" title="win10更新后无法引导manjaro"></a>win10更新后无法引导manjaro</h2><h3 id="情况一"><a href="#情况一" class="headerlink" title="情况一"></a>情况一</h3><p>先入winPE，使用<code>扇区小工具BOOTICE</code>，<code>UEFI - 修改启动序列 - WindowsBootManager - 启动分区</code> 改为linux的swap(8G)重启就可以进grub引导进linux，执行<code>sudo update-grub</code></p>
<p>再进winPE，使用<code>扇区小工具BOOTICE</code>，<code>UEFI - 修改启动序列 - WindowsBootManager - 启动文件</code>，见到从<code>\EFI\Microsoft\Boot\bootmgfw.efi</code>改为了<code>\EFI\Manjaro\grubx64.efi</code>就行(或者见到<code>WindowsBootManager</code>的是<code>\EFI\Microsoft\Boot\bootmgfw.efi</code>，<code>Manjaro</code>的是<code>\EFI\Manjaro\grubx64.efi</code>)</p>
<h3 id="情况二"><a href="#情况二" class="headerlink" title="情况二"></a>情况二</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">error: unknown filesystem.</span><br><span class="line">Entering rescue mode...</span><br><span class="line">grub rescue&gt; _</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://forum.manjaro.org/t/manjaro-wont-boot-after-windows-update/31109">Manjaro won’t boot after Windows Update</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls #输出(hd0) (hd0,gpt6) (hd0,gpt5) (hd0,gpt4) (hd0,gpt3) (hd0,gpt2) (hd0,gpt1)</span><br><span class="line">ls (hd0,6)&#x2F;boot #输出了目录内容</span><br><span class="line">set root&#x3D;(hd0,6)</span><br><span class="line">set prefix&#x3D;(hd0,6)&#x2F;boot&#x2F;grub</span><br><span class="line">insmod normal</span><br><span class="line">normal #就可以进入系统然后按照下面的进行修复</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://wiki.manjaro.org/index.php/GRUB/Restore_the_GRUB_Bootloader#Reinstall_GRUB">GRUB/Restore the GRUB Bootloader</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Syu grub</span><br><span class="line">sudo update-grub</span><br><span class="line">sudo grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=manjaro --recheck</span><br><span class="line">sudo grub-mkconfig -o /boot/grub/grub.cfg</span><br></pre></td></tr></table></figure>
<h2 id="选装"><a href="#选装" class="headerlink" title="选装"></a>选装</h2><h3 id="修改字体DPI"><a href="#修改字体DPI" class="headerlink" title="修改字体DPI"></a>修改字体DPI</h3><p>i3wm 调节分辨率，鼠标大小等等</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cp ~/.Xresources ~/.Xresources.bak</span><br><span class="line"><span class="comment"># 修改 Xft.dpi: 96 为 Xft.dpi: 144</span></span><br><span class="line"><span class="comment"># sudo xrdb ~/.Xresources  # 使配置文件生效</span></span><br><span class="line"><span class="comment"># 修改 URxvt.font: 9x15,xft:TerminessTTFNerdFontMono</span></span><br><span class="line"><span class="comment"># 成为 URxvt.font: xft:TerminessTTFNerdFontMono:size=15</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>
<h3 id="修改触摸板上下滚动"><a href="#修改触摸板上下滚动" class="headerlink" title="修改触摸板上下滚动"></a>修改触摸板上下滚动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/X11/xorg.conf.d/30-touchpad.conf /etc/X11/xorg.conf.d/30-touchpad.conf.bak</span><br></pre></td></tr></table></figure>
<figure class="highlight patch"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--- /etc/X11/xorg.conf.d/30-touchpad.conf.bak	2021-01-24 22:23:49.541749394 +0800</span></span><br><span class="line"><span class="comment">+++ /etc/X11/xorg.conf.d/30-touchpad.conf	2021-01-24 22:21:09.836616261 +0800</span></span><br><span class="line"><span class="meta">@@ -3,4 +3,6 @@</span></span><br><span class="line">     Driver &quot;libinput&quot;</span><br><span class="line">     MatchIsTouchpad &quot;on&quot;</span><br><span class="line">     Option &quot;Tapping&quot; &quot;on&quot;</span><br><span class="line"><span class="addition">+    Option &quot;NaturalScrolling&quot; &quot;true&quot;</span></span><br><span class="line"><span class="addition">+    Option &quot;ClickMethod&quot; &quot;clickfinger&quot; #(去掉,因为右键会失效)</span></span><br><span class="line"> EndSection</span><br></pre></td></tr></table></figure>
<p>联想小新pro14触摸板和键盘失灵</p>
<p>不能进系统:进入grub界面，按e编辑，在linux行的<code>quiet splash</code>后面加入<code>i8042.dumbkdb nomodeset</code>，按F10进入系统</p>
<p>能进系统:给<code>/etc/default/grub</code>的<code>GRUB_CMDLINE_LINUX_DEFAULT</code>行的<code>quiet splash</code>后面加<code>i8042.dumbkdb nomodeset</code>，然后<code>sudo update-grub</code></p>
<p><code>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash i8042.direct i8042.dumbkbd&quot;</code></p>
<h3 id="若esc和cpas没有切换，则在-i3-config新增3行"><a href="#若esc和cpas没有切换，则在-i3-config新增3行" class="headerlink" title="若esc和cpas没有切换，则在.i3/config新增3行"></a>若esc和cpas没有切换，则在<code>.i3/config</code>新增3行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exec_always --no-startup-id xmodmap -e <span class="string">&quot;clear lock&quot;</span></span><br><span class="line">exec_always --no-startup-id xmodmap -e <span class="string">&quot;keycode 9 = Caps_Lock NoSymbol Caps_Lock&quot;</span></span><br><span class="line">exec_always --no-startup-id xmodmap -e <span class="string">&quot;keycode 66 = Escape NoSymbol Escape&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="开启ssh服务"><a href="#开启ssh服务" class="headerlink" title="开启ssh服务"></a>开启ssh服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> sshd.service <span class="comment">#开机启动</span></span><br><span class="line">sudo systemctl start sshd.service <span class="comment">#立即启动</span></span><br><span class="line">sudo systemctl restart sshd.service <span class="comment">#立即重启</span></span><br></pre></td></tr></table></figure>
<h3 id="避免进不了桌面"><a href="#避免进不了桌面" class="headerlink" title="避免进不了桌面"></a>避免进不了桌面</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S xf86-video-amdgpu</span><br></pre></td></tr></table></figure>
<h3 id="安装录屏工具"><a href="#安装录屏工具" class="headerlink" title="安装录屏工具"></a>安装录屏工具</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S obs-studio</span><br></pre></td></tr></table></figure>
<h3 id="安装VSCode"><a href="#安装VSCode" class="headerlink" title="安装VSCode"></a>安装VSCode</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S visual-studio-code-bin</span><br></pre></td></tr></table></figure>
<p>VSCode安装vim插件后，esc和caps没切换，在设置里搜<code>Keyboard:Dispatch</code>改为<code>keyCode</code>重启软件即可</p>
<h3 id="win的ntfs分区只读"><a href="#win的ntfs分区只读" class="headerlink" title="win的ntfs分区只读"></a><a target="_blank" rel="noopener" href="https://www.cuizhe.me/202005/945.cz">win的ntfs分区只读</a></h3><p>在win打开<code>Windows Powershell(管理员)</code>用下面命令关闭快速启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powercfg /h off</span><br></pre></td></tr></table></figure>

<h3 id="安装mqtt-fx"><a href="#安装mqtt-fx" class="headerlink" title="安装mqtt.fx"></a>安装mqtt.fx</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S mqttfx-bin</span><br></pre></td></tr></table></figure>
<h3 id="配置mail"><a href="#配置mail" class="headerlink" title="配置mail"></a>配置mail</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S mailx</span><br></pre></td></tr></table></figure>
<p>修改 /etc/mail.rc 权限并追加内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> from=humble.li@evpowergroup.com smtp=<span class="string">&quot;smtp.mxhichina.com&quot;</span></span><br><span class="line"><span class="built_in">set</span> smtp-auth-user=<span class="string">&quot;humble.li@evpowergroup.com&quot;</span> smtp-auth-password=<span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="built_in">set</span> smtp-auth=login</span><br></pre></td></tr></table></figure>
<h3 id="WPS-Office"><a href="#WPS-Office" class="headerlink" title="WPS-Office"></a>WPS-Office</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S wps-office ttf-wps-fonts</span><br></pre></td></tr></table></figure>
<h3 id="typora-free-0-11-18-1"><a href="#typora-free-0-11-18-1" class="headerlink" title="typora-free-0.11.18-1"></a>typora-free-0.11.18-1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S typora-free</span><br></pre></td></tr></table></figure>
<h3 id="openwrt编译依赖软件"><a href="#openwrt编译依赖软件" class="headerlink" title="openwrt编译依赖软件"></a>openwrt编译依赖软件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S --needed bash bc bin86 binutils bzip2 cdrkit core/<span class="built_in">which</span> \</span><br><span class="line">    diffutils fastjar findutils flex gawk gcc gettext git intltool \</span><br><span class="line">    libusb libxslt make ncurses openssl patch perl-extutils-makemaker \</span><br><span class="line">    pkgconf python3 rsync sharutils time unzip util-linux wget zlib</span><br></pre></td></tr></table></figure>
<h3 id="ss-libev-amp-v2ray-plugin"><a href="#ss-libev-amp-v2ray-plugin" class="headerlink" title="ss-libev&amp;v2ray-plugin"></a>ss-libev&amp;v2ray-plugin</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S shadowsocks-libev shadowsocks-v2ray-plugin proxychains</span><br><span class="line">v2ray-plugin --<span class="built_in">help</span></span><br><span class="line">nohup ss-local -c ~/v2ray.conf &amp;</span><br></pre></td></tr></table></figure>
<p>把<code>/etc/proxychains.conf</code>的<code>socks4*</code>改为<code>socks5 127.0.0.1 1080</code></p>
<p>浏览器：手动代理配置:127.0.0.1,端口:1080,使用SOCKSv5时代理DNS查询</p>
<h3 id="yay无法proxychains"><a href="#yay无法proxychains" class="headerlink" title="yay无法proxychains"></a>yay无法proxychains</h3><p>注释<code>/etc/proxychains.conf</code>的<code>proxy_dns</code></p>
<h3 id="安装todesk"><a href="#安装todesk" class="headerlink" title="安装todesk"></a>安装todesk</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">yay -S todesk</span><br><span class="line">sudo systemctl start todeskd.service</span><br><span class="line">sudo systemctl is-enabled todeskd.service</span><br><span class="line">sudo systemctl enabled todeskd.service</span><br><span class="line"><span class="comment"># 如果开机没有自启动就</span></span><br><span class="line"><span class="comment"># sudo chmod 744 ~/.config/autostart/todesk.desktop</span></span><br></pre></td></tr></table></figure>
<h3 id="安装向日葵"><a href="#安装向日葵" class="headerlink" title="安装向日葵"></a>安装向日葵</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yay -S sunloginclient</span><br></pre></td></tr></table></figure>
<p>每次开机都需要运行一次下面指令才能正常使用向日葵</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start runsunloginclient.service</span><br></pre></td></tr></table></figure>
<h3 id="解决Manjaro-i3社区版-compton默认配置不正确的问题"><a href="#解决Manjaro-i3社区版-compton默认配置不正确的问题" class="headerlink" title="解决Manjaro i3社区版 compton默认配置不正确的问题"></a><a target="_blank" rel="noopener" href="https://my.oschina.net/u/4396512/blog/3318096">解决Manjaro i3社区版 compton默认配置不正确的问题</a></h3><p>2020年1月10日 更新。默认配置可以使用透明，需要取消 compton.conf 中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#inactive-opacity = 0.93;</span></span><br><span class="line"><span class="comment">#active-opacity = 1;</span></span><br><span class="line"><span class="comment">#取消这两行的注释</span></span><br></pre></td></tr></table></figure>
<p>此问题默认存在于manjaro-i3-18.1.5-191229-linux54之前的版本中。 i3 社区版中compton包名已经改名为picom。 终端中运行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pkill comton <span class="comment">#关闭compton</span></span><br><span class="line">compton -b <span class="comment">#运行compton</span></span><br></pre></td></tr></table></figure>
<p>错误显示为：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ 01/09/2020 18:38:49.762 parse_config_libconfig WARN ] Option `no-dock-shadow` is deprecated, and will be removed. Please use the wintype option `shadow` of `dock` instead.</span><br><span class="line">[ 01/09/2020 18:38:49.762 parse_config_libconfig WARN ] Option `menu-opacity` is deprecated, and will be removed.Please use the wintype option `opacity` of `popup_menu` and `dropdown_menu` instead.</span><br><span class="line">[ 01/09/2020 18:38:49.762 parse_config_libconfig WARN ] vsync option will take a boolean from now on. <span class="string">&quot;none&quot;</span> is interpreted as <span class="string">&quot;false&quot;</span> <span class="keyword">for</span> compatibility, but this will stop working soon</span><br><span class="line">[ 01/09/2020 18:38:49.763 parse_config_libconfig WARN ] glx-swap-method has been deprecated since v6, your setting <span class="string">&quot;undefined&quot;</span> should be removed.</span><br><span class="line">[ 01/09/2020 18:38:49.763 parse_config_libconfig WARN ] <span class="string">&quot;clear-shadow&quot;</span> is removed as an option, and is always enabled now. Consider removing it from your config file</span><br><span class="line">[ 01/09/2020 18:38:49.763 parse_config_libconfig WARN ] <span class="string">&quot;paint-on-overlay&quot;</span> has been removed as an option, and is enabled whenever possible</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> $(当前仓库)</span><br><span class="line">sed -i <span class="string">&#x27;s/compton/picom/g&#x27;</span> ~/.i3/config <span class="comment">#将.i3/config中的compton 替换为picom</span></span><br><span class="line">mv ~/.config/compton.conf ~/.config/compton.conf.old <span class="comment">#删除原有.config/compton.conf</span></span><br><span class="line">vim ~/.config/picom.conf <span class="comment">#新建picom.conf文件，输入内容</span></span><br><span class="line">cp <span class="variable">$&#123;pwd&#125;</span>/<span class="built_in">source</span>/_posts/TODO_after_manjaro_installed/picom.conf ~/.config/picom.conf</span><br><span class="line">reboot <span class="comment">#重启系统</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ~/.config/picom.conf</span></span><br><span class="line"><span class="comment"># Shadow</span></span><br><span class="line">shadow = <span class="literal">true</span>;</span><br><span class="line"><span class="comment"># no-dnd-shadow = true;</span></span><br><span class="line"><span class="comment">#no-dock-shadow = true;</span></span><br><span class="line"><span class="comment">#clear-shadow = true;</span></span><br><span class="line">detect-rounded-corners = <span class="literal">true</span>;</span><br><span class="line">shadow-radius = 5;</span><br><span class="line">shadow-offset-x = 1;</span><br><span class="line">shadow-offset-y = 1;</span><br><span class="line">shadow-opacity = .3;</span><br><span class="line">shadow-ignore-shaped = <span class="literal">false</span>;</span><br><span class="line">shadow-exclude = [</span><br><span class="line">    <span class="string">&quot;name = &#x27;Notification&#x27;&quot;</span>,</span><br><span class="line"><span class="comment"># workaround for conky until it provides window properties:</span></span><br><span class="line">    <span class="string">&quot;override_redirect = 1 &amp;&amp; !WM_CLASS@:s&quot;</span>,</span><br><span class="line">    <span class="string">&quot;class_g ?= &#x27;Dmenu&#x27;&quot;</span>,</span><br><span class="line"><span class="comment">#    &quot;class_g ?= &#x27;Dunst&#x27;&quot;,</span></span><br><span class="line"><span class="comment"># disable shadows for hidden windows:</span></span><br><span class="line">    <span class="string">&quot;_NET_WM_STATE@:32a *= &#x27;_NET_WM_STATE_HIDDEN&#x27;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;_GTK_FRAME_EXTENTS@:c&quot;</span>,</span><br><span class="line"><span class="comment"># disables shadows on sticky windows:</span></span><br><span class="line"><span class="comment">#    &quot;_NET_WM_STATE@:32a *= &#x27;_NET_WM_STATE_STICKY&#x27;&quot;,</span></span><br><span class="line"><span class="comment"># disables shadows on i3 frames</span></span><br><span class="line">    <span class="string">&quot;class_g ?= &#x27;i3-frame&#x27;&quot;</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment"># shadow-exclude-reg = &quot;x10+0+0&quot;;</span></span><br><span class="line"><span class="comment"># xinerama-shadow-crop = true;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#menu-opacity = 0.95;</span></span><br><span class="line"><span class="comment">#inactive-opacity = 0.93;</span></span><br><span class="line"><span class="comment">#active-opacity = 1;</span></span><br><span class="line"><span class="comment">#alpha-step = 0.01;</span></span><br><span class="line"><span class="comment">#inactive-dim = 0.0;</span></span><br><span class="line"><span class="comment">#blur-background = false;</span></span><br><span class="line"><span class="comment">#blur-kern = &quot;3x3box&quot;;</span></span><br><span class="line"></span><br><span class="line">fading = <span class="literal">false</span>;</span><br><span class="line">fade-delta = 1;</span><br><span class="line">fade-in-step = 0.03;</span><br><span class="line">fade-out-step = 0.03;</span><br><span class="line">fade-exclude = [ ];</span><br><span class="line"></span><br><span class="line">backend = <span class="string">&quot;xrender&quot;</span>;</span><br><span class="line">mark-wmwin-focused = <span class="literal">true</span>;</span><br><span class="line">mark-ovredir-focused = <span class="literal">true</span>;</span><br><span class="line">detect-client-opacity = <span class="literal">true</span>;</span><br><span class="line">unredir-if-possible = <span class="literal">true</span>;</span><br><span class="line">refresh-rate = 0;</span><br><span class="line">vsync = <span class="literal">false</span>;</span><br><span class="line">dbe = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">#paint-on-overlay = true;</span></span><br><span class="line">focus-exclude = [ <span class="string">&quot;class_g = &#x27;Cairo-clock&#x27;&quot;</span> ];</span><br><span class="line">detect-transient = <span class="literal">true</span>;</span><br><span class="line">detect-client-leader = <span class="literal">true</span>;</span><br><span class="line">invert-color-include = [ ];</span><br><span class="line">glx-copy-from-front = <span class="literal">false</span>;</span><br><span class="line"><span class="comment">#glx-swap-method = &quot;undefined&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#opacity-rule = [</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Call&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Chromium&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Conky&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Darktable&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;50:class_g = &#x27;Dmenu&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Event&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Firefox&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;GIMP&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Image&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Lazpaint&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Midori&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Minitube&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Mousepad&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;MuseScore&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;90:name *?= &#x27;Page Info&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Pale Moon&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;90:name *?= &#x27;Panel&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Pinta&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;90:name *?= &#x27;Restart&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;sudo&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Screenshot&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;Viewnior&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:class_g = &#x27;VirtualBox&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;VLC&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;99:name *?= &#x27;Write&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;93:class_g = &#x27;URxvt&#x27; &amp;&amp; !_NET_WM_STATE@:32a&quot;,</span></span><br><span class="line"><span class="comment">#&quot;0:_NET_WM_STATE@:32a *= &#x27;_NET_WM_STATE_HIDDEN&#x27;&quot;,</span></span><br><span class="line"><span class="comment">#&quot;96:_NET_WM_STATE@:32a *= &#x27;_NET_WM_STATE_STICKY&#x27;&quot;</span></span><br><span class="line"><span class="comment">#];</span></span><br><span class="line"></span><br><span class="line">wintypes :</span><br><span class="line">&#123;</span><br><span class="line">  tooltip :</span><br><span class="line">  &#123;</span><br><span class="line">    fade = <span class="literal">true</span>;</span><br><span class="line">    shadow = <span class="literal">false</span>;</span><br><span class="line">    opacity = 0.85;</span><br><span class="line">    focus = <span class="literal">true</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  fullscreen :</span><br><span class="line">  &#123;</span><br><span class="line">    fade = <span class="literal">true</span>;</span><br><span class="line">    shadow = <span class="literal">false</span>;</span><br><span class="line">    opacity = 1;</span><br><span class="line">    focus = <span class="literal">true</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">````</span><br><span class="line"></span><br><span class="line"><span class="comment">### [安装vnc](http://blog.lujun9972.win/blog/2018/09/20/%E5%9C%A8archlinux%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AEvnc-server/index.html)</span></span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">sudo pacman -S tigervnc</span><br><span class="line">vncpasswd</span><br><span class="line"><span class="comment">#Would you like to enter a view-only password (y/n)? n</span></span><br><span class="line">sudo cp /lib/systemd/system/vncserver@.service /etc/systemd/system/vncserver@\:1.service</span><br><span class="line">sudo vim /etc/systemd/system/vncserver@:1.service</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl start vncserver@:1.service</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> vncserver@:1.service</span><br><span class="line">ls ~/.vnc</span><br><span class="line">vncserver :1</span><br><span class="line">netstat -pantu|grep 5901</span><br><span class="line"><span class="comment"># 客户端开始连接  vncviewer 192.168.1.3:5901</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/systemd/system/vncserver@:1.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Remote desktop service (VNC)</span><br><span class="line">After=syslog.target network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStartPre=/bin/sh -c <span class="string">&#x27;/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :&#x27;</span></span><br><span class="line">ExecStart=/usr/bin/vncserver_wrapper zh %i</span><br><span class="line">ExecStop=/bin/sh -c <span class="string">&#x27;/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :&#x27;</span></span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>




<h3 id="deepin-TIM-QQ"><a href="#deepin-TIM-QQ" class="headerlink" title="deepin TIM/QQ"></a><a target="_blank" rel="noopener" href="https://hacpai.com/article/1552717494529">deepin TIM/QQ</a></h3><p>前提：添加 archlinuxcn 源。在 /etc/pacman.conf 里加入以下代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">SigLevel = Never</span><br><span class="line">Server = http://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -Sy</span><br></pre></td></tr></table></figure>
<p>安装 TIM</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S deepin.com.qq.office</span><br><span class="line">nohup /opt/deepinwine/apps/Deepin-WeChat/run.sh &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<p>无法启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">X Error of failed request: BadWindow (invalid Window parameter)</span><br><span class="line">Major opcode of failed request: 20 (X_GetProperty)</span><br><span class="line">Resource id <span class="keyword">in</span> failed request:</span><br><span class="line">0x0 Serial number of failed request:</span><br><span class="line">10 Current serial number <span class="keyword">in</span> output stream: 10</span><br></pre></td></tr></table></figure>
<p>解决方案</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yaourt -S gnome-settings-daemon</span><br><span class="line">nohup /usr/lib/gsd-xsettings &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">nohup /opt/deepinwine/apps/Deepin-WeChat/run.sh &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<p>开机启动 /usr/lib/gsd-xsettings ,往 ~/.i3/config 加入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec_always --no-startup-id nohup /usr/lib/gsd-xsettings &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>
<p>系统语言非中文时，中文全显示成方块，需要在 /opt/deepinwine/tools/run.sh 中将 WINE_CMD 那一行修改为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WINE_CMD=<span class="string">&quot;LC_ALL=zh_CN.UTF-8 deepin-wine&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="WeChat"><a href="#WeChat" class="headerlink" title="WeChat"></a><a target="_blank" rel="noopener" href="https://github.com/countstarlight/deepin-wine-wechat-arch">WeChat</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yay -S deepin-wine-wechat</span><br><span class="line">/opt/deepinwine/apps/Deepin-WeChat/run.sh</span><br></pre></td></tr></table></figure>
<h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><p><a target="_blank" rel="noopener" href="https://github.com/joh/when-changed">when-changed</a>: 监控文件变动并且执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install when-changed</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install ipdb</span><br></pre></td></tr></table></figure>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/10/26/vim/">vim</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2019-10-26T07:32:41.000Z" itemprop="datePublished">2019-10-26</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/vim/" rel="tag">vim</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="vim小技巧"><a href="#vim小技巧" class="headerlink" title="vim小技巧"></a>vim小技巧</h1><h2 id="快速插入时间"><a href="#快速插入时间" class="headerlink" title="快速插入时间"></a>快速插入时间</h2><p>把下面行追加到 ~/.vimrc ，在vim的插入模式输入 xtime 即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iab xtime &lt;c-r&gt;=strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)&lt;cr&gt;</span><br></pre></td></tr></table></figure>
<h2 id="复制-剪切-删除"><a href="#复制-剪切-删除" class="headerlink" title="复制/剪切/删除"></a>复制/剪切/删除</h2><p><code>print("Hi, this is a 'word'!")</code></p>
<ul>
<li>拷贝<code>word</code>:光标移到<code>o</code>，<code>yiw</code>(举一反三:<code>viw</code>,<code>diw</code>,<code>ciw</code>)或者<code>yi'</code></li>
<li>拷贝<code>'word'</code>:光标移到<code>o</code>，<code>ya'</code>(举一反三:<code>va'</code>,<code>da'</code>,<code>ca'</code>)</li>
<li>拷贝<code>Hi, this is a 'word'!</code>:光标移到<code>o</code>，<code>yi"</code>(举一反三:<code>vi"</code>,<code>di"</code>,<code>ci"</code>)</li>
<li>拷贝<code>"Hi, this is a 'word'!"</code>:光标移到<code>o</code>，<code>ya"</code>(举一反三:<code>va"</code>,<code>da"</code>,<code>ca"</code>)</li>
</ul>
<h2 id="vim寄存器"><a href="#vim寄存器" class="headerlink" title="vim寄存器"></a>vim寄存器</h2><p>查看vim常用寄存器的保存的内容<code>:registers</code></p>
<p>a-z每个字母对应一个寄存器,查看寄存器a对应的值<code>:reg a</code>,查看寄存器b对应的值<code>:reg a</code></p>
<p><code>normal</code>模式下粘贴寄存器a的内容<code>"ap</code>,<code>insert</code>模式下粘贴寄存器a的内容<code>Ctrl+r a</code></p>
<p><code>print("Hi, this is a 'word'!")</code></p>
<ul>
<li>拷贝<code>word</code>进<code>寄存器a</code>:光标移到<code>o</code>,<code>"a</code>(选择<code>寄存器a</code>),<code>yiw</code>(拷贝单词)</li>
<li>拷贝<code>this</code>进<code>寄存器b</code>:光标移到<code>h</code>,<code>"b</code>(选择<code>寄存器b</code>),<code>yiw</code>(拷贝单词)</li>
<li>查看<code>寄存器a</code>保存的内容:<code>:reg a</code></li>
<li>查看<code>寄存器b</code>保存的内容:<code>:reg b</code></li>
<li>粘贴<code>word</code>(即<code>寄存器a</code>的内容):光标移到粘贴位置,<code>"a</code>(选择<code>寄存器a</code>),<code>p</code>(粘贴)</li>
<li>粘贴<code>this</code>(即<code>寄存器b</code>的内容):光标移到粘贴位置,<code>"b</code>(选择<code>寄存器b</code>),<code>p</code>(粘贴)</li>
</ul>
<p>当我们不选择寄存器直接使用<code>y</code>或<code>d</code>操作时，被操作的内容会被拷贝或者剪切到<code>""</code>(无名寄存器)中</p>
<p><code>"%</code>:内容是当前文件名，一般写文件注释头会用到</p>
<p><code>".</code>:上次插入的文本</p>
<p><code>"+</code>:系统剪切板,查看vim是否支持使用系统剪切板<code>:echo has('clipboard')</code>,输出1表示支持</p>
<ul>
<li>在别的程序(如浏览器网页)用鼠标选择内容,<code>Ctrl+c</code>(拷贝内容到系统剪切板),回到vim用<code>"+</code>(选择系统剪切板),<code>p</code>(粘贴系统剪切板的内容)</li>
<li><code>"+</code>(选择系统剪切板),<code>yy</code>(拷贝一行进入系统剪切板),可以在别的编辑器或者程序(如浏览器搜索框)里用<code>Ctrl+v</code>粘贴</li>
<li>vim拷贝默认放入<code>""</code>(无名寄存器),如果想用<code>"+</code>(系统剪切板)取代<code>""</code>(无名寄存器),需要<code>:set clipboard^=unnamed,unnamedplus</code></li>
</ul>
<h2 id="粘贴网上拷贝的代码出现缩进对齐错乱"><a href="#粘贴网上拷贝的代码出现缩进对齐错乱" class="headerlink" title="粘贴网上拷贝的代码出现缩进对齐错乱"></a>粘贴网上拷贝的代码出现缩进对齐错乱</h2><p>当vim <code>:set autoindent</code> 之后，在<code>insert</code>模式下用<code>Ctrl+Shift+v</code>粘贴网上拷贝的代码会出现缩进对齐错乱</p>
<ul>
<li>方法1. <code>:set paste</code>,<code>i</code>(进入插入模式),<code>Ctrl+Shift+v</code>(粘贴),<code>:set nopaste</code></li>
<li>方法2. <code>"+</code>(选择系统剪切板),<code>p</code>(粘贴)</li>
<li>方法3. <code>:set clipboard^=unnamed,unnamedplus</code>(使用系统剪切板取代无名寄存器),<code>p</code>(粘贴)</li>
</ul>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/10/23/linux%E4%BD%BF%E7%94%A8mail%E5%91%BD%E4%BB%A4%E5%8F%91%E9%82%AE%E4%BB%B6/">linux使用mail命令发邮件</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2019-10-23T07:32:41.000Z" itemprop="datePublished">2019-10-23</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/mail/" rel="tag">mail</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h1 id="linux使用mail命令发邮件"><a href="#linux使用mail命令发邮件" class="headerlink" title="linux使用mail命令发邮件"></a>linux使用mail命令发邮件</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h2 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install s-nail</span><br></pre></td></tr></table></figure>
<h2 id="manjaro"><a href="#manjaro" class="headerlink" title="manjaro"></a>manjaro</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S s-nail</span><br></pre></td></tr></table></figure>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>修改/etc/mail.rc或/etc/nail.rc或/etc/s-nail.rc(Ubuntu)、/etc/mail.rc(centOS)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> from=humble.li@evpowergroup.com smtp=<span class="string">&quot;smtp.mxhichina.com&quot;</span></span><br><span class="line"><span class="built_in">set</span> smtp-auth-user=<span class="string">&quot;humble.li@evpowergroup.com&quot;</span> smtp-auth-password=<span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="built_in">set</span> smtp-auth=login</span><br></pre></td></tr></table></figure>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><h3 id="1-无邮件正文-如果需要结束交互可按ctrl-d"><a href="#1-无邮件正文-如果需要结束交互可按ctrl-d" class="headerlink" title="1.无邮件正文(如果需要结束交互可按ctrl+d)"></a>1.无邮件正文(如果需要结束交互可按ctrl+d)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mail -s <span class="string">&quot;测试主题&quot;</span> humble.li@evpowergroup.com</span><br></pre></td></tr></table></figure>
<h3 id="2-有邮件正文"><a href="#2-有邮件正文" class="headerlink" title="2.有邮件正文"></a>2.有邮件正文</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mail -s <span class="string">&quot;测试主题&quot;</span> humble.li@evpowergroup.com &lt; 正文文件.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;正文内容&quot;</span> | mail -s <span class="string">&quot;测试主题&quot;</span> humble.li@evpowergroup.com</span><br><span class="line">cat 正文文件.txt | mail -s <span class="string">&quot;测试主题&quot;</span> humble.li@evpowergroup.com</span><br></pre></td></tr></table></figure>
<h3 id="3-带附件-doesn’t-work"><a href="#3-带附件-doesn’t-work" class="headerlink" title="3.带附件(doesn’t work)"></a>3.带附件(doesn’t work)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uuencode a.txt a.txt | mail -s <span class="string">&quot;测试主题&quot;</span> humble.li@evpowergroup.com &lt; 正文文件.txt</span><br></pre></td></tr></table></figure>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/08/27/Docker%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">Docker入门学习笔记</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2019-08-27T07:32:41.000Z" itemprop="datePublished">2019-08-27</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/docker/" rel="tag">docker</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>版权声明：本文为CSDN博主「渣渣的夏天」的原创文章，遵循CC 4.0 by-sa版权协议，转载请附上原文出处链接及本声明。</p>
<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39564555/article/details/97620705">https://blog.csdn.net/qq_39564555/article/details/97620705</a></p>
<p>B站——<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av17854410?from=search&amp;seid=1543774132825041407">【公开课】Docker入坑教程【33集】 庄七</a></p>
<h1 id="Docker入门学习笔记"><a href="#Docker入门学习笔记" class="headerlink" title="Docker入门学习笔记"></a>Docker入门学习笔记</h1><h2 id="1-什么是Docker？"><a href="#1-什么是Docker？" class="headerlink" title="1. 什么是Docker？"></a>1. 什么是Docker？</h2><ul>
<li>将应用程序自动部署到容器</li>
</ul>
<h2 id="2-Docke的目标"><a href="#2-Docke的目标" class="headerlink" title="2. Docke的目标"></a>2. Docke的目标</h2><ul>
<li>提供简单轻量的建模方式</li>
<li>职责的逻辑分离</li>
<li>快速高效的开发周期</li>
<li>鼓励面向服务的架构</li>
</ul>
<h2 id="3-Docker通常应用场景"><a href="#3-Docker通常应用场景" class="headerlink" title="3. Docker通常应用场景"></a>3. Docker通常应用场景</h2><ul>
<li>使用Docker容器开发、测试、部署服务</li>
<li>创建隔离的运行环境</li>
<li>搭建多用户的平台即服务（PaaS）基础设施</li>
<li>提供软件即服务（SaaS）应用程序</li>
<li>高性能、超大规模的宿主机部署</li>
</ul>
<h2 id="4-Docker的基本组成"><a href="#4-Docker的基本组成" class="headerlink" title="4. Docker的基本组成"></a>4. Docker的基本组成</h2><ul>
<li>Docker Client 客户端</li>
<li>Docker Daemon 守护进程</li>
<li>Docker Image 镜像</li>
<li>Docker Container 容器</li>
<li>Docker Registey 仓库</li>
</ul>
<h2 id="5-Docker基本操作"><a href="#5-Docker基本操作" class="headerlink" title="5. Docker基本操作"></a>5. Docker基本操作</h2><p>运行容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run IMAGE [COMMAND] [ARG…]</span><br><span class="line">    run 在新容器中执行命令</span><br></pre></td></tr></table></figure>
<p>启动交互式容器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -i -t IMAGE /bin/bash</span><br><span class="line">    -i  --interactive=<span class="literal">true</span>|<span class="literal">false</span> 默认为<span class="literal">false</span></span><br><span class="line">    -t  --tty=<span class="literal">true</span>|<span class="literal">false</span> 默认为<span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>查看容器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps [-a] [-l]</span><br><span class="line"><span class="comment"># docker inspect 容器名/id</span></span><br></pre></td></tr></table></figure>
<p>自定义容器名：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name=自定义名 -i -t /bin/bash</span><br></pre></td></tr></table></figure>
<p>重新启动已经停止的容器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start [-i] 容器名/id</span><br></pre></td></tr></table></figure>
<p>删除停止的容器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器名/id</span><br></pre></td></tr></table></figure>
<h2 id="6-守护式容器"><a href="#6-守护式容器" class="headerlink" title="6. 守护式容器"></a>6. 守护式容器</h2><ul>
<li>能够长期运行</li>
<li>没有交互式会话</li>
<li>适合运行应用程序和服务</li>
</ul>
<p>以守护形式运行容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -i -t IMAGE /bin/bash</span><br><span class="line">Ctrl+P Ctrl+Q</span><br></pre></td></tr></table></figure>
<p>附加到运行中的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach 容器名/id</span><br></pre></td></tr></table></figure>
<p>启动守护式容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -d 镜像名 [COMMAND] [ARG…]</span><br><span class="line">    -d  以后台运行方式启动</span><br></pre></td></tr></table></figure>
<p>查看容器日志</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker logs [-f] [-t] [--tail] 容器名/id</span><br><span class="line">    -f --follows=<span class="literal">true</span>|<span class="literal">false</span> 默认为<span class="literal">false</span></span><br><span class="line">        一直跟踪日志变化并返回结果，Ctrl+C停止</span><br><span class="line">    -t --timestamps=<span class="literal">true</span>|<span class="literal">false</span> 默认为<span class="literal">false</span></span><br><span class="line">        附加时间戳</span><br><span class="line">    --tail =<span class="string">&quot;all&quot;</span></span><br><span class="line">        返回结尾处日志，未指定则返回所有日志</span><br></pre></td></tr></table></figure>
<p>查看容器内进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top 容器名/id</span><br></pre></td></tr></table></figure>
<p>在运行中的容器内启动新进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> [-d][-i][-t] 容器名/id [COMMAND] [ARG…]</span><br></pre></td></tr></table></figure>
<p>停止守护容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器名/id     发送信号后等待服务器停止</span><br><span class="line"><span class="comment"># docker kill 容器名/id     直接终止</span></span><br></pre></td></tr></table></figure>
<p>使用docker帮助文档</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">man docker-run</span><br></pre></td></tr></table></figure>
<h2 id="7-在容器中部署静态网站"><a href="#7-在容器中部署静态网站" class="headerlink" title="7. 在容器中部署静态网站"></a>7. 在容器中部署静态网站</h2><p>设置容器的端口映射</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">run [-P] [-p]</span><br><span class="line">    -P --publish-all=<span class="literal">true</span> | <span class="literal">false</span> 默认为<span class="literal">false</span></span><br><span class="line">        <span class="comment"># docker run -P -i -t ubuntu /bin/bash</span></span><br><span class="line">        映射所有端口</span><br><span class="line">    -p --publish=[]     指定映射端口</span><br><span class="line">        containerPort</span><br><span class="line">            <span class="comment"># docker run -p 80 -i -t ubuntu /bin/bash</span></span><br><span class="line">        hostPort:containerPort</span><br><span class="line">            <span class="comment"># docker run -p 8080:80 -i -t ubuntu /bin/bash</span></span><br><span class="line">        ip:containerPort</span><br><span class="line">            <span class="comment"># docker run -p 0.0.0.0:80 -i -t ubuntu /bin/bash</span></span><br><span class="line">        ip:hostPort:containerPort</span><br><span class="line">            <span class="comment"># docker run -p 0.0.0.0:8080:80 -i -t ubuntu /bin/bash</span></span><br></pre></td></tr></table></figure>
<p>Nginx部署静态网页流程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- 创建映射80端口的交互式容器</span><br><span class="line">- 安装Nginx</span><br><span class="line">- 安装文本编辑器vim</span><br><span class="line">- 创建静态页面</span><br><span class="line">- 修改Nginx配置文件</span><br><span class="line">- 运行Nginx</span><br><span class="line">- 验证网站访问</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 80 --name web -i -t ubuntu /bin/bash</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -y nginx</span><br><span class="line">apt-get install -y vim</span><br><span class="line"></span><br><span class="line">mkdir -p /var/www/html</span><br><span class="line"><span class="built_in">cd</span> /var/www/html</span><br><span class="line">vim index.html</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Nginx in Docker<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello, I&#x27;m website in docker!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">whereis nginx</span><br><span class="line">vim /etc/nginx/sites-enabled/default   <span class="comment"># 修改 root 的值为 /var/www/html</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /</span><br><span class="line">nginx</span><br><span class="line">ps -ef</span><br><span class="line">Ctrl+P Ctrl+Q 退出，后台运行</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker ps     查看运行的容器</span></span><br><span class="line"><span class="comment"># docker port web       查看端口映射情况</span></span><br><span class="line"><span class="comment"># docker top web        查看容器进程情况</span></span><br><span class="line"></span><br><span class="line">curl http://127.0.0.1:32768     以映射的端口为准</span><br><span class="line"></span><br><span class="line"><span class="comment"># docekr inspect web        查看容器对应的IPAddress</span></span><br><span class="line">curl 172.17.0.2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭容器</span></span><br><span class="line"><span class="comment"># docker stop web</span></span><br><span class="line"><span class="comment"># docker start -i web</span></span><br><span class="line"><span class="comment"># ps -ef</span></span><br><span class="line"><span class="comment"># nignx并未启动</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># docker exec web nginx</span></span><br><span class="line"><span class="comment"># 重新启动Nginx</span></span><br><span class="line"><span class="comment"># 映射的端口和IP地址均已改变</span></span><br></pre></td></tr></table></figure>
<h2 id="8-镜像的相关操作"><a href="#8-镜像的相关操作" class="headerlink" title="8. 镜像的相关操作"></a>8. 镜像的相关操作</h2><p>Docker镜像：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">容器的基石</span><br><span class="line">层叠的只读文件系统</span><br><span class="line">联合加载（union mount）</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker info</span></span><br><span class="line">查看docker配置的相关信息</span><br></pre></td></tr></table></figure>
<p>列出镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker images [OPTIONS] [REPOSITORY]</span><br><span class="line">    -a  --all=False 显示所有镜像</span><br><span class="line">    -f  --filter=[] 显示时的过滤条件</span><br><span class="line">    --no-trunc=<span class="literal">false</span>    不使用截断的形式显示命令</span><br><span class="line">    -q  --quiet=<span class="literal">false</span>   只显示镜像的v-id</span><br></pre></td></tr></table></figure>
<p>查看镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect [OPTIONS] CONTAINER|IMAGE[CONTAINER|IMAGE……]</span><br></pre></td></tr></table></figure>
<p>删除镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rmi [OPTIONS] IMAGE [IMAGE…]</span><br><span class="line">-f  --force=<span class="literal">false</span>   强制删除镜像</span><br><span class="line">--no-prune=<span class="literal">false</span>    保留删除镜像中未打标签的父镜像</span><br></pre></td></tr></table></figure>
<p>查找镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Docker Hub  https://hub.docker.com/</span><br><span class="line"><span class="comment"># docker search [OPTIONS] TERM</span></span><br><span class="line">    --automated=<span class="literal">false</span>   只显示自动化构建的选项</span><br><span class="line">    --no-trunc=<span class="literal">false</span>    以截断方式显示image id</span><br><span class="line">    -s  --stars=0   设置显示结果的最低星级</span><br><span class="line">    一次最多返回25个结果</span><br></pre></td></tr></table></figure>
<p>拉取镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker pull [OPTIONS] NAME[:TAG]</span><br><span class="line">    -a  --all-tags=<span class="literal">false</span>    下载仓库中所有标签镜像</span><br><span class="line"></span><br><span class="line">提速</span><br><span class="line">    使用--registry-mirror选项</span><br><span class="line">        1.修改：vim /etc/default/docker</span><br><span class="line">        2.添加：DOCKER_OPTS = <span class="string">&quot;--registry-mirror=http://MIRROR-ADDR&quot;</span></span><br><span class="line">            https://www.daocloud.io</span><br></pre></td></tr></table></figure>
<p>推送镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push NAME[:TAG]</span><br></pre></td></tr></table></figure>
<p>构建镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">保存对容器的修改，并再次使用</span><br><span class="line">自定义镜像的能力</span><br><span class="line">以软件的形式打包并分发服务及其运行环境</span><br><span class="line"></span><br><span class="line">1.使用commit构建镜像</span><br><span class="line">    <span class="comment"># docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</span></span><br><span class="line">    -a  --author=<span class="string">&quot;&quot;</span> 指定镜像作者，一般：name@email</span><br><span class="line">    -m  --message=<span class="string">&quot;&quot;</span>    提交信息</span><br><span class="line">    -p  --pause=<span class="literal">true</span>    在commit过程中不暂停容器</span><br><span class="line"></span><br><span class="line">    ********************demo***************</span><br><span class="line">    <span class="comment"># docker run -it -p 80 --name commit_test ubuntu /bin/bash</span></span><br><span class="line">    <span class="comment"># apt-get update</span></span><br><span class="line">    <span class="comment"># apt-get install -y nginx</span></span><br><span class="line">    <span class="comment"># exit</span></span><br><span class="line">    <span class="comment"># docker ps -l</span></span><br><span class="line">    生成镜像</span><br><span class="line">    <span class="comment"># docker commit -a &quot;summer&quot; -m &quot;nginx&quot; commit_test summer258/commit_test1</span></span><br><span class="line">    <span class="comment"># docker images</span></span><br><span class="line">    <span class="comment"># docker run -d --name nginx_web -p 80 summer258/commit_test1 nginx -g &quot;daemon off;&quot;</span></span><br><span class="line">    <span class="comment"># docker ps</span></span><br><span class="line">    <span class="comment"># curl http://127.0.0.1:32770</span></span><br><span class="line">    ***************************************</span><br><span class="line"></span><br><span class="line">2.使用dockerfile构建镜像</span><br><span class="line"></span><br><span class="line">    <span class="comment"># docker build [OPTIONS] PATH | URL | -</span></span><br><span class="line">        --force-rm=<span class="literal">false</span></span><br><span class="line">        --no-cache=<span class="literal">false</span></span><br><span class="line">        --pull=<span class="literal">false</span></span><br><span class="line">        -q  --quiet=<span class="literal">false</span></span><br><span class="line">        --rm=<span class="literal">true</span></span><br><span class="line">        -t  --tag=<span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    创建一个Dockerfile</span><br><span class="line">        <span class="comment"># first dockerfile</span></span><br><span class="line">        FROM ubuntu:14.04</span><br><span class="line">        MAINTAINER  name <span class="string">&quot;name@email&quot;</span></span><br><span class="line">        RUN apt-get update</span><br><span class="line">        RUN apt-get install -y nginx</span><br><span class="line">        EXPOSE 80</span><br><span class="line"></span><br><span class="line">    ********************demo***************</span><br><span class="line">    <span class="comment"># mkdir -p dockerfile/df_test1</span></span><br><span class="line">    <span class="comment"># cd dockerfile/df_test1</span></span><br><span class="line">    <span class="comment"># vim Dockerfile</span></span><br><span class="line">        <span class="comment"># first dockerfile</span></span><br><span class="line">        FROM ubuntu:14.04</span><br><span class="line">        MAINTAINER  name <span class="string">&quot;name@email&quot;</span></span><br><span class="line">        RUN apt-get update</span><br><span class="line">        RUN apt-get install -y nginx</span><br><span class="line">        EXPOSE 80</span><br><span class="line">    <span class="comment"># docker build -t=&#x27;summer258/df_test1&#x27; .</span></span><br><span class="line">    <span class="comment"># docker run -d --name nginx_web2 -p 80 summer258/df_test1 nginx -g &quot;daemon off;&quot;</span></span><br><span class="line">    <span class="comment"># docker ps</span></span><br><span class="line">    <span class="comment"># curl http://127.0.0.1:32770</span></span><br><span class="line">    ***************************************</span><br></pre></td></tr></table></figure>
<h2 id="9-Docker的C-S模式"><a href="#9-Docker的C-S模式" class="headerlink" title="9. Docker的C/S模式"></a>9. Docker的C/S模式</h2><p><img src="https://img-blog.csdnimg.cn/20190801111028168.png" alt="Alt"></p>
<p>Remote API</p>
<p>RESTful风格的API</p>
<p>STDIN、STDOUT、STDERR</p>
<p><img src="https://img-blog.csdnimg.cn/2019080111200989.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<p>连接方式</p>
<p>unix:///var/run/docker.sock</p>
<p>tcp://host:port</p>
<p>fd://socketfd</p>
<p><img src="https://img-blog.csdnimg.cn/20190801111918280.png" alt="Alt"></p>
<p>test</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep docker</span><br><span class="line"><span class="comment"># docker version</span></span><br><span class="line"><span class="comment"># nc -U /var/run/docker.sock</span></span><br><span class="line">GET /info HTTP/1.1</span><br></pre></td></tr></table></figure>
<h2 id="10-Docker守护进程的配置和操作"><a href="#10-Docker守护进程的配置和操作" class="headerlink" title="10. Docker守护进程的配置和操作"></a>10. Docker守护进程的配置和操作</h2><p>查看守护进程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep docker</span><br><span class="line"><span class="comment"># status docker</span></span><br></pre></td></tr></table></figure>
<p>使用service命令管理</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start|stop|restart</span><br></pre></td></tr></table></figure>
<p>Docker的启动选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">docker -d [OPTIONS]</span><br><span class="line">    -d 表示以守护进程形式运行</span><br><span class="line"></span><br><span class="line">    运行相关：</span><br><span class="line">    -D  --debug=<span class="literal">false</span></span><br><span class="line">    -e  --exec-drive=<span class="string">&quot;native&quot;</span></span><br><span class="line">    -g  --graph=<span class="string">&quot;/var/lib/docker&quot;</span></span><br><span class="line">    --icc=<span class="literal">true</span></span><br><span class="line">    -l  --log-level=<span class="string">&quot;info&quot;</span></span><br><span class="line">    --label=[]</span><br><span class="line">    =p  --pidfile=<span class="string">&quot;/var/run/docker.pid&quot;</span></span><br><span class="line"></span><br><span class="line">    Docker服务器连接相关：</span><br><span class="line">    -G,--group=<span class="string">&quot;docker&quot;</span></span><br><span class="line">    -H,--host=[]</span><br><span class="line">    --tls=<span class="literal">false</span></span><br><span class="line">    --tlscacert=<span class="string">&quot;/home/sven/.docker/ca.pem&quot;</span></span><br><span class="line">    --tlscert=<span class="string">&quot;/home/sven/.docker/cert.pem&quot;</span></span><br><span class="line">    --tlskey=<span class="string">&quot;/home/sven/.docker/key.pem&quot;</span></span><br><span class="line">    --tlsverify=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    RemoteAPI相关：</span><br><span class="line">    --api-enable-cors=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    存储相关：</span><br><span class="line">    -s,--storage-drive=<span class="string">&quot;&quot;</span></span><br><span class="line">    --selinux-enabled=<span class="literal">false</span></span><br><span class="line">    --storage-opt=[]</span><br><span class="line"></span><br><span class="line">    Registry相关：</span><br><span class="line">    --insecure-registry=[]</span><br><span class="line">    --registry-mirror=[]</span><br><span class="line"></span><br><span class="line">    网络设置相关：</span><br><span class="line">    -b,--bridge=<span class="string">&quot;&quot;</span></span><br><span class="line">    --bip=<span class="string">&quot;&quot;</span></span><br><span class="line">    --fixed-cidr=<span class="string">&quot;&quot;</span></span><br><span class="line">    --fixed-cidr-v6=<span class="string">&quot;&quot;</span></span><br><span class="line">    --dns=[]</span><br><span class="line">    --dns-search=[]</span><br><span class="line">    --ip=0.0.0.0</span><br><span class="line">    --ip-forward=<span class="literal">true</span></span><br><span class="line">    --ip-masq=<span class="literal">true</span></span><br><span class="line">    --iptables=<span class="literal">true</span></span><br><span class="line">    --ipv6=<span class="literal">false</span></span><br><span class="line">    --mtu=0</span><br></pre></td></tr></table></figure>
<p>docker启动配置文件：/etc/default/docker</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DOCKER_OPTS = <span class="string">&quot;……&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="11-Docker的远程访问"><a href="#11-Docker的远程访问" class="headerlink" title="11. Docker的远程访问"></a>11. Docker的远程访问</h2><p>环境准备：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">第二台安装Docker的服务器</span><br><span class="line">修改Docker守护进程启动选项，区别服务器</span><br><span class="line">保证Client API和Server API版本一致</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker version</span></span><br><span class="line">    查看版本API是否一致</span><br></pre></td></tr></table></figure>
<p>修改服务器端配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">修改Docker守护进程启动项</span><br><span class="line">-H  tcp://host:port</span><br><span class="line">    unix:///path/to/socket</span><br><span class="line">    fd://* or fd://socketfd</span><br><span class="line">守护进程默认配置：</span><br><span class="line">-H  unix:///var/run/docker.sock</span><br><span class="line"></span><br><span class="line">vim /etc/default/docker</span><br><span class="line">    DOCKER_OPTS = <span class="string">&quot;-H tcp://0.0.0.0:2375&quot;</span></span><br><span class="line">    <span class="comment"># 一般选择2375端口</span></span><br><span class="line">重启服务 <span class="comment"># service docker restart</span></span><br><span class="line">ifconfig    获取本机IP地址</span><br></pre></td></tr></table></figure>
<p>远程访问</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://服务器IP：配置port/info</span><br></pre></td></tr></table></figure>
<p>客户端远程访问：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">修改客户端配置</span><br><span class="line">使用Docker客户端命令选项</span><br><span class="line">-H  tcp://host:port</span><br><span class="line">    unix:///path/to/socket</span><br><span class="line">    fd://* or fd://socketfd</span><br><span class="line">客户端默认配置：</span><br><span class="line">-H  unix:///var/run/docker.sock</span><br><span class="line"></span><br><span class="line"><span class="comment"># docker -H tcp://ip:port info</span></span><br><span class="line"></span><br><span class="line">使用环境变量简化操作DOCKER_HOST</span><br><span class="line"><span class="built_in">export</span> DOCKER_HOST=<span class="string">&quot;tcp://ip:port&quot;</span></span><br><span class="line"></span><br><span class="line">将环境变量置空则返回本机服务</span><br><span class="line"><span class="built_in">export</span> DOCKER_HOST=<span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>设置了远程访问模式后的服务端不再支持本机连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.将本机作为远程客户端，通过DOCKER_HOST连接</span><br><span class="line">2.修改本机配置，添加默认配置</span><br><span class="line">vim /etc/default/docker</span><br><span class="line">    DOCKER_OPTS = <span class="string">&quot;-H tcp://0.0.0.0:2375 -H  unix:///var/run/docker.sock&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="12-Dockerfile指令"><a href="#12-Dockerfile指令" class="headerlink" title="12. Dockerfile指令"></a>12. Dockerfile指令</h2><p>创建一个Dockerfile</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">first dockerfile</span><br><span class="line">FROM ubuntu:14.04</span><br><span class="line">MAINTAINER  name <span class="string">&quot;name@email&quot;</span></span><br><span class="line">RUN apt-get update</span><br><span class="line">RUN apt-get install -y nginx</span><br><span class="line">EXPOSE 80</span><br></pre></td></tr></table></figure>
<p>指令格式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Comment</span><br><span class="line">INSTRUCTION argument</span><br></pre></td></tr></table></figure>
<p>FROM &lt;image&gt;[:&lt;tag&gt;]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">已经存在的镜像</span><br><span class="line">基础镜像</span><br><span class="line">必须是第一条非注释指令</span><br></pre></td></tr></table></figure>
<p>MAINTAINER  &lt;name&gt;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">指定镜像的作者信息，包含镜像的所有者和联系信息</span><br></pre></td></tr></table></figure>
<p>RUN</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">指定当前镜像中运行的命令</span><br><span class="line">shell模式</span><br><span class="line">    RUN &lt;<span class="built_in">command</span>&gt;</span><br><span class="line">    默认shell   /bin/sh -c <span class="built_in">command</span></span><br><span class="line"><span class="built_in">exec</span>模式</span><br><span class="line">    RUN [ <span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>]</span><br><span class="line">    可以指定其他shell   RUN [<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo hello&quot;</span>]</span><br></pre></td></tr></table></figure>
<p>EXPOSE &lt;port&gt; [&lt;port&gt;…]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">指定运行该镜像的容器使用的端口</span><br><span class="line">在使用时仍需指定    -p port</span><br></pre></td></tr></table></figure>
<p>CMD</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">提供容器运行时的命令，作为默认设置，会被docker run中相同命令覆盖</span><br><span class="line">CMD [ <span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>] (<span class="built_in">exec</span>模式)</span><br><span class="line">CMD <span class="built_in">command</span> param1 param2   (shell模式)</span><br><span class="line">CMD [<span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>]    (作为ENTRYPOINT指令的默认参数)</span><br></pre></td></tr></table></figure>
<p>ENTRYPOINT</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ENTRYPOINT [ <span class="string">&quot;executable&quot;</span>, <span class="string">&quot;param1&quot;</span>, <span class="string">&quot;param2&quot;</span>] (<span class="built_in">exec</span>模式)</span><br><span class="line">ENTRYPOINT <span class="built_in">command</span> param1 param2   (shell模式)</span><br><span class="line">默认不会被docker run中命令覆盖</span><br><span class="line">可以使用 docker run entrypoint 覆盖</span><br></pre></td></tr></table></figure>
<p>ADD、COPY</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">将文件/目录复制到Dockerfile构建的文件中，源地址，目标地址</span><br><span class="line">ADD &lt;src&gt;…&lt;dest&gt;</span><br><span class="line">ADD [<span class="string">&quot;&lt;src&gt;&quot;</span>…<span class="string">&quot;&lt;dest&gt;&quot;</span>]  (使用于文件路径中有空格的情况)</span><br><span class="line"></span><br><span class="line">COPY &lt;src&gt;…&lt;dest&gt;</span><br><span class="line">COPY [<span class="string">&quot;&lt;src&gt;&quot;</span>…<span class="string">&quot;&lt;dest&gt;&quot;</span>]  (使用于文件路径中有空格的情况)</span><br><span class="line"></span><br><span class="line">ADD vs COPY</span><br><span class="line">    ADD包含类似tar的解压功能</span><br><span class="line">    如果单纯复制文件，Docker推荐使用COPY</span><br></pre></td></tr></table></figure>
<p>VOLUME [“/data”]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用于向基于镜像创建的容器添加数据卷，共享数据/数据持久化</span><br></pre></td></tr></table></figure>
<p>WORKDIR /path/to/workdir</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在镜像创建新容器时，指定工作目录，一般使用绝对路径，相对路径会持续传递</span><br></pre></td></tr></table></figure>
<p>ENV &lt;key&gt;&lt;value&gt;</p>
<p>ENV &lt;key&gt;=&lt;value&gt;…</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用户设置环境变量</span><br></pre></td></tr></table></figure>
<p>USER daemon</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">指定镜像运行的用户，默认为root</span><br></pre></td></tr></table></figure>
<p>ONBUILD [INSTRUCTION]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">镜像触发器</span><br><span class="line">当一个镜像被其他镜像作为基础镜像时执行</span><br><span class="line">会在构建过程中插入指令</span><br></pre></td></tr></table></figure>
<h2 id="13-Dockerfile构建过程"><a href="#13-Dockerfile构建过程" class="headerlink" title="13. Dockerfile构建过程"></a>13. Dockerfile构建过程</h2><ul>
<li><p>从基础镜像运行一个容器</p>
</li>
<li><p>执行一条指令，对容器做出修改</p>
</li>
<li><p>执行类似docker commit的操作，提交一个新的镜像层</p>
</li>
<li><p>基于刚提交的镜像运行一个新容器</p>
</li>
<li><p>执行Dockefile中的下一条指令，直至所有指令执行完毕</p>
</li>
<li><p>中间层镜像不会被删除，中间层容器会被删除</p>
</li>
<li><p>可以使用中间层镜像调试</p>
<p>  查找错误</p>
</li>
<li><p>构建缓存</p>
</li>
<li><p>不适用构建缓存</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker build --no-cache</span><br><span class="line">或者</span><br><span class="line">在Dockerfile中设置缓存刷新时间</span><br><span class="line">ENV REFRESH_DATE 2019-8-2</span><br></pre></td></tr></table></figure>
<ul>
<li>查看镜像构建的过程</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">history</span> [image]</span><br></pre></td></tr></table></figure>
<h2 id="14-Docker容器的网络连接"><a href="#14-Docker容器的网络连接" class="headerlink" title="14. Docker容器的网络连接"></a>14. Docker容器的网络连接</h2><ul>
<li>Docker容器的网络基础</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190802093313966.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">docker0——Linux虚拟网桥</span><br><span class="line"></span><br><span class="line">    Linux虚拟网桥:</span><br><span class="line">        可以设置IP地址</span><br><span class="line">        相当于拥有一个隐藏的虚拟网卡</span><br><span class="line"></span><br><span class="line">    docker0 地址划分</span><br><span class="line">        IP:172.17.42.1  子网掩码：255.255.0.0</span><br><span class="line">        MAC：02:42:ac:11:00:00到02:42:ac:11:ff:ff</span><br><span class="line">        总共提供了65534个地址</span><br><span class="line"></span><br><span class="line">    安装网桥管理程序</span><br><span class="line">        yum -y install bridge-utils</span><br><span class="line">    查看网桥设备</span><br><span class="line">        <span class="comment"># brctl show</span></span><br><span class="line"></span><br><span class="line">自定义Docker0</span><br><span class="line"></span><br><span class="line">    修改docker0地址</span><br><span class="line">    $ sudo ifconfig docker0 192.168.200.1 netmask 255.255.255.0</span><br><span class="line"></span><br><span class="line">自定义虚拟网桥</span><br><span class="line"></span><br><span class="line">    添加虚拟网桥</span><br><span class="line">        $ sudo brctl addbr br0</span><br><span class="line">        $ sudo ifconfig br0 192.168.100.1 netmask 255.255.255.0</span><br><span class="line">    更改docker守护进程的启动配置</span><br><span class="line">        /etc/default/docker 中添加DOCKER_OPTS值</span><br><span class="line">        -b=br0</span><br></pre></td></tr></table></figure>
<ul>
<li>Docker容器的互联</li>
</ul>
<p>环境准备</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">用于测试的Docker镜像Dockerfile：</span><br><span class="line">    <span class="comment"># ./cct/Dockerfile</span></span><br><span class="line">    <span class="comment"># container connection test</span></span><br><span class="line">    FROM ubuntu:14.04</span><br><span class="line">    RUN apt-get install -y ping</span><br><span class="line">    RUN apt-get update</span><br><span class="line">    RUN apt-get install -y nginx</span><br><span class="line">    RUN apt-get install -y curl</span><br><span class="line">    EXPOSE 80</span><br><span class="line">    CMD /bin/bash</span><br><span class="line"></span><br><span class="line">    <span class="comment"># docker build -t summer258/cct .</span></span><br></pre></td></tr></table></figure>
<p>允许所有容器间互联</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">默认设置</span><br><span class="line">--icc=<span class="literal">true</span>  默认</span><br><span class="line"></span><br><span class="line">启动第一个容器</span><br><span class="line"><span class="comment"># docker run -it --name cct1 summer258/cct</span></span><br><span class="line">/<span class="comment"># nginx</span></span><br><span class="line">Ctrl+P Ctrl+Q</span><br><span class="line"></span><br><span class="line">启动第二个容器</span><br><span class="line"><span class="comment"># docker run -it --name cct2 summer258/cct</span></span><br><span class="line">/<span class="comment"># ifconfig</span></span><br><span class="line">Ctrl+P Ctrl+Q</span><br><span class="line"></span><br><span class="line">inet addr:172.17.0.3</span><br><span class="line"></span><br><span class="line">连接到第一个容器cct1</span><br><span class="line"><span class="comment"># docker attach cct1</span></span><br><span class="line">/<span class="comment"># ifconfig</span></span><br><span class="line"></span><br><span class="line">inet addr:172.17.0.2</span><br><span class="line"></span><br><span class="line">测试连接：ping 172.0.3</span><br><span class="line"></span><br><span class="line">连接到第一个容器cct2</span><br><span class="line"><span class="comment"># docker attach cct2</span></span><br><span class="line">测试连接：curl http://172.17.0.2</span><br><span class="line"></span><br><span class="line">--link</span><br><span class="line">    <span class="comment"># docker run --link=[CONTAINER_NAME]:[ALIAS] [IMAGE] [COMMAND]</span></span><br><span class="line"></span><br><span class="line">启动第三个容器</span><br><span class="line"><span class="comment"># docker run -it --name cct3 --link=cct1:webtest summer258/cct</span></span><br><span class="line">/<span class="comment"># ping webtest</span></span><br><span class="line"></span><br><span class="line">重启docker服务</span><br><span class="line">    <span class="comment"># systemctl restart docker</span></span><br><span class="line">    <span class="comment"># docker restart cct1 cct2 cct3</span></span><br><span class="line">    /<span class="comment"># ping webtest</span></span><br></pre></td></tr></table></figure>
<p>拒绝所有容器间互联</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Docker守护进程的启动选项</span><br><span class="line">    DOCKER_OPTS= <span class="string">&quot; --icc=false&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ubuntu</span></span><br><span class="line">$ sudo vim /etc/default/docker</span><br><span class="line">    DOCKER_OPTS = <span class="string">&quot;--icc=false&quot;</span></span><br><span class="line"><span class="comment"># centos</span></span><br><span class="line">$ sudo vim /etc/docker/daemon.json</span><br><span class="line">    &#123;</span><br><span class="line">        …</span><br><span class="line">        “icc”:<span class="literal">false</span>,</span><br><span class="line">        …</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">$ sudo systemctl restart docker</span><br><span class="line">$ ps -ef | grep docker</span><br><span class="line">$ sudo docker restart cct1 cct2 cct3</span><br><span class="line">$ sudo docker attach cct3</span><br><span class="line">/<span class="comment"># ping webtest</span></span><br></pre></td></tr></table></figure>
<p>允许特定容器间的连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Docker守护进程的启动选项</span><br><span class="line">    --icc=<span class="literal">false</span> --iptables=<span class="literal">true</span></span><br><span class="line">    --link</span><br><span class="line"></span><br><span class="line">$ sudo iptables -F</span><br><span class="line">$ sudo iptables -L -n</span><br></pre></td></tr></table></figure>
<ul>
<li>Docker容器与外部网络的连接</li>
</ul>
<p>ip-forward</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--ip-forward=<span class="literal">true</span></span><br><span class="line">    决定系统是否会转发流量</span><br><span class="line"></span><br><span class="line">$ sudo sysctl net.ipv4.conf.all.forwarding</span><br></pre></td></tr></table></figure>
<p>iptables</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables是与Linux内核集成的包过滤防火墙系统，</span><br><span class="line">几乎所有的Linux发行版本都会包含iptables的功能</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20190802105416694.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">filter表中包含的链：</span><br><span class="line">    INPUT</span><br><span class="line">    FORWARD</span><br><span class="line">    OUTPUT</span><br><span class="line"></span><br><span class="line">$ sudo iptables -L -n</span><br></pre></td></tr></table></figure>
<p>限制IP访问容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo iptables -I DOCKER -s 10.211.55.3 -d 127.17.0.7 -p TCP --dport 80 j DROP</span><br></pre></td></tr></table></figure>
<p>端口映射访问</p>
<h2 id="15-Docker容器的数据管理"><a href="#15-Docker容器的数据管理" class="headerlink" title="15. Docker容器的数据管理"></a>15. Docker容器的数据管理</h2><ul>
<li><p>Docker容器的数据卷</p>
<p>  什么是数据卷？（Data Volume）</p>
<ul>
<li>数据卷是经过特殊设计的目录，可以绕过联合文件系统（UFS），为一个或多个容器提供访问</li>
<li>数据卷设计的目的，在于数据的永久化，它完全独立于容器的生存周期，因此，Docker不会在容器删除时删除其挂载的数据卷，也不会存在类似的垃圾收集机制，对容器引用的数据卷进行处理。</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190802111712300.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<pre><code>数据卷（Data Volume）的特点
</code></pre>
<ul>
<li>数据卷在容器启动时初始化，如果容器使用的镜像在挂载点包含了数据，这些数据会拷贝到新初始化的数据卷中。</li>
<li>数据卷可以在容器之间共享和重用。</li>
<li>可以对数据卷里的内容直接进行修改</li>
<li>数据卷的变化不会影响镜像的更新</li>
<li>卷会一直存在，及时挂载数据卷的容器已经被删除</li>
</ul>
<p>为容器添加数据卷</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -it -v ~/container_data:/data ubuntu /bin/bash</span><br><span class="line">/<span class="comment"># ls</span></span><br><span class="line"></span><br><span class="line">$ sudo docker inspect 容器名/id</span><br><span class="line">可以查看Volume目录信息</span><br></pre></td></tr></table></figure>
<p>为数据卷添加访问权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -it -v ~/datavolume:/data:ro ubuntu /bin/bash</span><br><span class="line">ro：只读</span><br></pre></td></tr></table></figure>
<p>使用Dockerfile构建包含数据卷的镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dockerfile指令：VOLUME[<span class="string">&quot;/data&quot;</span>]</span><br><span class="line">不能映射到已经存在的文件目录，系统默认创建</span><br></pre></td></tr></table></figure>
<ul>
<li><p>Docker的数据卷容器</p>
<p>  什么是数据卷容器：<br>命名的容器挂载数据卷，其他容器通过挂载这个容器实现数据共享，挂载数据卷的容器，就叫做数据卷容器。</p>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20190802115901717.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<p>挂载数据卷容器的方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --volumes-from [CONTAINER NAME]</span><br></pre></td></tr></table></figure>
<ul>
<li>Docker数据卷的备份和还原</li>
</ul>
<p>数据备份方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --volumes-from [container name] -v $(<span class="built_in">pwd</span>):/backup[:wr] ubuntu tar cvf /backup/backup.tar [container data volume]</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2019080212104349.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<p>数据还原方法</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run --volumes-from [container name] -v $(<span class="built_in">pwd</span>):/backup[:wr] ubuntu tar xvf /backup/backup.tar [container data volume]</span><br></pre></td></tr></table></figure>
<h2 id="16-Docker容器的跨主机连接"><a href="#16-Docker容器的跨主机连接" class="headerlink" title="16. Docker容器的跨主机连接"></a>16. Docker容器的跨主机连接</h2><ul>
<li><p>使用网桥实现跨主机连接</p>
<p>  原理：</p>
<p>  网络拓扑</p>
<p>  <img src="https://img-blog.csdnimg.cn/20190802151358850.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<p>  环境准备：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Mac OS X + Parallels</span><br><span class="line">两台Ubuntu 14.04 虚拟机</span><br><span class="line">安装网桥管理工具：</span><br><span class="line">    apt-get install bridge-utils</span><br><span class="line">IP地址：Host1：10.211.55.3</span><br><span class="line">        Host2：10.211.55.5</span><br></pre></td></tr></table></figure>
<p>网络配置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">修改/etc/network/interfaces 文件</span><br><span class="line">auto br0</span><br><span class="line">iface br0 inet static</span><br><span class="line">address 10.211.55.3</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 10.211.55.1</span><br><span class="line">bridge_ports eth0</span><br></pre></td></tr></table></figure>
<p>Docker设置：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">修改/etc/default/docker文件</span><br><span class="line">-b 指定使用自定义网桥</span><br><span class="line">    -b=br0</span><br><span class="line">--fixed-cidr限制IP地址分配范围</span><br><span class="line">    IP地址划分：</span><br><span class="line">    Host1：10.211.55.64/26</span><br><span class="line">        地址范围：10.211.555.65~10.211.55.126</span><br><span class="line">    Host2:192.168.59.126/26</span><br><span class="line">        地址范围：10.211.55.129~10.211.55.190</span><br></pre></td></tr></table></figure>
<p>优点：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">配置简单，不依赖第三方软件</span><br></pre></td></tr></table></figure>
<p>缺点：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">与主机在同网段，需要小心划分IP地址</span><br><span class="line">需要有网段控制权，在生产环境中不易实现</span><br><span class="line">不容易管理</span><br><span class="line">兼容性不佳</span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用Open vSwitch实现跨主机容器连接</p>
<p>  Open vSwitch是什么？</p>
<p>    Open vSwitch是一个高质量、多层虚拟交换机，使用开源Apache2.0许可协议，由Nicira Networks开发，主要实现代码为可移植的C代码。它的目的是让大规模网络自动化可以通过编程扩展，同时仍然支持标准的管理接口和协议（例如NetFlow，sFlow，SPAN，RSPAN，CLI，LACP，8022.lag）</p>
<p>  原理：</p>
<p>  <img src="https://img-blog.csdnimg.cn/20190802153203460.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<p>  什么是GRE隧道？</p>
<p>    GRE：通用路由协议封装</p>
<p>    隧道技术（Tunneling）是一种通过使用互联网络的基础设施在网络之间传递数据的方式。使用随带传递的数据（或负载）可以使不同协议的数据帧或包。隧道协议将其它协议的数据帧或包重新封装然后通过隧道发送新的帧头提供路由信息，以便通过互联网传递被封装的负载数据。</p>
<p>  环境准备：</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Mac OS X + Virtualbox</span><br><span class="line">两台Ubuntu14.04虚拟机</span><br><span class="line">双网卡，Host-Only&amp;amp;NAT</span><br><span class="line">安装Open vSwitch：</span><br><span class="line">    apt-get install openvswitch-switch</span><br><span class="line">安装网桥管理工具：</span><br><span class="line">    apt-get install bridge-utils</span><br><span class="line">IP地址：Host1：192.168.59.103</span><br><span class="line">        Host2：192.168.59.104</span><br></pre></td></tr></table></figure>

<p>操作：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">建立ovs网桥</span><br><span class="line">添加gre连接</span><br><span class="line">配置docker容器虚拟网桥</span><br><span class="line">为虚拟网桥添加ovs接口</span><br><span class="line">添加不同Docker容器网段路由</span><br><span class="line"></span><br><span class="line">  主机：192.168.59.103</span><br><span class="line">查看ovs状态</span><br><span class="line">$ sudo ovs-vsctl show</span><br><span class="line">建立ovs网桥</span><br><span class="line">$ sudo ovs-vsctl add-br obr0</span><br><span class="line">添加gre接口</span><br><span class="line">$ sudo ovs-vsctl add-port obr0 gre0</span><br><span class="line">$ sudo ovs-vsctl <span class="built_in">set</span> interface gre0 <span class="built_in">type</span>=gre options:remote_ip=192.168.59.104</span><br><span class="line">$ sudo ovs-vsctl show</span><br><span class="line"></span><br><span class="line">  建立本机docker需要使用的网桥</span><br><span class="line">$ sudo brctl addbr br0</span><br><span class="line">$ sudo ifconfig br0 192.168.1.1 netmask 255.255.255.0</span><br><span class="line">$ sudo brctl addif br0 obr0</span><br><span class="line">$ sudo brctl show</span><br><span class="line"></span><br><span class="line">  配置docker，用新建的网桥代替docker0</span><br><span class="line">$ sudo vim /etc/default/docker</span><br><span class="line">  DOCKER_OPTS=<span class="string">&quot;obr0&quot;</span></span><br><span class="line">$ sudo service docker restart</span><br><span class="line"></span><br><span class="line">  新建一个docker容器</span><br><span class="line">$ sudo docker run -it ubuntu /bin/bash</span><br><span class="line">/<span class="comment"># ifconfig</span></span><br><span class="line">  inet addr:192.168.1.2</span><br><span class="line">/<span class="comment"># ping 192.168.59.104</span></span><br><span class="line"></span><br><span class="line">  切换主机：192.168.59.104</span><br><span class="line">$ ifconfig</span><br><span class="line">  inet addr:192.168.2.1</span><br><span class="line">启动一个docker容器</span><br><span class="line">$ sudo docker run -it ubuntu /bin/bash</span><br><span class="line">/<span class="comment"># ifconfig</span></span><br><span class="line">  inet addr:192.168.2.4</span><br><span class="line">/<span class="comment"># ping 192.168.59.104</span></span><br><span class="line"></span><br><span class="line">  切回主机：192.168.59.103</span><br><span class="line">/<span class="comment"># ping 192.168.2.4</span></span><br><span class="line">  ping不通，因为不同网段需要查找路由表来确定不同网段的网络地址</span><br><span class="line">$ route</span><br><span class="line">$ sudo ip route add 192.168.2.0/24 via 192.168.59.104 dev eth0</span><br><span class="line"></span><br><span class="line">  $ sudo docker run -it ubuntu /bin/bash</span><br><span class="line">/<span class="comment"># ping 192.168.2.4</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>使用weave实现跨主机容器连接</p>
<p>  weave是什么？</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">语义：编织</span><br><span class="line">建立一个虚拟的网络，用于将运行在不同主机的Docker容器连接起来</span><br><span class="line">https://www.weave.works/</span><br><span class="line">https://github.com/weaveworks/weave<span class="comment">#readme</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20190802160953349.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM5NTY0NTU1,size_16,color_FFFFFF,t_70" alt="Alt"></p>
<p>  环境准备：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Mac OS X + Virtualbox</span><br><span class="line">两台Ubuntu14.04虚拟机</span><br><span class="line">双网卡，Host-Only&amp;amp;NAT</span><br><span class="line">IP地址：Host1：192.168.59.103</span><br><span class="line">        Host2:192.168.59.104</span><br></pre></td></tr></table></figure>
<p>操作：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">安装weave</span><br><span class="line">启动weave</span><br><span class="line">  $ weave launch</span><br><span class="line">连接不同主机</span><br><span class="line">通过weave启动容器</span><br><span class="line"></span><br><span class="line">  主机：192.168.59.103</span><br><span class="line">$ sudo wget -O /usr/bin/weave https://raw.githubusercontent.com/zettio/weave/master/weave</span><br><span class="line">$ sudo chmod a+x /usr/bin/weave</span><br><span class="line">$ weave launch</span><br><span class="line">$ sudo docker ps -l</span><br><span class="line"></span><br><span class="line">  切换主机：192.168.59.104</span><br><span class="line">重复安装操作</span><br><span class="line">$ sudo wget -O /usr/bin/weave https://raw.githubusercontent.com/zettio/weave/master/weave</span><br><span class="line">$ sudo chmod a+x /usr/bin/weave</span><br><span class="line">$ weave launch 192.168.59.103</span><br><span class="line">启动容器，将ID赋值给c2</span><br><span class="line">c2=$(weave run 192.168.1.2/24 -it ubuntu /bin/bash)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$c2</span></span><br><span class="line">$ docker attach $ c2</span><br><span class="line">/<span class="comment"># ifconfig</span></span><br><span class="line">多了一个网络设备ethwe，inet addr：192.168.1.2</span><br><span class="line"></span><br><span class="line">  切换Host1:192.168.59.103</span><br><span class="line">$ weave run 192.168.1.10/24 -it --name wc1 ubuntu /bin/bash</span><br><span class="line">相同网段的IP地址</span><br><span class="line">$ sudo docker aatach wc1</span><br><span class="line">/<span class="comment"># ifconfig</span></span><br><span class="line">增加wthwe，inet addr:192.168.1.10</span><br><span class="line">/<span class="comment"># ping 192.168.1.2</span></span><br><span class="line">能够ping通</span><br></pre></td></tr></table></figure>

        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/08/08/git%E7%AC%94%E8%AE%B0/">git笔记</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2019-08-08T07:32:41.000Z" itemprop="datePublished">2019-08-08</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/git/" rel="tag">git</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h2 id="git-config"><a href="#git-config" class="headerlink" title="git config"></a>git config</h2><h3 id="查看配置"><a href="#查看配置" class="headerlink" title="查看配置"></a>查看配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --list</span><br></pre></td></tr></table></figure>
<h3 id="全局"><a href="#全局" class="headerlink" title="全局"></a>全局</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.gitconfig</span><br><span class="line">git config --global user.name  <span class="string">&quot;username&quot;</span></span><br><span class="line">git config --global user.email  <span class="string">&quot;email&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="github令牌"><a href="#github令牌" class="headerlink" title="github令牌"></a>github令牌</h3><p>2021年8月13号之后，github已经不让直接使用账号名密码来登录了，必须使用personal access token(个人访问令牌)</p>
<ul>
<li>明文的密码很容易被泄露，如果换成有时限的token，即使泄露了影响也会非常有限。</li>
<li>可以为同一个github账号根据不同的使用途径，生成不同的token，并且随时都可以控制token的有效状态和不同token代表的权限。最大限度的保证账号的安全性。</li>
<li>生成的token可随时撤销，并且令牌的随机性更高，不容易被暴力破解。</li>
</ul>
<p>我的账号-&gt;settings-&gt;Developer settings-&gt;Personal access tokens-&gt;Generate new token-&gt;(pc名字,粘贴key)-&gt;(Note:哪台电脑，有效期(Expiration)选90天，Select scopes选repo)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/username/repo.git</span><br><span class="line">Username: your_username</span><br><span class="line">Password: your_token</span><br></pre></td></tr></table></figure>
<h3 id="ssh访问github"><a href="#ssh访问github" class="headerlink" title="ssh访问github"></a>ssh访问github</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#如果没有~/.ssh 目录就执行下面，一直回车到结束即可</span></span><br><span class="line">ssh-keygen -t rsa -C <span class="string">&quot;your email&quot;</span></span><br><span class="line"><span class="comment">#查看ssh key并且拷贝</span></span><br><span class="line">cat ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>我的账号-&gt;settings-&gt;SSH and GPG keys-&gt;New SSH key-&gt;(pc名字,粘贴key)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="comment">#运行结果出现类似如下</span></span><br><span class="line">Hi &lt;username&gt;! You<span class="string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span></span><br></pre></td></tr></table></figure>
<h3 id="局部（项目内的）"><a href="#局部（项目内的）" class="headerlink" title="局部（项目内的）"></a>局部（项目内的）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> projectdir/</span><br><span class="line">cat .git/config</span><br><span class="line">git config user.name <span class="string">&quot;username&quot;</span></span><br><span class="line">git config user.email <span class="string">&quot;email&quot;</span></span><br><span class="line">cat .git/config</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置记住密码（默认15分钟）：</span></span><br><span class="line">git config credential.helper cache</span><br><span class="line"><span class="comment">#设置记住密码1小时</span></span><br><span class="line">git config credential.helper <span class="string">&#x27;cache --timeout=3600&#x27;</span></span><br><span class="line"><span class="comment">#长期存储密码：记住密码,以明文存在~/.git-credentials电脑送人后记得删掉该文件</span></span><br><span class="line">git config credential.helper store</span><br><span class="line"><span class="comment">#重新指定.git-credentials文件路径</span></span><br><span class="line">git config credential.helper <span class="string">&#x27;store --file /data/git/.git-credentials&#x27;</span></span><br><span class="line">cat .git/config</span><br></pre></td></tr></table></figure>
<h3 id="记住或取消密码记录"><a href="#记住或取消密码记录" class="headerlink" title="记住或取消密码记录"></a>记住或取消密码记录</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(repository_home)/.git/config <span class="comment"># for the subject repository.</span></span><br><span class="line">~/.gitconfig                  <span class="comment"># for this particular user.</span></span><br><span class="line">/etc/gitconfig                <span class="comment"># for all users on this system.</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#记住密码记录</span></span><br><span class="line">git config --<span class="built_in">set</span> credential.helper <span class="string">&#x27;cache --timeout=600&#x27;</span></span><br><span class="line">git config --global --<span class="built_in">set</span> credential.helper <span class="string">&#x27;cache --timeout=600&#x27;</span></span><br><span class="line">git config --system --<span class="built_in">set</span> credential.helper <span class="string">&#x27;cache --timeout=600&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#取消密码记录</span></span><br><span class="line">git config --unset-all credential.helper</span><br><span class="line">git config --global --unset-all credential.helper</span><br><span class="line">git config --system --unset-all credential.helper</span><br></pre></td></tr></table></figure>
<h3 id="本地origin分支与远程不同步"><a href="#本地origin分支与远程不同步" class="headerlink" title="本地origin分支与远程不同步"></a>本地origin分支与远程不同步</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git remote show origin <span class="comment"># 发现不是tracked的分支(远程已删，本地还有)</span></span><br><span class="line">git remote prune origin <span class="comment"># 删除远程没有本地还在的分支</span></span><br></pre></td></tr></table></figure>
<h3 id="windows删除git记录"><a href="#windows删除git记录" class="headerlink" title="windows删除git记录"></a>windows删除git记录</h3><ol>
<li>进入控制面板</li>
<li>选择用户账户</li>
<li>选择管理你的凭据</li>
<li>选择Windows凭据</li>
<li>选择git保存的用户信息</li>
<li>选择编辑或者进行删除操作</li>
</ol>
<h3 id="git查看各分支之间关系"><a href="#git查看各分支之间关系" class="headerlink" title="git查看各分支之间关系"></a>git查看各分支之间关系</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --graph --decorate --oneline --simplify-by-decoration --all</span><br></pre></td></tr></table></figure>
<h3 id="git-status中文乱码"><a href="#git-status中文乱码" class="headerlink" title="git status中文乱码"></a><code>git status</code>中文乱码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global core.quotepath <span class="literal">false</span></span><br></pre></td></tr></table></figure>
        
    </section>
</article>


    <article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            <a href="/2019/08/08/python-pandas/">python_pandas</a>
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://humble-zh.github.io/page/6/index.html">
    
    <i class="icon-calendar vm"></i>
    
    <time class="vm" datetime="2019-08-08T06:45:30.000Z" itemprop="datePublished">2019-08-08</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag vm"></i>
    <a class="article-tag-link" href="/tags/pandas/" rel="tag">pandas</a>, <a class="article-tag-link" href="/tags/python/" rel="tag">python</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <p>修改集合内匹配A列的行中其他列的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.read_csv(<span class="string">&#x27;class.csv&#x27;</span>, header=<span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">  name  age</span><br><span class="line"><span class="number">0</span>   小明   <span class="number">12</span></span><br><span class="line"><span class="number">1</span>   小红   <span class="number">11</span></span><br><span class="line"><span class="number">2</span>   小花   <span class="number">12</span></span><br><span class="line"><span class="number">3</span>   小龙   <span class="number">13</span></span><br><span class="line"><span class="number">4</span>   小白   <span class="number">11</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>femalels=&#123;<span class="string">&quot;小红&quot;</span>,<span class="string">&quot;小花&quot;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>femalels</span><br><span class="line">&#123;<span class="string">&#x27;小花&#x27;</span>, <span class="string">&#x27;小红&#x27;</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[<span class="string">&#x27;gender&#x27;</span>] = <span class="string">&#x27;male&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">  name  age gender</span><br><span class="line"><span class="number">0</span>   小明   <span class="number">12</span>   male</span><br><span class="line"><span class="number">1</span>   小红   <span class="number">11</span>   male</span><br><span class="line"><span class="number">2</span>   小花   <span class="number">12</span>   male</span><br><span class="line"><span class="number">3</span>   小龙   <span class="number">13</span>   male</span><br><span class="line"><span class="number">4</span>   小白   <span class="number">11</span>   male</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.loc[df.name.isin(femalels), <span class="string">&#x27;gender&#x27;</span>] = <span class="string">&#x27;female&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">  name  age  gender</span><br><span class="line"><span class="number">0</span>   小明   <span class="number">12</span>    male</span><br><span class="line"><span class="number">1</span>   小红   <span class="number">11</span>  female</span><br><span class="line"><span class="number">2</span>   小花   <span class="number">12</span>  female</span><br><span class="line"><span class="number">3</span>   小龙   <span class="number">13</span>    male</span><br><span class="line"><span class="number">4</span>   小白   <span class="number">11</span>    male</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.to_csv(<span class="string">&#x27;class_tmp.csv&#x27;</span>, index=<span class="number">0</span>)	<span class="comment">#df.to_excel</span></span><br></pre></td></tr></table></figure>

<p>挑选A列匹配以’xiao‘开头或者中间’带”-“的所有行，把A按字符”-“拆分为两列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df = pd.read_csv(<span class="string">&#x27;class.csv&#x27;</span>, header=<span class="number">0</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df</span><br><span class="line">  name  age   nickname</span><br><span class="line"><span class="number">0</span>   小明   <span class="number">12</span>  xiao-ming</span><br><span class="line"><span class="number">1</span>   小红   <span class="number">11</span>  xiao-hong</span><br><span class="line"><span class="number">2</span>   小花   <span class="number">12</span>   xiao-hua</span><br><span class="line"><span class="number">3</span>   小龙   <span class="number">13</span>  xiao-long</span><br><span class="line"><span class="number">4</span>   小白   <span class="number">11</span>   xiao-bai</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[df.nickname.<span class="built_in">str</span>.startswith(<span class="string">&#x27;xiao&#x27;</span>)]</span><br><span class="line">  name  age   nickname</span><br><span class="line"><span class="number">0</span>   小明   <span class="number">12</span>  xiao-ming</span><br><span class="line"><span class="number">1</span>   小红   <span class="number">11</span>  xiao-hong</span><br><span class="line"><span class="number">2</span>   小花   <span class="number">12</span>   xiao-hua</span><br><span class="line"><span class="number">3</span>   小龙   <span class="number">13</span>  xiao-long</span><br><span class="line"><span class="number">4</span>   小白   <span class="number">11</span>   xiao-bai</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df[(df.nickname.<span class="built_in">str</span>.contains(<span class="string">&#x27;-&#x27;</span>))]</span><br><span class="line">  name  age   nickname</span><br><span class="line"><span class="number">0</span>   小明   <span class="number">12</span>  xiao-ming</span><br><span class="line"><span class="number">1</span>   小红   <span class="number">11</span>  xiao-hong</span><br><span class="line"><span class="number">2</span>   小花   <span class="number">12</span>   xiao-hua</span><br><span class="line"><span class="number">3</span>   小龙   <span class="number">13</span>  xiao-long</span><br><span class="line"><span class="number">4</span>   小白   <span class="number">11</span>   xiao-bai</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>df.nickname.<span class="built_in">str</span>.split(<span class="string">&#x27;-&#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line">      <span class="number">0</span>     <span class="number">1</span></span><br><span class="line"><span class="number">0</span>  xiao  ming</span><br><span class="line"><span class="number">1</span>  xiao  hong</span><br><span class="line"><span class="number">2</span>  xiao   hua</span><br><span class="line"><span class="number">3</span>  xiao  long</span><br><span class="line"><span class="number">4</span>  xiao   bai</span><br><span class="line">&gt;&gt;&gt;</span><br></pre></td></tr></table></figure>
<p>df.bs=df.bs.fillna(‘unknown’)</p>
<p>df.bs=df.bs.replace(‘CHN-UNICO’,’CHN-UNICOM’)</p>
<p>sshpass -p helloworld ssh -o stricthostkeychecking=no root@${line} ‘reboot -f’</p>

        
    </section>
</article>




<nav class="page-nav">
    <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
</nav>



            </div>
        </div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?e4027971a230b210f4671f485b33846a";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</footer>

    </main>

    <script type="text/javascript" src="https://unpkg.com/jquery@1.9.1/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }

            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle('normal', slideDone);
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp('normal', slideDone);
            }, 3000);
        }

        function slideDone() {
            if (nodes.navInner.css('display') !== 'none') {
                nodes.navInner.css('display', '');
            }
        }

        $(window).on('resize', function() {
            if ($(this).width() > 960) {
                nodes.navInner.css('display', '');
            }
        });
    });
    </script>
    

</body>
</html>
